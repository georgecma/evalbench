cleanup_sql,database,dialects,eval_query,generated_error,generated_prompt,generated_result,generated_sql,golden_error,golden_result,golden_sql,id,job_id,nl_prompt,other,prompt_generator_error,query_type,run_time,sanitized_sql,setup_sql,sql_generator_error,sql_generator_time,tags,trace_id
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42703', 'M': 'column e.termination_date does not exist', 'P': '46', 'F': 'parse_relation.c', 'L': '3727', 'R': 'errorMissingColumn'}
[SQL: 
SELECT
AVG(EXTRACT(YEAR FROM (e.hire_date - e.termination_date))),
d.department_name,
j.job_title
FROM employee AS e
LEFT JOIN job_history AS jh ON e.employee_id = jh.employee_id
LEFT JOIN department AS d ON d.department_id = jh.department_id
LEFT JOIN job AS j ON j.job_id = jh.job_id
GROUP BY
d.department_name,
j.job_title;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Determine the average tenure of employees in each department and job role to assess employee retention rates and identify areas for talent development and succession planning",[],"
SELECT
    AVG(EXTRACT(YEAR FROM (e.hire_date - e.termination_date))),
    d.department_name,
    j.job_title
FROM employee AS e
LEFT JOIN job_history AS jh ON e.employee_id = jh.employee_id
LEFT JOIN department AS d ON d.department_id = jh.department_id
LEFT JOIN job AS j ON j.job_id = jh.job_id
GROUP BY
    d.department_name,
    j.job_title;
```",,"[{'avg_tenure_in_days': '447.7142857142857143', 'department_name': 'Marketing', 'job_title': 'Marketing Manager'}, {'avg_tenure_in_days': '469.6666666666666667', 'department_name': 'Finance', 'job_title': 'Financial Analyst'}, {'avg_tenure_in_days': '490.2857142857142857', 'department_name': 'Human Resources', 'job_title': 'Software Engineer'}]","['SELECT d.department_name, j.job_title, AVG(EXTRACT(DAY FROM NOW() - e.hire_date)) AS avg_tenure_in_days FROM department d JOIN employee e ON d.department_id = e.department_id JOIN job j ON e.job_id = j.job_id GROUP BY d.department_name, j.job_title;']",113,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Determine the average tenure of employees in each department and job role to assess employee retention rates and identify areas for talent development and succession planning,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
AVG(EXTRACT(YEAR FROM (e.hire_date - e.termination_date))),
d.department_name,
j.job_title
FROM employee AS e
LEFT JOIN job_history AS jh ON e.employee_id = jh.employee_id
LEFT JOIN department AS d ON d.department_id = jh.department_id
LEFT JOIN job AS j ON j.job_id = jh.job_id
GROUP BY
d.department_name,
j.job_title;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'JOIN', 'AGGREGATE', 'DATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Identify employees who have exceeded their allocated budget for business expenses, along with details of the expense categories and reasons for overspending",[],"
SELECT
    emp.""first_name"" || ' ' || emp.""last_name"" AS ""Employee Name"",
    e.""expense_category"" AS ""Expense Category"",
    e.""expense_date"" AS ""Expense Date"",
    e.""expense_amount"" AS ""Expense Amount"",
    dept.""budget"" AS ""Department Budget"",
    e.""expense_amount"" - dept.""budget"" AS ""Budget Difference"",
    e.""expense_description"" AS ""Expense Description""
FROM
    ""employee_business_expense"" AS e
LEFT JOIN
    ""employee"" AS emp
ON e.""employee_id"" = emp.""employee_id""
LEFT JOIN
    ""department"" AS dept
ON emp.""department_id"" = dept.""department_id""
WHERE 
    e.""expense_amount"" > dept.""budget""
ORDER BY ""Expense Date""
```",,"[{'employee_id': 3536251, 'expense_amount': '350.00', 'expense_category': 'Travel', 'expense_description': 'Flight ticket for business trip', 'expense_receipt': 'receipts/flight_ticket.jpg', 'first_name': 'John', 'last_name': 'Doe'}, {'employee_id': 3536256, 'expense_amount': '500.00', 'expense_category': 'Supplies', 'expense_description': 'Purchase of office furniture', 'expense_receipt': 'receipts/furniture_receipt.jpg', 'first_name': 'Sarah', 'last_name': 'Jones'}, {'employee_id': 3536260, 'expense_amount': '400.00', 'expense_category': 'Transportation', 'expense_description': 'Flight ticket for business trip', 'expense_receipt': 'receipts/flight_receipt.jpg', 'first_name': 'Taylor', 'last_name': 'Rodriguez'}]","['SELECT eb.employee_id, e.first_name, e.last_name, eb.expense_category, eb.expense_description, eb.expense_amount, eb.expense_receipt FROM employee_business_expense eb JOIN employee e ON eb.employee_id = e.employee_id WHERE eb.expense_amount > 300 ORDER BY eb.employee_id, eb.expense_amount DESC;']",109,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Identify employees who have exceeded their allocated budget for business expenses, along with details of the expense categories and reasons for overspending","{'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""expense_amount > 3000""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
emp.""first_name"" || ' ' || emp.""last_name"" AS ""Employee Name"",
e.""expense_category"" AS ""Expense Category"",
e.""expense_date"" AS ""Expense Date"",
e.""expense_amount"" AS ""Expense Amount"",
dept.""budget"" AS ""Department Budget"",
e.""expense_amount"" - dept.""budget"" AS ""Budget Difference"",
e.""expense_description"" AS ""Expense Description""
FROM
""employee_business_expense"" AS e
LEFT JOIN
""employee"" AS emp
ON e.""employee_id"" = emp.""employee_id""
LEFT JOIN
""department"" AS dept
ON emp.""department_id"" = dept.""department_id""
WHERE 
e.""expense_amount"" > dept.""budget""
ORDER BY ""Expense Date""
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'JOIN', 'SORT']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42883', 'M': 'function unnest(jsonb) does not exist', 'H': 'No function matches the given name and argument types. You might need to add explicit type casts.', 'P': '124', 'F': 'parse_func.c', 'L': '636', 'R': 'ParseFuncOrColumn'}
[SQL: 
WITH CompanyClientsPartners AS (
SELECT
COALESCE(c.location, p.location) AS location
FROM company AS c
LEFT JOIN (
SELECT
unnest(partners) AS location
FROM company
) AS p
ON c.location = p.location
), CCPGrouped AS (
SELECT
location,
COUNT(*) AS occurrence
FROM CompanyClientsPartners
GROUP BY
location
), CCPPivoted AS (
SELECT
'Asia' AS region,
SUM(CASE WHEN location = 'Asia' THEN occurrence ELSE 0 END) AS asia_count,
'Europe' AS region,
SUM(CASE WHEN location = 'Europe' THEN occurrence ELSE 0 END) AS europe_count,
'North America' AS region,
SUM(CASE WHEN location = 'North America' THEN occurrence ELSE 0 END) AS north_america_count,
'South America' AS region,
SUM(CASE WHEN location = 'South America' THEN occurrence ELSE 0 END) AS south_america_count,
'Africa' AS region,
SUM(CASE WHEN location = 'Africa' THEN occurrence ELSE 0 END) AS africa_count,
'Oceania' AS region,
SUM(CASE WHEN location = 'Oceania' THEN occurrence ELSE 0 END) AS oceania_count
FROM CCPGrouped
)
SELECT
ccp.region,
ccp.asia_count,
ccp.europe_count,
ccp.north_america_count,
ccp.south_america_count,
ccp.africa_count,
ccp.oceania_count,
(
ccp.asia_count + ccp.europe_count + ccp.north_america_count + ccp.south_america_count + ccp.africa_count + ccp.oceania_count
) AS total_count,
(
100 * (
ccp.asia_count + ccp.europe_count + ccp.north_america_count + ccp.south_america_count + ccp.africa_count + ccp.oceania_count
) / (
SELECT
COUNT(*)
FROM CompanyClientsPartners
)
)::DOUBLE PRECISION AS percentage
FROM CCPPivoted AS ccp
ORDER BY
ccp.total_count DESC;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Analyze the geographic distribution of company clients and partners to identify regions with potential for business expansion or partnership opportunities",[],"
WITH CompanyClientsPartners AS (
  SELECT
    COALESCE(c.location, p.location) AS location
  FROM company AS c
  LEFT JOIN (
    SELECT
      unnest(partners) AS location
    FROM company
  ) AS p
  ON c.location = p.location
), CCPGrouped AS (
  SELECT
    location,
    COUNT(*) AS occurrence
  FROM CompanyClientsPartners
  GROUP BY
    location
), CCPPivoted AS (
  SELECT
    'Asia' AS region,
    SUM(CASE WHEN location = 'Asia' THEN occurrence ELSE 0 END) AS asia_count,
    'Europe' AS region,
    SUM(CASE WHEN location = 'Europe' THEN occurrence ELSE 0 END) AS europe_count,
    'North America' AS region,
    SUM(CASE WHEN location = 'North America' THEN occurrence ELSE 0 END) AS north_america_count,
    'South America' AS region,
    SUM(CASE WHEN location = 'South America' THEN occurrence ELSE 0 END) AS south_america_count,
    'Africa' AS region,
    SUM(CASE WHEN location = 'Africa' THEN occurrence ELSE 0 END) AS africa_count,
    'Oceania' AS region,
    SUM(CASE WHEN location = 'Oceania' THEN occurrence ELSE 0 END) AS oceania_count
  FROM CCPGrouped
)
SELECT
  ccp.region,
  ccp.asia_count,
  ccp.europe_count,
  ccp.north_america_count,
  ccp.south_america_count,
  ccp.africa_count,
  ccp.oceania_count,
  (
    ccp.asia_count + ccp.europe_count + ccp.north_america_count + ccp.south_america_count + ccp.africa_count + ccp.oceania_count
  ) AS total_count,
  (
    100 * (
      ccp.asia_count + ccp.europe_count + ccp.north_america_count + ccp.south_america_count + ccp.africa_count + ccp.oceania_count
    ) / (
      SELECT
        COUNT(*)
      FROM CompanyClientsPartners
    )
  )::DOUBLE PRECISION AS percentage
FROM CCPPivoted AS ccp
ORDER BY
  ccp.total_count DESC;
```",,"[{'location': 'Atlanta, GA', 'total_clients': 1, 'total_partners': 1}, {'location': 'Boston, MA', 'total_clients': 1, 'total_partners': 1}, {'location': 'Chicago, IL', 'total_clients': 2, 'total_partners': 2}, {'location': 'Dallas, TX', 'total_clients': 1, 'total_partners': 1}, {'location': 'Houston, TX', 'total_clients': 1, 'total_partners': 1}, {'location': 'Los Angeles, CA', 'total_clients': 2, 'total_partners': 2}, {'location': 'Miami, FL', 'total_clients': 1, 'total_partners': 1}, {'location': 'New York, NY', 'total_clients': 2, 'total_partners': 2}, {'location': 'San Francisco, CA', 'total_clients': 2, 'total_partners': 2}, {'location': 'Seattle, WA', 'total_clients': 1, 'total_partners': 1}]","['SELECT c.location, COUNT(DISTINCT c.clients) AS total_clients, COUNT(DISTINCT c.partners) AS total_partners FROM company c GROUP BY c.location;']",112,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Analyze the geographic distribution of company clients and partners to identify regions with potential for business expansion or partnership opportunities,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH CompanyClientsPartners AS (
SELECT
COALESCE(c.location, p.location) AS location
FROM company AS c
LEFT JOIN (
SELECT
unnest(partners) AS location
FROM company
) AS p
ON c.location = p.location
), CCPGrouped AS (
SELECT
location,
COUNT(*) AS occurrence
FROM CompanyClientsPartners
GROUP BY
location
), CCPPivoted AS (
SELECT
'Asia' AS region,
SUM(CASE WHEN location = 'Asia' THEN occurrence ELSE 0 END) AS asia_count,
'Europe' AS region,
SUM(CASE WHEN location = 'Europe' THEN occurrence ELSE 0 END) AS europe_count,
'North America' AS region,
SUM(CASE WHEN location = 'North America' THEN occurrence ELSE 0 END) AS north_america_count,
'South America' AS region,
SUM(CASE WHEN location = 'South America' THEN occurrence ELSE 0 END) AS south_america_count,
'Africa' AS region,
SUM(CASE WHEN location = 'Africa' THEN occurrence ELSE 0 END) AS africa_count,
'Oceania' AS region,
SUM(CASE WHEN location = 'Oceania' THEN occurrence ELSE 0 END) AS oceania_count
FROM CCPGrouped
)
SELECT
ccp.region,
ccp.asia_count,
ccp.europe_count,
ccp.north_america_count,
ccp.south_america_count,
ccp.africa_count,
ccp.oceania_count,
(
ccp.asia_count + ccp.europe_count + ccp.north_america_count + ccp.south_america_count + ccp.africa_count + ccp.oceania_count
) AS total_count,
(
100 * (
ccp.asia_count + ccp.europe_count + ccp.north_america_count + ccp.south_america_count + ccp.africa_count + ccp.oceania_count
) / (
SELECT
COUNT(*)
FROM CompanyClientsPartners
)
)::DOUBLE PRECISION AS percentage
FROM CCPPivoted AS ccp
ORDER BY
ccp.total_count DESC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Which employee has the highest performance rating?","[{'employee_id': 3536255, 'first_name': 'Matthew', 'highest_performance_rating': '4.60', 'last_name': 'Brown'}]","SELECT
    employee.""employee_id"",
    employee.""first_name"",
    employee.""last_name"",
    MAX(performance_review.""performance_rating"") AS ""highest_performance_rating""
FROM
    ""employee""
INNER JOIN
    ""performance_review"" ON employee.""employee_id"" = performance_review.""employee_id""
GROUP BY
    employee.""employee_id"",
    employee.""first_name"",
    employee.""last_name""
ORDER BY
    ""highest_performance_rating"" DESC
LIMIT 1;",,"[{'employee_id': 3536255}, {'employee_id': 3536265}]",['SELECT employee_id FROM performance_review WHERE performance_rating = (SELECT MAX(performance_rating) FROM performance_review)'],8,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Which employee has the highest performance rating?,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"SELECT
employee.""employee_id"",
employee.""first_name"",
employee.""last_name"",
MAX(performance_review.""performance_rating"") AS ""highest_performance_rating""
FROM
""employee""
INNER JOIN
""performance_review"" ON employee.""employee_id"" = performance_review.""employee_id""
GROUP BY
employee.""employee_id"",
employee.""first_name"",
employee.""last_name""
ORDER BY
""highest_performance_rating"" DESC
LIMIT 1;",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'SORT', 'MAX']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List all employees id whose total compensation (salary + bonus - taxes - deductions) exceeds $10000 in the last year, current year being 2024","[{'employee_id': 3536251}, {'employee_id': 3536252}, {'employee_id': 3536253}, {'employee_id': 3536254}, {'employee_id': 3536255}, {'employee_id': 3536256}, {'employee_id': 3536257}, {'employee_id': 3536258}, {'employee_id': 3536259}, {'employee_id': 3536260}, {'employee_id': 3536261}, {'employee_id': 3536262}, {'employee_id': 3536263}, {'employee_id': 3536264}, {'employee_id': 3536265}, {'employee_id': 3536266}, {'employee_id': 3536267}, {'employee_id': 3536268}, {'employee_id': 3536269}, {'employee_id': 3536270}]","
SELECT
  ""e"".""employee_id""
FROM ""employee"" AS ""e""
INNER JOIN ""salary"" AS ""s""
  ON ""e"".""employee_id"" = ""s"".""employee_id""
WHERE
  ""s"".""start_date"" >= '2023-01-01'
  AND ""s"".""bonus"" + ""s"".""salary"" - ""s"".""taxes"" - ""s"".""deductions"" > 10000;
```",,"[{'employee_id': 3536251}, {'employee_id': 3536252}, {'employee_id': 3536253}, {'employee_id': 3536254}, {'employee_id': 3536255}, {'employee_id': 3536256}, {'employee_id': 3536257}, {'employee_id': 3536258}, {'employee_id': 3536259}, {'employee_id': 3536260}, {'employee_id': 3536261}, {'employee_id': 3536262}, {'employee_id': 3536263}, {'employee_id': 3536264}, {'employee_id': 3536265}, {'employee_id': 3536266}, {'employee_id': 3536267}, {'employee_id': 3536268}, {'employee_id': 3536269}, {'employee_id': 3536270}]","[""SELECT e.employee_id FROM employee e JOIN salary s ON e.employee_id = s.employee_id WHERE s.start_date >= '2023-01-01' AND s.total_compensation > 10000;""]",73,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"List all employees id whose total compensation (salary + bonus - taxes - deductions) exceeds $10000 in the last year, current year being 2024","{'Comment': '""LGTM, Fixed the current year""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""s.start_date >= \'2023-01-01\' AND s.total_compensation > 10000""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
""e"".""employee_id""
FROM ""employee"" AS ""e""
INNER JOIN ""salary"" AS ""s""
ON ""e"".""employee_id"" = ""s"".""employee_id""
WHERE
""s"".""start_date"" >= '2023-01-01'
AND ""s"".""bonus"" + ""s"".""salary"" - ""s"".""taxes"" - ""s"".""deductions"" > 10000;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'time']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the total number of certifications held by each employee.","[{'employee_id': 3536261, 'num_certifications': 0}, {'employee_id': 3536264, 'num_certifications': 0}, {'employee_id': 3536251, 'num_certifications': 2}, {'employee_id': 3536269, 'num_certifications': 0}, {'employee_id': 3536268, 'num_certifications': 0}, {'employee_id': 3536254, 'num_certifications': 2}, {'employee_id': 3536260, 'num_certifications': 2}, {'employee_id': 3536253, 'num_certifications': 2}, {'employee_id': 3536262, 'num_certifications': 0}, {'employee_id': 3536270, 'num_certifications': 0}, {'employee_id': 3536267, 'num_certifications': 0}, {'employee_id': 3536266, 'num_certifications': 0}, {'employee_id': 3536257, 'num_certifications': 2}, {'employee_id': 3536255, 'num_certifications': 2}, {'employee_id': 3536265, 'num_certifications': 0}, {'employee_id': 3536252, 'num_certifications': 2}, {'employee_id': 3536258, 'num_certifications': 2}, {'employee_id': 3536259, 'num_certifications': 2}, {'employee_id': 3536256, 'num_certifications': 2}, {'employee_id': 3536263, 'num_certifications': 0}]","
SELECT e.""employee_id"", COUNT(ec.""certification_id"") AS num_certifications
FROM ""employee"" AS e
LEFT JOIN ""employee_certification"" AS ec ON e.""employee_id"" = ec.""employee_id""
GROUP BY e.""employee_id"";
```",,"[{'employee_id': 3536252, 'total_certifications': 2}, {'employee_id': 3536258, 'total_certifications': 2}, {'employee_id': 3536259, 'total_certifications': 2}, {'employee_id': 3536256, 'total_certifications': 2}, {'employee_id': 3536251, 'total_certifications': 2}, {'employee_id': 3536254, 'total_certifications': 2}, {'employee_id': 3536260, 'total_certifications': 2}, {'employee_id': 3536253, 'total_certifications': 2}, {'employee_id': 3536257, 'total_certifications': 2}, {'employee_id': 3536255, 'total_certifications': 2}]","['SELECT employee_id, COUNT(certification_id) AS total_certifications FROM employee_certification GROUP BY employee_id;']",144,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve the total number of certifications held by each employee.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT e.""employee_id"", COUNT(ec.""certification_id"") AS num_certifications
FROM ""employee"" AS e
LEFT JOIN ""employee_certification"" AS ec ON e.""employee_id"" = ec.""employee_id""
GROUP BY e.""employee_id"";
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'difficulty: simple']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List of employees who have completed at least one certification within the past year, sorted by their job title and department",[],"
SELECT
  e.first_name,
  e.last_name,
  j.job_title,
  d.department_name
FROM ""employee"" AS e
INNER JOIN ""job_history"" AS jh
  ON e.employee_id = jh.employee_id
INNER JOIN ""job"" AS j
  ON jh.job_id = j.job_id
INNER JOIN ""department"" AS d
  ON j.department_id = d.department_id
INNER JOIN ""employee_certification"" AS ec
  ON e.employee_id = ec.employee_id
WHERE
  ec.issue_date >= CURRENT_DATE - INTERVAL '1 year'
ORDER BY
  d.department_name,
  j.job_title;
```",,[],"[""SELECT e.employee_id, e.first_name, e.last_name, e.email, j.job_title, d.department_name, ec.certification_name, ec.issue_date, ec.expiration_date FROM employee e JOIN job_history jh ON e.employee_id = jh.employee_id JOIN job j ON jh.job_id = j.job_id JOIN department d ON j.department_id = d.department_id JOIN employee_certification ec ON e.employee_id = ec.employee_id AND ec.issue_date BETWEEN CURRENT_DATE - INTERVAL '4 YEAR' AND CURRENT_DATE JOIN (SELECT job_id, MAX(start_date) AS max_start_date FROM job_history GROUP BY job_id) AS latest_job ON jh.job_id = latest_job.job_id AND jh.start_date = latest_job.max_start_date ORDER BY j.job_title, d.department_name;""]",103,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"List of employees who have completed at least one certification within the past year, sorted by their job title and department","{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
e.first_name,
e.last_name,
j.job_title,
d.department_name
FROM ""employee"" AS e
INNER JOIN ""job_history"" AS jh
ON e.employee_id = jh.employee_id
INNER JOIN ""job"" AS j
ON jh.job_id = j.job_id
INNER JOIN ""department"" AS d
ON j.department_id = d.department_id
INNER JOIN ""employee_certification"" AS ec
ON e.employee_id = ec.employee_id
WHERE
ec.issue_date >= CURRENT_DATE - INTERVAL '1 year'
ORDER BY
d.department_name,
j.job_title;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'JOIN', 'DATE', 'SORT']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42703', 'M': 'column timesheet.employee_id does not exist', 'P': '130', 'F': 'parse_relation.c', 'L': '3727', 'R': 'errorMissingColumn'}
[SQL: 

SELECT DISTINCT
""leave_request"".""employee_id""
FROM
""leave_request""
JOIN
""timesheet""
ON
""leave_request"".""employee_id"" = ""timesheet"".""employee_id""
WHERE
""timesheet"".""leave_type"" = 'Sick Leave' AND ""leave_request"".""reason"" LIKE '%Illness%';
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List all employees id who have requested sick leave due to Illness symptoms.",[],"

SELECT DISTINCT
    ""leave_request"".""employee_id""
FROM
    ""leave_request""
JOIN
    ""timesheet""
ON
    ""leave_request"".""employee_id"" = ""timesheet"".""employee_id""
WHERE
    ""timesheet"".""leave_type"" = 'Sick Leave' AND ""leave_request"".""reason"" LIKE '%Illness%';
```",,"[{'employee_id': 3536252}, {'employee_id': 3536257}, {'employee_id': 3536259}, {'employee_id': 3536263}, {'employee_id': 3536267}, {'employee_id': 3536270}]","[""SELECT e.employee_id FROM employee e JOIN leave_request lr ON e.employee_id = lr.employee_id WHERE lr.leave_type = 'Sick Leave' AND lr.reason LIKE '%Illness';""]",99,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,List all employees id who have requested sick leave due to Illness symptoms.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""leave_type = \'Sick Leave\', reason LIKE \'%Illness\'""'}",,dql,2025-02-10 18:36:22.083420,"

SELECT DISTINCT
""leave_request"".""employee_id""
FROM
""leave_request""
JOIN
""timesheet""
ON
""leave_request"".""employee_id"" = ""timesheet"".""employee_id""
WHERE
""timesheet"".""leave_type"" = 'Sick Leave' AND ""leave_request"".""reason"" LIKE '%Illness%';
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'LIKE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the total number of employees working in each department of the company.","[{'department_name': 'Human Resources', 'total_employees': 7}, {'department_name': 'Marketing', 'total_employees': 7}, {'department_name': 'Finance', 'total_employees': 6}]","
SELECT
  COUNT(e.employee_id) AS total_employees,
  d.department_name AS department_name
FROM employee AS e
JOIN department AS d
  ON e.department_id = d.department_id
GROUP BY
  department_name
ORDER BY
  total_employees DESC;
```",,"[{'department_name': 'Production', 'total_employees': 0}, {'department_name': 'Marketing', 'total_employees': 7}, {'department_name': 'Operations', 'total_employees': 0}, {'department_name': 'Quality Assurance', 'total_employees': 0}, {'department_name': 'Sales', 'total_employees': 0}, {'department_name': 'Research and Development', 'total_employees': 0}, {'department_name': 'Safety and Compliance', 'total_employees': 0}, {'department_name': 'Training and Development', 'total_employees': 0}, {'department_name': 'Legal', 'total_employees': 0}, {'department_name': 'Public Relations', 'total_employees': 0}, {'department_name': 'Administration', 'total_employees': 0}, {'department_name': 'Engineering', 'total_employees': 0}, {'department_name': 'IT', 'total_employees': 0}, {'department_name': 'Logistics', 'total_employees': 0}, {'department_name': 'Finance', 'total_employees': 6}, {'department_name': 'Product Management', 'total_employees': 0}, {'department_name': 'Customer Service', 'total_employees': 0}, {'department_name': 'Human Resources', 'total_employees': 7}, {'department_name': 'Customer Success', 'total_employees': 0}, {'department_name': 'Supply Chain', 'total_employees': 0}]","['SELECT d.department_name, COUNT(e.employee_id) AS total_employees FROM department d LEFT JOIN employee e ON d.department_id = e.department_id GROUP BY d.department_name;']",81,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve the total number of employees working in each department of the company.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
COUNT(e.employee_id) AS total_employees,
d.department_name AS department_name
FROM employee AS e
JOIN department AS d
ON e.department_id = d.department_id
GROUP BY
department_name
ORDER BY
total_employees DESC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'AGGREGATE', 'GROUP BY']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Determine the number of employees assigned each computer model","[{'model': 'Acer Aspire', 'num_employees': 1}, {'model': 'Acer Predator', 'num_employees': 1}, {'model': 'Apple iMac', 'num_employees': 1}, {'model': 'Asus ROG Strix', 'num_employees': 1}, {'model': 'Asus VivoBook', 'num_employees': 1}, {'model': 'Asus ZenBook', 'num_employees': 1}, {'model': 'Dell Inspiron', 'num_employees': 1}, {'model': 'Dell OptiPlex', 'num_employees': 1}, {'model': 'Dell Precision', 'num_employees': 1}, {'model': 'Dell XPS 15', 'num_employees': 1}, {'model': 'HP Envy', 'num_employees': 1}, {'model': 'HP Pavilion', 'num_employees': 1}, {'model': 'HP Spectre', 'num_employees': 1}, {'model': 'Lenovo Legion', 'num_employees': 1}, {'model': 'Lenovo ThinkCentre', 'num_employees': 1}, {'model': 'Lenovo Yoga', 'num_employees': 1}, {'model': 'MacBook Pro', 'num_employees': 1}, {'model': 'Microsoft Surface', 'num_employees': 1}, {'model': 'Microsoft Surface Book', 'num_employees': 1}, {'model': 'Microsoft Surface Studio', 'num_employees': 1}]","
SELECT
  ""ec"".""model"",
  COUNT(""ec"".""employee_id"") AS num_employees
FROM ""employee_computer"" AS ""ec""
GROUP BY
  ""ec"".""model""
ORDER BY
  ""ec"".""model"";
```",,"[{'model': 'HP Spectre', 'num_employees_assigned': 1}, {'model': 'Dell Precision', 'num_employees_assigned': 1}, {'model': 'Dell Inspiron', 'num_employees_assigned': 1}, {'model': 'Lenovo Yoga', 'num_employees_assigned': 1}, {'model': 'Acer Predator', 'num_employees_assigned': 1}, {'model': 'MacBook Pro', 'num_employees_assigned': 1}, {'model': 'Microsoft Surface Studio', 'num_employees_assigned': 1}, {'model': 'Microsoft Surface', 'num_employees_assigned': 1}, {'model': 'HP Envy', 'num_employees_assigned': 1}, {'model': 'Asus ROG Strix', 'num_employees_assigned': 1}, {'model': 'Lenovo ThinkCentre', 'num_employees_assigned': 1}, {'model': 'Dell XPS 15', 'num_employees_assigned': 1}, {'model': 'Acer Aspire', 'num_employees_assigned': 1}, {'model': 'Asus VivoBook', 'num_employees_assigned': 1}, {'model': 'Apple iMac', 'num_employees_assigned': 1}, {'model': 'Microsoft Surface Book', 'num_employees_assigned': 1}, {'model': 'Asus ZenBook', 'num_employees_assigned': 1}, {'model': 'Lenovo Legion', 'num_employees_assigned': 1}, {'model': 'HP Pavilion', 'num_employees_assigned': 1}, {'model': 'Dell OptiPlex', 'num_employees_assigned': 1}]","['SELECT model, COUNT(employee_id) AS num_employees_assigned FROM employee_computer GROUP BY model;']",114,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Determine the number of employees assigned each computer model,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
""ec"".""model"",
COUNT(""ec"".""employee_id"") AS num_employees
FROM ""employee_computer"" AS ""ec""
GROUP BY
""ec"".""model""
ORDER BY
""ec"".""model"";
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'AGGREGATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Average performance rating of each employee in the last quarter, along with their attendance record and completion status of mandatory training sessions",[],"
WITH EmployeePerformance AS (
    SELECT
        e.employee_id,
        e.first_name AS employee_first_name,
        e.last_name AS employee_last_name,
        AVG(p.performance_rating) AS average_performance_rating
    FROM employee AS e
    JOIN performance_review AS p
        ON e.employee_id = p.employee_id
    WHERE
        p.review_date >= CURRENT_DATE - INTERVAL '3 months'
    GROUP BY
        e.employee_id,
        e.first_name,
        e.last_name
), EmployeeAttendance AS (
    SELECT
        a.employee_id,
        COUNT(a.attendance_id) AS total_attendances
    FROM attendance AS a
    WHERE
        a.date >= CURRENT_DATE - INTERVAL '3 months'
    GROUP BY
        a.employee_id
), EmployeeTrainingCompletion AS (
    SELECT
        etc.employee_id,
        COUNT(etc.certification_id) AS total_completed_certifications
    FROM employee_certification AS etc
    JOIN training AS t
        ON etc.certification_name = t.title
    WHERE
        t.attendance_required = TRUE
    GROUP BY
        etc.employee_id
)
SELECT
    ep.employee_first_name,
    ep.employee_last_name,
    ep.average_performance_rating,
    ea.total_attendances,
    etc.total_completed_certifications
FROM EmployeePerformance AS ep
JOIN EmployeeAttendance AS ea
    ON ep.employee_id = ea.employee_id
LEFT JOIN EmployeeTrainingCompletion AS etc
    ON ep.employee_id = etc.employee_id
ORDER BY
    ep.employee_first_name,
    ep.employee_last_name;
```",,"[{'avg_performance_rating': '4.5000000000000000', 'days_worked': 0, 'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe', 'training_completed': 0}, {'avg_performance_rating': '4.2000000000000000', 'days_worked': 0, 'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith', 'training_completed': 0}, {'avg_performance_rating': '3.8000000000000000', 'days_worked': 0, 'employee_id': 3536253, 'first_name': 'Michael', 'last_name': 'Johnson', 'training_completed': 0}, {'avg_performance_rating': '4.0000000000000000', 'days_worked': 0, 'employee_id': 3536254, 'first_name': 'Emily', 'last_name': 'Williams', 'training_completed': 0}, {'avg_performance_rating': '4.6000000000000000', 'days_worked': 0, 'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown', 'training_completed': 0}, {'avg_performance_rating': '4.3000000000000000', 'days_worked': 0, 'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones', 'training_completed': 0}, {'avg_performance_rating': '3.9000000000000000', 'days_worked': 0, 'employee_id': 3536257, 'first_name': 'Christopher', 'last_name': 'Davis', 'training_completed': 0}, {'avg_performance_rating': '4.1000000000000000', 'days_worked': 0, 'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez', 'training_completed': 0}, {'avg_performance_rating': '4.4000000000000000', 'days_worked': 0, 'employee_id': 3536259, 'first_name': 'Daniel', 'last_name': 'Garcia', 'training_completed': 0}, {'avg_performance_rating': '4.5000000000000000', 'days_worked': 0, 'employee_id': 3536260, 'first_name': 'Taylor', 'last_name': 'Rodriguez', 'training_completed': 0}, {'avg_performance_rating': '4.2000000000000000', 'days_worked': 0, 'employee_id': 3536261, 'first_name': 'David', 'last_name': 'Lopez', 'training_completed': 0}, {'avg_performance_rating': '4.3000000000000000', 'days_worked': 0, 'employee_id': 3536262, 'first_name': 'Megan', 'last_name': 'Hernandez', 'training_completed': 0}, {'avg_performance_rating': '3.8000000000000000', 'days_worked': 0, 'employee_id': 3536263, 'first_name': 'Andrew', 'last_name': 'Gonzalez', 'training_completed': 0}, {'avg_performance_rating': '4.0000000000000000', 'days_worked': 0, 'employee_id': 3536264, 'first_name': 'Sophia', 'last_name': 'Perez', 'training_completed': 0}, {'avg_performance_rating': '4.6000000000000000', 'days_worked': 0, 'employee_id': 3536265, 'first_name': 'Aiden', 'last_name': 'Torres', 'training_completed': 0}, {'avg_performance_rating': '4.4000000000000000', 'days_worked': 0, 'employee_id': 3536266, 'first_name': 'Olivia', 'last_name': 'Rivera', 'training_completed': 0}, {'avg_performance_rating': '3.9000000000000000', 'days_worked': 0, 'employee_id': 3536267, 'first_name': 'Liam', 'last_name': 'Gomez', 'training_completed': 0}, {'avg_performance_rating': '4.1000000000000000', 'days_worked': 0, 'employee_id': 3536268, 'first_name': 'Emma', 'last_name': 'Reyes', 'training_completed': 0}, {'avg_performance_rating': '4.3000000000000000', 'days_worked': 0, 'employee_id': 3536269, 'first_name': 'Noah', 'last_name': 'King', 'training_completed': 0}, {'avg_performance_rating': '4.5000000000000000', 'days_worked': 0, 'employee_id': 3536270, 'first_name': 'Charlotte', 'last_name': 'Cooper', 'training_completed': 0}]","[""SELECT e.employee_id, e.first_name, e.last_name, AVG(pr.performance_rating) AS avg_performance_rating, COUNT(DISTINCT a.date) AS days_worked, COUNT(DISTINCT et.training_id) AS training_completed FROM employee e LEFT JOIN performance_review pr ON e.employee_id = pr.employee_id LEFT JOIN attendance a ON e.employee_id = a.employee_id AND a.date BETWEEN CURRENT_DATE - INTERVAL '3 MONTH' AND CURRENT_DATE LEFT JOIN employee_training et ON e.employee_id = et.employee_id AND et.start_date BETWEEN CURRENT_DATE - INTERVAL '3 MONTH' AND CURRENT_DATE GROUP BY e.employee_id, e.first_name, e.last_name;""]",102,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Average performance rating of each employee in the last quarter, along with their attendance record and completion status of mandatory training sessions","{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH EmployeePerformance AS (
SELECT
e.employee_id,
e.first_name AS employee_first_name,
e.last_name AS employee_last_name,
AVG(p.performance_rating) AS average_performance_rating
FROM employee AS e
JOIN performance_review AS p
ON e.employee_id = p.employee_id
WHERE
p.review_date >= CURRENT_DATE - INTERVAL '3 months'
GROUP BY
e.employee_id,
e.first_name,
e.last_name
), EmployeeAttendance AS (
SELECT
a.employee_id,
COUNT(a.attendance_id) AS total_attendances
FROM attendance AS a
WHERE
a.date >= CURRENT_DATE - INTERVAL '3 months'
GROUP BY
a.employee_id
), EmployeeTrainingCompletion AS (
SELECT
etc.employee_id,
COUNT(etc.certification_id) AS total_completed_certifications
FROM employee_certification AS etc
JOIN training AS t
ON etc.certification_name = t.title
WHERE
t.attendance_required = TRUE
GROUP BY
etc.employee_id
)
SELECT
ep.employee_first_name,
ep.employee_last_name,
ep.average_performance_rating,
ea.total_attendances,
etc.total_completed_certifications
FROM EmployeePerformance AS ep
JOIN EmployeeAttendance AS ea
ON ep.employee_id = ea.employee_id
LEFT JOIN EmployeeTrainingCompletion AS etc
ON ep.employee_id = etc.employee_id
ORDER BY
ep.employee_first_name,
ep.employee_last_name;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'LEFT_JOIN', 'AGGREGATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find the average work hours and overtime hours recorded by employees in the ""Finance"" department in the last month.",[],"
WITH FinanceEmployees AS (
  SELECT
    employee_id
  FROM Employee
  WHERE
    department_id = (
      SELECT
        department_id
      FROM Department
      WHERE
        department_name = 'Finance'
    )
), AttendanceData AS (
  SELECT
    a.date,
    a.employee_id,
    AVG(a.work_hours) AS avg_work_hours,
    AVG(a.overtime_hours) AS avg_overtime_hours
  FROM Attendance AS a
  JOIN FinanceEmployees AS fe
    ON a.employee_id = fe.employee_id
  WHERE
    a.date BETWEEN CURRENT_DATE - INTERVAL '1 month' AND CURRENT_DATE
  GROUP BY
    a.date,
    a.employee_id
)
SELECT
  ad.date,
  AVG(ad.avg_work_hours) AS average_work_hours,
  AVG(ad.avg_overtime_hours) AS average_overtime_hours
FROM AttendanceData AS ad
GROUP BY
  ad.date
ORDER BY
  ad.date;
```",,"[{'avg_overtime_hours': '0.91666666666666666667', 'avg_work_hours': '8.0833333333333333', 'min': 'Finance'}]","[""SELECT AVG(Working_hours) AS avg_work_hours, AVG(Overtime) AS avg_overtime_hours, min(d.department_name) FROM timesheet_employee te JOIN timesheet t ON te.timesheet_id = t.timesheet_id JOIN employee e ON te.employee_id = e.employee_id JOIN department d ON e.department_id = d.department_id WHERE d.department_name = 'Finance';""]",62,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Find the average work hours and overtime hours recorded by employees in the ""Finance"" department in the last month.","{'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""department_name = \'Finance\'""'}",,dql,2025-02-10 18:36:22.083420,"
WITH FinanceEmployees AS (
SELECT
employee_id
FROM Employee
WHERE
department_id = (
SELECT
department_id
FROM Department
WHERE
department_name = 'Finance'
)
), AttendanceData AS (
SELECT
a.date,
a.employee_id,
AVG(a.work_hours) AS avg_work_hours,
AVG(a.overtime_hours) AS avg_overtime_hours
FROM Attendance AS a
JOIN FinanceEmployees AS fe
ON a.employee_id = fe.employee_id
WHERE
a.date BETWEEN CURRENT_DATE - INTERVAL '1 month' AND CURRENT_DATE
GROUP BY
a.date,
a.employee_id
)
SELECT
ad.date,
AVG(ad.avg_work_hours) AS average_work_hours,
AVG(ad.avg_overtime_hours) AS average_overtime_hours
FROM AttendanceData AS ad
GROUP BY
ad.date
ORDER BY
ad.date;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'AGGREGATE', 'DATE']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42P01', 'M': 'relation ""leaverequest"" does not exist', 'P': '454', 'F': 'parse_relation.c', 'L': '1452', 'R': 'parserOpenTable'}
[SQL: 
-- Calculate total annual leave entitlement based on start date and leave type
WITH EmployeeLeaveEntitlement AS (
SELECT
e.employee_id,
e.hire_date,
(
CASE
WHEN lr.""Leave type"" = 'Annual Leave' THEN
CASE
WHEN EXTRACT(MONTH FROM CURRENT_DATE) - EXTRACT(MONTH FROM e.hire_date) < 0 THEN
0-- Handle incomplete first year
ELSE
EXTRACT(MONTH FROM CURRENT_DATE) - EXTRACT(MONTH FROM e.hire_date) + 1
END
ELSE
0
END
) AS entitlement
FROM Employee e
LEFT JOIN LeaveRequest lr ON e.employee_id = lr.employee_id
)

-- Calculate total leave taken in the current year for each employee
SELECT
e.employee_id,
e.first_name || ' ' || e.last_name AS employee_name,
ele.entitlement AS annual_leave_entitlement,
COALESCE(SUM(lr.duration), 0) AS leave_taken_current_year,
(
ele.entitlement - COALESCE(SUM(lr.duration), 0)
) AS remaining_leave_entitlement

FROM Employee e
LEFT JOIN EmployeeLeaveEntitlement ele ON e.employee_id = ele.employee_id
LEFT JOIN LeaveRequest lr ON e.employee_id = lr.employee_id

-- Filter employees who have exceeded 50% of their leave entitlement
WHERE 
COALESCE(SUM(lr.duration), 0) * 2 > ele.entitlement

GROUP BY
e.employee_id,
e.first_name,
e.last_name,
ele.entitlement

HAVING
(
ele.entitlement - COALESCE(SUM(lr.duration), 0)
) * 2 < ele.entitlement;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List all employees who have utilized more than half of their annual leave entitlement by the current month.",[],"
-- Calculate total annual leave entitlement based on start date and leave type
WITH EmployeeLeaveEntitlement AS (
    SELECT
        e.employee_id,
        e.hire_date,
        (
            CASE
                WHEN lr.""Leave type"" = 'Annual Leave' THEN
                    CASE
                        WHEN EXTRACT(MONTH FROM CURRENT_DATE) - EXTRACT(MONTH FROM e.hire_date) < 0 THEN
                            0  -- Handle incomplete first year
                        ELSE
                            EXTRACT(MONTH FROM CURRENT_DATE) - EXTRACT(MONTH FROM e.hire_date) + 1
                    END
                ELSE
                    0
            END
        ) AS entitlement
    FROM Employee e
    LEFT JOIN LeaveRequest lr ON e.employee_id = lr.employee_id
)

-- Calculate total leave taken in the current year for each employee
SELECT
    e.employee_id,
    e.first_name || ' ' || e.last_name AS employee_name,
    ele.entitlement AS annual_leave_entitlement,
    COALESCE(SUM(lr.duration), 0) AS leave_taken_current_year,
    (
        ele.entitlement - COALESCE(SUM(lr.duration), 0)
    ) AS remaining_leave_entitlement

FROM Employee e
LEFT JOIN EmployeeLeaveEntitlement ele ON e.employee_id = ele.employee_id
LEFT JOIN LeaveRequest lr ON e.employee_id = lr.employee_id

-- Filter employees who have exceeded 50% of their leave entitlement
WHERE 
    COALESCE(SUM(lr.duration), 0) * 2 > ele.entitlement

GROUP BY
    e.employee_id,
    e.first_name,
    e.last_name,
    ele.entitlement

HAVING
    (
        ele.entitlement - COALESCE(SUM(lr.duration), 0)
    ) * 2 < ele.entitlement;
```",,[],"['SELECT e.employee_id, SUM(l.duration) AS total_leave_taken, (SELECT SUM(duration) FROM leave_request WHERE employee_id = e.employee_id AND EXTRACT(YEAR FROM start_date) = EXTRACT(YEAR FROM CURRENT_DATE)) AS annual_leave_entitlement FROM employee AS e JOIN leave_request AS l ON e.employee_id = l.employee_id WHERE EXTRACT(YEAR FROM l.start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND EXTRACT(MONTH FROM l.start_date) <= EXTRACT(MONTH FROM CURRENT_DATE) GROUP BY e.employee_id HAVING 2 * SUM(l.duration) >= (SELECT SUM(duration) FROM leave_request WHERE employee_id = e.employee_id AND EXTRACT(YEAR FROM start_date) = EXTRACT(YEAR FROM CURRENT_DATE));']",51,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,List all employees who have utilized more than half of their annual leave entitlement by the current month.,"{'Comment': '""Little Ambiguous, total count of leaves is not mentioned.""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
-- Calculate total annual leave entitlement based on start date and leave type
WITH EmployeeLeaveEntitlement AS (
SELECT
e.employee_id,
e.hire_date,
(
CASE
WHEN lr.""Leave type"" = 'Annual Leave' THEN
CASE
WHEN EXTRACT(MONTH FROM CURRENT_DATE) - EXTRACT(MONTH FROM e.hire_date) < 0 THEN
0-- Handle incomplete first year
ELSE
EXTRACT(MONTH FROM CURRENT_DATE) - EXTRACT(MONTH FROM e.hire_date) + 1
END
ELSE
0
END
) AS entitlement
FROM Employee e
LEFT JOIN LeaveRequest lr ON e.employee_id = lr.employee_id
)

-- Calculate total leave taken in the current year for each employee
SELECT
e.employee_id,
e.first_name || ' ' || e.last_name AS employee_name,
ele.entitlement AS annual_leave_entitlement,
COALESCE(SUM(lr.duration), 0) AS leave_taken_current_year,
(
ele.entitlement - COALESCE(SUM(lr.duration), 0)
) AS remaining_leave_entitlement

FROM Employee e
LEFT JOIN EmployeeLeaveEntitlement ele ON e.employee_id = ele.employee_id
LEFT JOIN LeaveRequest lr ON e.employee_id = lr.employee_id

-- Filter employees who have exceeded 50% of their leave entitlement
WHERE 
COALESCE(SUM(lr.duration), 0) * 2 > ele.entitlement

GROUP BY
e.employee_id,
e.first_name,
e.last_name,
ele.entitlement

HAVING
(
ele.entitlement - COALESCE(SUM(lr.duration), 0)
) * 2 < ele.entitlement;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'JOIN', 'AGGREGATE', 'HAVING', 'DATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List the top 10 employees id with the highest bonus amount in the first quarter of 2023.",[],"
SELECT e.employee_id, e.first_name, e.last_name, s.bonus
FROM ""employee"" AS e
JOIN ""salary"" AS s ON e.employee_id = s.employee_id
WHERE s.start_date <= '2023-03-31' AND s.end_date >= '2023-01-01'
ORDER BY s.bonus DESC
LIMIT 10;
```",,"[{'employee_id': 3536253}, {'employee_id': 3536252}, {'employee_id': 3536251}]","[""SELECT e.employee_id FROM employee e JOIN salary s ON e.employee_id = s.employee_id WHERE s.start_date >= '2023-01-01' AND s.start_date < '2023-04-01' ORDER BY s.bonus DESC LIMIT 10;""]",70,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,List the top 10 employees id with the highest bonus amount in the first quarter of 2023.,"{'Comment': '""LGTM, Fixed the year to 2024""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT e.employee_id, e.first_name, e.last_name, s.bonus
FROM ""employee"" AS e
JOIN ""salary"" AS s ON e.employee_id = s.employee_id
WHERE s.start_date <= '2023-03-31' AND s.end_date >= '2023-01-01'
ORDER BY s.bonus DESC
LIMIT 10;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'SORT', 'LIMIT']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42883', 'M': 'function pg_catalog.extract(unknown, numeric) does not exist', 'H': 'No function matches the given name and argument types. You might need to add explicit type casts.', 'P': '419', 'F': 'parse_func.c', 'L': '636', 'R': 'ParseFuncOrColumn'}
[SQL: 
WITH EmployeeAttendance AS (
SELECT
e.""employee_id"",
a.""check_in_time"",
a.""check_out_time"",
a.""date"",
COALESCE(a.""overtime_hours"", 0) AS overtime_hours
FROM ""employee"" AS e
INNER JOIN ""attendance"" AS a
ON e.""employee_id"" = a.""employee_id""
WHERE
a.""date"" BETWEEN ('2023-04-01'::date - interval '1 year') AND ('2023-04-01'::date)
), AttendanceSummary AS (
SELECT
""employee_id"",
COUNT(*) AS ""total_days_attendance"",
SUM(EXTRACT(HOUR FROM overtime_hours)) AS ""total_overtime_hours"",
SUM(EXTRACT(MINUTE FROM overtime_hours)) AS ""total_overtime_minutes""
FROM EmployeeAttendance
GROUP BY
""employee_id""
), PerformanceReviews AS (
SELECT
""employee_id"",
AVG(""performance_rating"") AS ""average_performance_rating""
FROM ""performance_review""
WHERE
""review_date"" BETWEEN ('2023-04-01'::date - interval '1 year') AND ('2023-04-01'::date)
GROUP BY
""employee_id""
)
SELECT
AttendanceSummary.""employee_id"",
AttendanceSummary.""total_days_attendance"",
AttendanceSummary.""total_overtime_hours"",
(AttendanceSummary.""total_overtime_hours"" * 60 + AttendanceSummary.""total_overtime_minutes"") AS ""total_overtime_minutes"",
round(PerformanceReviews.""average_performance_rating"", 2) AS ""average_performance_rating"",
(
(AttendanceSummary.""total_days_attendance"" + AttendanceSummary.""total_overtime_hours"") * AttendanceSummary.""average_performance_rating""
) AS ""weighted_performance_score""
FROM AttendanceSummary
INNER JOIN PerformanceReviews
ON AttendanceSummary.""employee_id"" = PerformanceReviews.""employee_id"";
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Calculate the correlation between employee attendance records and their performance ratings over the past year to assess the impact of attendance on job performance",[],"
WITH EmployeeAttendance AS (
    SELECT
        e.""employee_id"",
        a.""check_in_time"",
        a.""check_out_time"",
        a.""date"",
        COALESCE(a.""overtime_hours"", 0) AS overtime_hours
    FROM ""employee"" AS e
    INNER JOIN ""attendance"" AS a
        ON e.""employee_id"" = a.""employee_id""
    WHERE
        a.""date"" BETWEEN ('2023-04-01'::date - interval '1 year') AND ('2023-04-01'::date)
), AttendanceSummary AS (
    SELECT
        ""employee_id"",
        COUNT(*) AS ""total_days_attendance"",
        SUM(EXTRACT(HOUR FROM overtime_hours)) AS ""total_overtime_hours"",
        SUM(EXTRACT(MINUTE FROM overtime_hours)) AS ""total_overtime_minutes""
    FROM EmployeeAttendance
    GROUP BY
        ""employee_id""
), PerformanceReviews AS (
    SELECT
        ""employee_id"",
        AVG(""performance_rating"") AS ""average_performance_rating""
    FROM ""performance_review""
    WHERE
        ""review_date"" BETWEEN ('2023-04-01'::date - interval '1 year') AND ('2023-04-01'::date)
    GROUP BY
        ""employee_id""
)
SELECT
    AttendanceSummary.""employee_id"",
    AttendanceSummary.""total_days_attendance"",
    AttendanceSummary.""total_overtime_hours"",
    (AttendanceSummary.""total_overtime_hours"" * 60 + AttendanceSummary.""total_overtime_minutes"") AS ""total_overtime_minutes"",
    round(PerformanceReviews.""average_performance_rating"", 2) AS ""average_performance_rating"",
    (
        (AttendanceSummary.""total_days_attendance"" + AttendanceSummary.""total_overtime_hours"") * AttendanceSummary.""average_performance_rating""
    ) AS ""weighted_performance_score""
FROM AttendanceSummary
INNER JOIN PerformanceReviews
    ON AttendanceSummary.""employee_id"" = PerformanceReviews.""employee_id"";
```",,"[{'avg_performance_rating': '4.2000000000000000', 'avg_work_hours': '7.0000000000000000'}, {'avg_performance_rating': '4.0000000000000000', 'avg_work_hours': '9.0000000000000000'}, {'avg_performance_rating': '4.5000000000000000', 'avg_work_hours': '8.0000000000000000'}, {'avg_performance_rating': '4.3000000000000000', 'avg_work_hours': '8.0000000000000000'}, {'avg_performance_rating': '4.1000000000000000', 'avg_work_hours': '8.0000000000000000'}, {'avg_performance_rating': '4.0000000000000000', 'avg_work_hours': '8.0000000000000000'}, {'avg_performance_rating': '4.5000000000000000', 'avg_work_hours': '8.0000000000000000'}, {'avg_performance_rating': '3.8000000000000000', 'avg_work_hours': '8.0000000000000000'}, {'avg_performance_rating': '4.3000000000000000', 'avg_work_hours': '9.0000000000000000'}, {'avg_performance_rating': '4.5000000000000000', 'avg_work_hours': '8.0000000000000000'}, {'avg_performance_rating': '3.9000000000000000', 'avg_work_hours': '8.0000000000000000'}, {'avg_performance_rating': '4.4000000000000000', 'avg_work_hours': '8.0000000000000000'}, {'avg_performance_rating': '3.9000000000000000', 'avg_work_hours': '7.0000000000000000'}, {'avg_performance_rating': '4.6000000000000000', 'avg_work_hours': '8.0000000000000000'}, {'avg_performance_rating': '4.6000000000000000', 'avg_work_hours': '8.0000000000000000'}, {'avg_performance_rating': '4.2000000000000000', 'avg_work_hours': '8.0000000000000000'}, {'avg_performance_rating': '4.1000000000000000', 'avg_work_hours': '8.0000000000000000'}, {'avg_performance_rating': '4.4000000000000000', 'avg_work_hours': '9.0000000000000000'}, {'avg_performance_rating': '4.3000000000000000', 'avg_work_hours': '9.0000000000000000'}, {'avg_performance_rating': '3.8000000000000000', 'avg_work_hours': '8.0000000000000000'}]","['SELECT AVG(a.work_hours) AS avg_work_hours, AVG(pr.performance_rating) AS avg_performance_rating FROM attendance a JOIN performance_review pr ON a.employee_id = pr.employee_id GROUP BY a.employee_id;']",110,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Calculate the correlation between employee attendance records and their performance ratings over the past year to assess the impact of attendance on job performance,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH EmployeeAttendance AS (
SELECT
e.""employee_id"",
a.""check_in_time"",
a.""check_out_time"",
a.""date"",
COALESCE(a.""overtime_hours"", 0) AS overtime_hours
FROM ""employee"" AS e
INNER JOIN ""attendance"" AS a
ON e.""employee_id"" = a.""employee_id""
WHERE
a.""date"" BETWEEN ('2023-04-01'::date - interval '1 year') AND ('2023-04-01'::date)
), AttendanceSummary AS (
SELECT
""employee_id"",
COUNT(*) AS ""total_days_attendance"",
SUM(EXTRACT(HOUR FROM overtime_hours)) AS ""total_overtime_hours"",
SUM(EXTRACT(MINUTE FROM overtime_hours)) AS ""total_overtime_minutes""
FROM EmployeeAttendance
GROUP BY
""employee_id""
), PerformanceReviews AS (
SELECT
""employee_id"",
AVG(""performance_rating"") AS ""average_performance_rating""
FROM ""performance_review""
WHERE
""review_date"" BETWEEN ('2023-04-01'::date - interval '1 year') AND ('2023-04-01'::date)
GROUP BY
""employee_id""
)
SELECT
AttendanceSummary.""employee_id"",
AttendanceSummary.""total_days_attendance"",
AttendanceSummary.""total_overtime_hours"",
(AttendanceSummary.""total_overtime_hours"" * 60 + AttendanceSummary.""total_overtime_minutes"") AS ""total_overtime_minutes"",
round(PerformanceReviews.""average_performance_rating"", 2) AS ""average_performance_rating"",
(
(AttendanceSummary.""total_days_attendance"" + AttendanceSummary.""total_overtime_hours"") * AttendanceSummary.""average_performance_rating""
) AS ""weighted_performance_score""
FROM AttendanceSummary
INNER JOIN PerformanceReviews
ON AttendanceSummary.""employee_id"" = PerformanceReviews.""employee_id"";
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'AGGREGATE', 'JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List all employees who have been assigned company-owned computers with expired warranties, along with the models of their computers.","[{'first_name': 'John', 'last_name': 'Doe', 'model': 'Dell XPS 15'}, {'first_name': 'Alice', 'last_name': 'Smith', 'model': 'HP Pavilion'}, {'first_name': 'Michael', 'last_name': 'Johnson', 'model': 'MacBook Pro'}, {'first_name': 'Matthew', 'last_name': 'Brown', 'model': 'Asus ZenBook'}, {'first_name': 'Sarah', 'last_name': 'Jones', 'model': 'Acer Aspire'}, {'first_name': 'Christopher', 'last_name': 'Davis', 'model': 'Microsoft Surface'}, {'first_name': 'Taylor', 'last_name': 'Rodriguez', 'model': 'Asus ROG Strix'}, {'first_name': 'Megan', 'last_name': 'Hernandez', 'model': 'Microsoft Surface Studio'}, {'first_name': 'Andrew', 'last_name': 'Gonzalez', 'model': 'Dell Inspiron'}, {'first_name': 'Sophia', 'last_name': 'Perez', 'model': 'Apple iMac'}, {'first_name': 'Aiden', 'last_name': 'Torres', 'model': 'HP Envy'}, {'first_name': 'Emma', 'last_name': 'Reyes', 'model': 'Lenovo Legion'}, {'first_name': 'Noah', 'last_name': 'King', 'model': 'Asus VivoBook'}]","
/* Select employee first name, last name, and computer model where the warranty expiry date is less than or equal to today's date. */
SELECT
    e.""first_name"",
    e.""last_name"",
    ec.""model""
FROM
    ""employee_computer"" AS ec
JOIN
    ""employee"" AS e
ON
    ec.""employee_id"" = e.""employee_id""
WHERE
    ec.""warranty_expiry_date"" <= CURRENT_DATE;
```",,"[{'employee_id': 3536251, 'first_name': 'John', 'model': 'Dell XPS 15'}, {'employee_id': 3536252, 'first_name': 'Alice', 'model': 'HP Pavilion'}, {'employee_id': 3536253, 'first_name': 'Michael', 'model': 'MacBook Pro'}, {'employee_id': 3536255, 'first_name': 'Matthew', 'model': 'Asus ZenBook'}, {'employee_id': 3536256, 'first_name': 'Sarah', 'model': 'Acer Aspire'}, {'employee_id': 3536257, 'first_name': 'Christopher', 'model': 'Microsoft Surface'}, {'employee_id': 3536260, 'first_name': 'Taylor', 'model': 'Asus ROG Strix'}, {'employee_id': 3536262, 'first_name': 'Megan', 'model': 'Microsoft Surface Studio'}, {'employee_id': 3536263, 'first_name': 'Andrew', 'model': 'Dell Inspiron'}, {'employee_id': 3536264, 'first_name': 'Sophia', 'model': 'Apple iMac'}, {'employee_id': 3536265, 'first_name': 'Aiden', 'model': 'HP Envy'}, {'employee_id': 3536268, 'first_name': 'Emma', 'model': 'Lenovo Legion'}, {'employee_id': 3536269, 'first_name': 'Noah', 'model': 'Asus VivoBook'}]","['SELECT e.employee_id, e.first_name, ec.model FROM employee e JOIN employee_computer ec ON e.employee_id = ec.employee_id WHERE ec.warranty_expiry_date < CURRENT_DATE;']",56,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"List all employees who have been assigned company-owned computers with expired warranties, along with the models of their computers.","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
/* Select employee first name, last name, and computer model where the warranty expiry date is less than or equal to today's date. */
SELECT
e.""first_name"",
e.""last_name"",
ec.""model""
FROM
""employee_computer"" AS ec
JOIN
""employee"" AS e
ON
ec.""employee_id"" = e.""employee_id""
WHERE
ec.""warranty_expiry_date"" <= CURRENT_DATE;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'JOIN']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42703', 'M': 'column tr.employee_id does not exist', 'H': 'Perhaps you meant to reference the column ""lr.employee_id"" or the column ""t.employee_id"".', 'P': '821', 'F': 'parse_relation.c', 'L': '3755', 'R': 'errorMissingColumn'}
[SQL: 
SELECT SUM(employee_benefit_allowance.amount), b.""benefit_name""
FROM employee_allowances AS employee_benefit_allowance
INNER JOIN benefit AS b
ON employee_benefit_allowance.allowance_id = b.benefit_id
INNER JOIN employee AS e
ON employee_benefit_allowance.employee_id = e.employee_id
INNER JOIN department AS dept
ON dept.department_id = e.department_id
INNER JOIN company AS com
ON com.company_id = e.company_id
INNER JOIN job_history AS jh
ON jh.employee_id = e.employee_id
INNER JOIN job AS job
ON jh.job_id = job.job_id
INNER JOIN salary AS s
ON s.employee_id = e.employee_id
INNER JOIN attendance AS a
ON a.employee_id = e.employee_id
INNER JOIN leave_request AS lr
ON lr.employee_id = e.employee_id
INNER JOIN timesheet_employee AS t
ON t.employee_id = e.employee_id
INNER JOIN training AS tr
ON lr.employee_id = tr.employee_id
INNER JOIN performance_review AS pr
ON pr.employee_id = e.employee_id
WHERE com.financial_year_end >= DATE_TRUNC('year', NOW()) AND com.financial_year_end < DATE_TRUNC('year', NOW() + INTERVAL '1 year') AND b.benefit_name = 'Health Insurance'
GROUP BY 2
;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Determine the total expenses incurred by the company on employee benefits in the last financial year, broken down by each benefit category.",[],"
SELECT SUM(employee_benefit_allowance.amount), b.""benefit_name""
FROM employee_allowances AS employee_benefit_allowance
INNER JOIN benefit AS b
  ON employee_benefit_allowance.allowance_id = b.benefit_id
INNER JOIN employee AS e
  ON employee_benefit_allowance.employee_id = e.employee_id
INNER JOIN department AS dept
  ON dept.department_id = e.department_id
INNER JOIN company AS com
  ON com.company_id = e.company_id
INNER JOIN job_history AS jh
  ON jh.employee_id = e.employee_id
INNER JOIN job AS job
  ON jh.job_id = job.job_id
INNER JOIN salary AS s
  ON s.employee_id = e.employee_id
INNER JOIN attendance AS a
  ON a.employee_id = e.employee_id
INNER JOIN leave_request AS lr
  ON lr.employee_id = e.employee_id
INNER JOIN timesheet_employee AS t
  ON t.employee_id = e.employee_id
INNER JOIN training AS tr
  ON lr.employee_id = tr.employee_id
INNER JOIN performance_review AS pr
  ON pr.employee_id = e.employee_id
WHERE com.financial_year_end >= DATE_TRUNC('year', NOW()) AND com.financial_year_end < DATE_TRUNC('year', NOW() + INTERVAL '1 year') AND b.benefit_name = 'Health Insurance'
GROUP BY 2
;
```",,[],"['SELECT allowance, SUM(amount) AS total_expenses FROM employee_allowances ea JOIN allowances a ON ea.allowance_id = a.allowance_id WHERE EXTRACT(YEAR FROM ea.effective_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 GROUP BY allowance;']",49,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Determine the total expenses incurred by the company on employee benefits in the last financial year, broken down by each benefit category.","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT SUM(employee_benefit_allowance.amount), b.""benefit_name""
FROM employee_allowances AS employee_benefit_allowance
INNER JOIN benefit AS b
ON employee_benefit_allowance.allowance_id = b.benefit_id
INNER JOIN employee AS e
ON employee_benefit_allowance.employee_id = e.employee_id
INNER JOIN department AS dept
ON dept.department_id = e.department_id
INNER JOIN company AS com
ON com.company_id = e.company_id
INNER JOIN job_history AS jh
ON jh.employee_id = e.employee_id
INNER JOIN job AS job
ON jh.job_id = job.job_id
INNER JOIN salary AS s
ON s.employee_id = e.employee_id
INNER JOIN attendance AS a
ON a.employee_id = e.employee_id
INNER JOIN leave_request AS lr
ON lr.employee_id = e.employee_id
INNER JOIN timesheet_employee AS t
ON t.employee_id = e.employee_id
INNER JOIN training AS tr
ON lr.employee_id = tr.employee_id
INNER JOIN performance_review AS pr
ON pr.employee_id = e.employee_id
WHERE com.financial_year_end >= DATE_TRUNC('year', NOW()) AND com.financial_year_end < DATE_TRUNC('year', NOW() + INTERVAL '1 year') AND b.benefit_name = 'Health Insurance'
GROUP BY 2
;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'AGGREGATE', 'DATE']",
[],db_hr,['postgres'],[],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Identify employees with a high number of job changes in the last two years, along with their current job titles and departmental information","[{'department_id': 3, 'department_name': 'Finance', 'employee_id': 3536251, 'first_name': 'John', 'job_changes': 1, 'job_title': 'Financial Analyst', 'last_name': 'Doe', 'manager_id': 3536253}, {'department_id': 3, 'department_name': 'Finance', 'employee_id': 3536259, 'first_name': 'Daniel', 'job_changes': 1, 'job_title': 'Financial Analyst', 'last_name': 'Garcia', 'manager_id': 3536253}, {'department_id': 3, 'department_name': 'Finance', 'employee_id': 3536269, 'first_name': 'Noah', 'job_changes': 1, 'job_title': 'Financial Analyst', 'last_name': 'King', 'manager_id': 3536253}]","
WITH JobChangeCounts AS (
  SELECT
    employee_id,
    COUNT(job_id) AS job_changes
  FROM Job_History
  WHERE
    end_date BETWEEN date '2022-10-26' AND date '2023-10-25'
  GROUP BY
    employee_id
)
SELECT
  Employee.employee_id,
  Employee.first_name,
  Employee.last_name,
  JobChangeCounts.job_changes,
  Job.job_title,
  Job.department_id,
  Department.department_name,
  Department.manager_id
FROM Employee
JOIN JobChangeCounts
  ON Employee.employee_id = JobChangeCounts.employee_id
JOIN Job_History
  ON Employee.employee_id = Job_History.employee_id
JOIN Job
  ON Job_History.job_id = Job.job_id
JOIN Department
  ON Job.department_id = Department.department_id
WHERE
  Job_History.end_date = (
    SELECT
      MAX(end_date)
    FROM Job_History
    WHERE
      employee_id = Employee.employee_id
  )
ORDER BY
  JobChangeCounts.job_changes DESC;
```",,[],[],104,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Identify employees with a high number of job changes in the last two years, along with their current job titles and departmental information","{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH JobChangeCounts AS (
SELECT
employee_id,
COUNT(job_id) AS job_changes
FROM Job_History
WHERE
end_date BETWEEN date '2022-10-26' AND date '2023-10-25'
GROUP BY
employee_id
)
SELECT
Employee.employee_id,
Employee.first_name,
Employee.last_name,
JobChangeCounts.job_changes,
Job.job_title,
Job.department_id,
Department.department_name,
Department.manager_id
FROM Employee
JOIN JobChangeCounts
ON Employee.employee_id = JobChangeCounts.employee_id
JOIN Job_History
ON Employee.employee_id = Job_History.employee_id
JOIN Job
ON Job_History.job_id = Job.job_id
JOIN Department
ON Job.department_id = Department.department_id
WHERE
Job_History.end_date = (
SELECT
MAX(end_date)
FROM Job_History
WHERE
employee_id = Employee.employee_id
)
ORDER BY
JobChangeCounts.job_changes DESC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'AGGREGATE', 'JOIN', 'SORT', 'DATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Calculate the average training expenses incurred per employee in the last quarter, categorized by department and job title",[],"
SELECT
  D.department_name,
  J.job_title,
  AVG(EBX.expense_amount)
FROM employee_business_expense AS EBX
JOIN employee AS E
  ON EBX.employee_id = E.employee_id
JOIN department AS D
  ON E.department_id = D.department_id
JOIN job AS J
  ON E.job_id = J.job_id
WHERE
  EBX.expense_category = 'Training' AND EBX.expense_date >= (
    SELECT
      CURRENT_DATE - INTERVAL '3 months'
  )
GROUP BY
  D.department_name,
  J.job_title
HAVING
  AVG(EBX.expense_amount) > 0
ORDER BY
  D.department_name,
  J.job_title;
```",,[],"[""SELECT d.department_name, j.job_title, AVG(t.duration) AS avg_training_expenses_per_employee FROM department d JOIN job j ON d.department_id = j.department_id JOIN employee e ON j.job_id = e.job_id JOIN employee_training et ON e.employee_id = et.employee_id AND et.start_date BETWEEN CURRENT_DATE - INTERVAL '3 MONTH' AND CURRENT_DATE JOIN training t ON et.training_id = t.training_id GROUP BY d.department_name, j.job_title;""]",106,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Calculate the average training expenses incurred per employee in the last quarter, categorized by department and job title","{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
D.department_name,
J.job_title,
AVG(EBX.expense_amount)
FROM employee_business_expense AS EBX
JOIN employee AS E
ON EBX.employee_id = E.employee_id
JOIN department AS D
ON E.department_id = D.department_id
JOIN job AS J
ON E.job_id = J.job_id
WHERE
EBX.expense_category = 'Training' AND EBX.expense_date >= (
SELECT
CURRENT_DATE - INTERVAL '3 months'
)
GROUP BY
D.department_name,
J.job_title
HAVING
AVG(EBX.expense_amount) > 0
ORDER BY
D.department_name,
J.job_title;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'AGGREGATE', 'JOIN', 'DATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


How many employees are eligible for retirement within the next five years?",[{'count': 0}],"
-- Count the number of employees whose date of birth plus 65 years is within the next five years.
SELECT
    COUNT(e.employee_id)
FROM
    ""employee"" AS e
WHERE
    e.""date_of_birth"" + INTERVAL '65 years' BETWEEN CURRENT_DATE AND CURRENT_DATE + INTERVAL '5 years';
```",,[{'total_eligible_for_retirement': 10}],"[""SELECT COUNT(*) AS total_eligible_for_retirement FROM employee WHERE date_of_birth + INTERVAL '65 years' <= CURRENT_DATE + INTERVAL '30 years'""]",14,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,How many employees are eligible for retirement within the next five years?,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""Retirement age = 65""'}",,dql,2025-02-10 18:36:22.083420,"
-- Count the number of employees whose date of birth plus 65 years is within the next five years.
SELECT
COUNT(e.employee_id)
FROM
""employee"" AS e
WHERE
e.""date_of_birth"" + INTERVAL '65 years' BETWEEN CURRENT_DATE AND CURRENT_DATE + INTERVAL '5 years';
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'AGGREGATE', 'DATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Calculate the average salary of employees in each department, considering only full-time employees.",[],"
SELECT
  d.department_name,
  AVG(s.salary)
FROM salary AS s
JOIN employee AS e
  ON s.employee_id = e.employee_id
JOIN department AS d
  ON d.department_id = e.department_id
WHERE
  e.contract_type = 'FULL TIME'
GROUP BY
  d.department_id,
  d.department_name
ORDER BY
  d.department_name NULLS LAST;
```",,"[{'average_salary': '68333.333333333333', 'department_name': 'Finance'}, {'average_salary': '65000.000000000000', 'department_name': 'Human Resources'}, {'average_salary': '73750.000000000000', 'department_name': 'Marketing'}]","[""SELECT d.department_name, AVG(s.salary) AS average_salary FROM employee e JOIN department d ON e.department_id = d.department_id JOIN salary s ON e.employee_id = s.employee_id WHERE e.contract_type = 'Full-time' GROUP BY d.department_name;""]",72,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Calculate the average salary of employees in each department, considering only full-time employees.","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""contract_type = \'Full-time\'""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
d.department_name,
AVG(s.salary)
FROM salary AS s
JOIN employee AS e
ON s.employee_id = e.employee_id
JOIN department AS d
ON d.department_id = e.department_id
WHERE
e.contract_type = 'FULL TIME'
GROUP BY
d.department_id,
d.department_name
ORDER BY
d.department_name NULLS LAST;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'AGGREGATE', 'Data Linking']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


How many employees have completed mandatory compliance training?",[{'count': 0}],"
SELECT
  COUNT(DISTINCT emp.employee_id)
FROM employee AS emp
LEFT JOIN employee_training AS et
  ON emp.employee_id = et.employee_id
INNER JOIN training AS t
  ON et.training_id = t.training_id
WHERE
  t.title = 'Mandatory Compliance Training' AND emp.employee_id IS NOT NULL AND
  t.date < (
    SELECT
      MAX(date)
    FROM training AS t2
    WHERE
      t2.title = 'Mandatory Compliance Training'
  );
```",,[{'total_completed_compliance_training': 17}],['SELECT COUNT(DISTINCT employee_id) AS total_completed_compliance_training FROM employee_training WHERE training_id IN ( SELECT training_id FROM training WHERE attendance_required = true );'],17,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,How many employees have completed mandatory compliance training?,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
COUNT(DISTINCT emp.employee_id)
FROM employee AS emp
LEFT JOIN employee_training AS et
ON emp.employee_id = et.employee_id
INNER JOIN training AS t
ON et.training_id = t.training_id
WHERE
t.title = 'Mandatory Compliance Training' AND emp.employee_id IS NOT NULL AND
t.date < (
SELECT
MAX(date)
FROM training AS t2
WHERE
t2.title = 'Mandatory Compliance Training'
);
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42702', 'M': 'column reference ""benefit_id"" is ambiguous', 'P': '31', 'F': 'parse_relation.c', 'L': '835', 'R': 'scanRTEForColumn'}
[SQL: 
WITH BenefitCost AS (
SELECT
benefit_id,
SUM(amount) AS total_cost
FROM
employee_x_benefit AS exb
JOIN
benefit AS b ON exb.benefit_id = b.benefit_id
GROUP BY
benefit_id
), DepartmentBenefits AS (
SELECT
e.department_id,
exb.benefit_id,
b.benefit_name
FROM
employee_x_benefit AS exb
JOIN
employee AS e ON exb.employee_id = e.employee_id
JOIN
benefit AS b ON exb.benefit_id = b.benefit_id
), DepartmentTotalCost AS (
SELECT
db.department_id,
bc.benefit_name,
SUM(bc.total_cost) AS total_cost
FROM
DepartmentBenefits AS db
JOIN
BenefitCost AS bc ON db.benefit_id = bc.benefit_id
GROUP BY
db.department_id,
bc.benefit_name
)
SELECT
dtc.department_id,
dtc.benefit_name,
dtc.total_cost
FROM
DepartmentTotalCost AS dtc
JOIN
department AS d ON dtc.department_id = d.department_id
ORDER BY
dtc.department_id,
dtc.total_cost DESC;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


What is the total cost of benefits for each department?",[],"
WITH BenefitCost AS (
    SELECT
        benefit_id,
        SUM(amount) AS total_cost
    FROM
        employee_x_benefit AS exb
    JOIN
        benefit AS b ON exb.benefit_id = b.benefit_id
    GROUP BY
        benefit_id
), DepartmentBenefits AS (
    SELECT
        e.department_id,
        exb.benefit_id,
        b.benefit_name
    FROM
        employee_x_benefit AS exb
    JOIN
        employee AS e ON exb.employee_id = e.employee_id
    JOIN
        benefit AS b ON exb.benefit_id = b.benefit_id
), DepartmentTotalCost AS (
    SELECT
        db.department_id,
        bc.benefit_name,
        SUM(bc.total_cost) AS total_cost
    FROM
        DepartmentBenefits AS db
    JOIN
        BenefitCost AS bc ON db.benefit_id = bc.benefit_id
    GROUP BY
        db.department_id,
        bc.benefit_name
)
SELECT
    dtc.department_id,
    dtc.benefit_name,
    dtc.total_cost
FROM
    DepartmentTotalCost AS dtc
JOIN
    department AS d ON dtc.department_id = d.department_id
ORDER BY
    dtc.department_id,
    dtc.total_cost DESC;
```",,"[{'department_id': 3, 'department_name': 'Finance', 'total_benefit_cost': '1200000.00'}, {'department_id': 1, 'department_name': 'Human Resources', 'total_benefit_cost': '700000.00'}, {'department_id': 2, 'department_name': 'Marketing', 'total_benefit_cost': '1050000.00'}]","['SELECT d.department_id, d.department_name, SUM(budget) AS total_benefit_cost FROM benefit b JOIN employee_x_benefit eb ON b.benefit_id = eb.benefit_id JOIN employee e ON eb.employee_id = e.employee_id JOIN department d ON e.department_id = d.department_id GROUP BY d.department_id, d.department_name;']",19,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,What is the total cost of benefits for each department?,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH BenefitCost AS (
SELECT
benefit_id,
SUM(amount) AS total_cost
FROM
employee_x_benefit AS exb
JOIN
benefit AS b ON exb.benefit_id = b.benefit_id
GROUP BY
benefit_id
), DepartmentBenefits AS (
SELECT
e.department_id,
exb.benefit_id,
b.benefit_name
FROM
employee_x_benefit AS exb
JOIN
employee AS e ON exb.employee_id = e.employee_id
JOIN
benefit AS b ON exb.benefit_id = b.benefit_id
), DepartmentTotalCost AS (
SELECT
db.department_id,
bc.benefit_name,
SUM(bc.total_cost) AS total_cost
FROM
DepartmentBenefits AS db
JOIN
BenefitCost AS bc ON db.benefit_id = bc.benefit_id
GROUP BY
db.department_id,
bc.benefit_name
)
SELECT
dtc.department_id,
dtc.benefit_name,
dtc.total_cost
FROM
DepartmentTotalCost AS dtc
JOIN
department AS d ON dtc.department_id = d.department_id
ORDER BY
dtc.department_id,
dtc.total_cost DESC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'AGGREGATE']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42883', 'M': 'operator does not exist: jsonb && jsonb', 'H': 'No operator matches the given name and argument types. You might need to add explicit type casts.', 'P': '172', 'F': 'parse_oper.c', 'L': '656', 'R': 'op_error'}
[SQL: 
WITH SharedClients AS (
SELECT
c1.company_name AS company_1,
c2.company_name AS company_2,
COUNT(*) AS shared_clients
FROM
company c1
INNER JOIN company c2 ON c1.clients && c2.clients
WHERE
c1.company_name <> c2.company_name
GROUP BY
1,
2
)
SELECT
company_2,
shared_clients
FROM
SharedClients
WHERE
company_1 = 'Your Company'
ORDER BY
shared_clients DESC
LIMIT 3;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Identify the companys top three competitors based on the number of shared clients",[],"
WITH SharedClients AS (
    SELECT
        c1.company_name AS company_1,
        c2.company_name AS company_2,
        COUNT(*) AS shared_clients
    FROM
        company c1
    INNER JOIN company c2 ON c1.clients && c2.clients
    WHERE
        c1.company_name <> c2.company_name
    GROUP BY
        1,
        2
)
SELECT
    company_2,
    shared_clients
FROM
    SharedClients
WHERE
    company_1 = 'Your Company'
ORDER BY
    shared_clients DESC
LIMIT 3;
```",,"[{'competitors': ['Competitor A', 'Competitor B'], 'shared_clients': 3}, {'competitors': ['Competitor E', 'Competitor F'], 'shared_clients': 2}, {'competitors': ['Competitor X'], 'shared_clients': 2}, {'competitors': ['Competitor C', 'Competitor D'], 'shared_clients': 2}, {'competitors': None, 'shared_clients': 2}, {'competitors': ['Competitor Y', 'Competitor Z'], 'shared_clients': 2}, {'competitors': ['Competitor W'], 'shared_clients': 2}, {'competitors': ['Competitor G', 'Competitor H'], 'shared_clients': 2}]","['SELECT competitors, COUNT(*) AS shared_clients FROM company GROUP BY competitors HAVING COUNT(*) >= ( select cp from(SELECT competitors, COUNT(*) AS cp FROM company GROUP BY competitors  ORDER BY cp DESC LIMIT 1 OFFSET 2) as x) ORDER BY shared_clients DESC']",84,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Identify the companys top three competitors based on the number of shared clients,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH SharedClients AS (
SELECT
c1.company_name AS company_1,
c2.company_name AS company_2,
COUNT(*) AS shared_clients
FROM
company c1
INNER JOIN company c2 ON c1.clients && c2.clients
WHERE
c1.company_name <> c2.company_name
GROUP BY
1,
2
)
SELECT
company_2,
shared_clients
FROM
SharedClients
WHERE
company_1 = 'Your Company'
ORDER BY
shared_clients DESC
LIMIT 3;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'AGGREGATE', 'LIMIT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List the invoices that are overdue, including due date and amount.",[],"
SELECT ""i"".""invoice_id"",
       ""i"".""due_date"",
       ""i"".""total_amount""
       FROM ""invoice"" AS ""i""
       WHERE ""i"".""due_date"" < CURRENT_DATE
       AND ""i"".""status"" = 'unpaid';
```",,"[{'due_date': '2023-01-31', 'invoice_id': 1, 'total_amount': '1500.00'}, {'due_date': '2023-02-28', 'invoice_id': 2, 'total_amount': '1200.00'}, {'due_date': '2023-03-31', 'invoice_id': 3, 'total_amount': '1800.00'}, {'due_date': '2023-04-30', 'invoice_id': 4, 'total_amount': '900.00'}, {'due_date': '2023-05-31', 'invoice_id': 5, 'total_amount': '2000.00'}, {'due_date': '2023-06-30', 'invoice_id': 6, 'total_amount': '1600.00'}, {'due_date': '2023-07-31', 'invoice_id': 7, 'total_amount': '1400.00'}, {'due_date': '2023-08-31', 'invoice_id': 8, 'total_amount': '1100.00'}, {'due_date': '2023-09-30', 'invoice_id': 9, 'total_amount': '1700.00'}, {'due_date': '2023-10-31', 'invoice_id': 10, 'total_amount': '1300.00'}, {'due_date': '2023-11-30', 'invoice_id': 11, 'total_amount': '1900.00'}, {'due_date': '2023-12-31', 'invoice_id': 12, 'total_amount': '1000.00'}, {'due_date': '2024-01-31', 'invoice_id': 13, 'total_amount': '1500.00'}, {'due_date': '2024-02-29', 'invoice_id': 14, 'total_amount': '1200.00'}, {'due_date': '2024-03-31', 'invoice_id': 15, 'total_amount': '1800.00'}, {'due_date': '2024-04-30', 'invoice_id': 16, 'total_amount': '900.00'}, {'due_date': '2024-05-31', 'invoice_id': 17, 'total_amount': '2000.00'}, {'due_date': '2024-06-30', 'invoice_id': 18, 'total_amount': '1600.00'}, {'due_date': '2024-07-31', 'invoice_id': 19, 'total_amount': '1400.00'}, {'due_date': '2024-08-31', 'invoice_id': 20, 'total_amount': '1100.00'}]","['SELECT i.invoice_id, i.total_amount, i.due_date FROM invoice i LEFT JOIN payment p ON i.invoice_id = p.invoice_id WHERE i.due_date < CURRENT_DATE;']",21,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"List the invoices that are overdue, including due date and amount.","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT ""i"".""invoice_id"",
 ""i"".""due_date"",
 ""i"".""total_amount""
 FROM ""invoice"" AS ""i""
 WHERE ""i"".""due_date"" < CURRENT_DATE
 AND ""i"".""status"" = 'unpaid';
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'LEFT_JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find the average duration of leaves taken by employees in the year of 2023.",[{'avg': '9.5000000000000000'}],"
SELECT
  AVG(""l"".""duration"")
FROM ""leave_request"" AS ""l""
JOIN ""timesheet_employee"" AS ""te""
  ON ""l"".""employee_id"" = ""te"".""employee_id""
WHERE
  EXTRACT(YEAR FROM ""l"".""start_date"") = 2023;
```",,[{'average_leave_duration': '13.0833333333333333'}],"[""SELECT AVG(duration) AS average_leave_duration FROM leave_request WHERE EXTRACT(YEAR FROM start_date) = '2023'""]",67,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Find the average duration of leaves taken by employees in the year of 2023.,"{'Comment': '""LGTM, financial year changes from country to country.""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
AVG(""l"".""duration"")
FROM ""leave_request"" AS ""l""
JOIN ""timesheet_employee"" AS ""te""
ON ""l"".""employee_id"" = ""te"".""employee_id""
WHERE
EXTRACT(YEAR FROM ""l"".""start_date"") = 2023;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'AGGREGATE', 'DATE', 'time']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List all managers id who have been assigned to departments with budgets exceeding $100,000.","[{'manager_id': 3536254}, {'manager_id': 3536256}, {'manager_id': 3536260}, {'manager_id': 3536265}, {'manager_id': 3536269}]","
SELECT DISTINCT
  ""m"".""manager_id""
FROM ""manager"" AS ""m""
INNER JOIN ""department"" AS ""d""
  ON ""m"".""manager_id"" = ""d"".""manager_id""
WHERE
  ""d"".""budget"" > 100000;
```",,"[{'manager_id': 3536254}, {'manager_id': 3536254}, {'manager_id': 3536254}, {'manager_id': 3536269}, {'manager_id': 3536269}, {'manager_id': 3536269}, {'manager_id': 3536256}, {'manager_id': 3536256}, {'manager_id': 3536256}, {'manager_id': 3536254}, {'manager_id': 3536269}]",['SELECT e.manager_id FROM manager m JOIN employee e ON m.manager_id = e.manager_id JOIN department d ON m.manager_id = d.manager_id WHERE d.budget > 100000;'],88,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"List all managers id who have been assigned to departments with budgets exceeding $100,000.","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""budget = 100000""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT DISTINCT
""m"".""manager_id""
FROM ""manager"" AS ""m""
INNER JOIN ""department"" AS ""d""
ON ""m"".""manager_id"" = ""d"".""manager_id""
WHERE
""d"".""budget"" > 100000;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


What is the average tenure in days of employees in each department?","[{'avg_tenure_in_days': '-11917.000000000000', 'department_name': 'Marketing'}, {'avg_tenure_in_days': '-12592.571428571429', 'department_name': 'Human Resources'}, {'avg_tenure_in_days': '-12911.666666666667', 'department_name': 'Finance'}]","
SELECT
  d.department_name,
  AVG(
    EXTRACT(EPOCH FROM e.date_of_birth) - EXTRACT(EPOCH FROM e.hire_date)
  ) / 86400 AS avg_tenure_in_days
FROM employee AS e
JOIN department AS d
  ON e.department_id = d.department_id
WHERE
  e.hire_date IS NOT NULL
GROUP BY
  d.department_name
ORDER BY
  avg_tenure_in_days DESC;
```",,"[{'avg_tenure_days': '469.6666666666666667', 'department_id': 3}, {'avg_tenure_days': '490.2857142857142857', 'department_id': 1}, {'avg_tenure_days': '447.7142857142857143', 'department_id': 2}]","['SELECT department_id, AVG(EXTRACT(DAY FROM (NOW() - hire_date))) AS avg_tenure_days FROM employee GROUP BY department_id;']",13,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,What is the average tenure in days of employees in each department?,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
d.department_name,
AVG(
EXTRACT(EPOCH FROM e.date_of_birth) - EXTRACT(EPOCH FROM e.hire_date)
) / 86400 AS avg_tenure_in_days
FROM employee AS e
JOIN department AS d
ON e.department_id = d.department_id
WHERE
e.hire_date IS NOT NULL
GROUP BY
d.department_name
ORDER BY
avg_tenure_in_days DESC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'AGGREGATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find the employee who has completed the highest number of training sessions in the year 2023.",[],"
-- Find the employee who has completed the highest number of training sessions in the year 2023.
SELECT
    e.""first_name"" || ' ' || e.""last_name"" AS ""Employee Name"",
    COUNT(et.""employee_id"") AS ""Number of Training Sessions""
FROM
    ""employee"" AS e
JOIN
    ""employee_training"" AS et ON e.""employee_id"" = et.""employee_id""
JOIN
    ""training"" AS t ON et.""training_id"" = t.""training_id""
WHERE
    EXTRACT(YEAR FROM t.""date"") = 2023
GROUP BY
    e.""employee_id"", e.""first_name"", e.""last_name""
ORDER BY
    ""Number of Training Sessions"" DESC
LIMIT
    1;
```",,"[{'employee_id': 3536251, 'total_training_sessions': 1}]","[""SELECT employee_id, COUNT(training_id) AS total_training_sessions FROM employee_training WHERE start_date >= '2023-01-01' AND start_date <= '2023-12-31' GROUP BY employee_id ORDER BY total_training_sessions DESC LIMIT 1;""]",58,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Find the employee who has completed the highest number of training sessions in the year 2023.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
-- Find the employee who has completed the highest number of training sessions in the year 2023.
SELECT
e.""first_name"" || ' ' || e.""last_name"" AS ""Employee Name"",
COUNT(et.""employee_id"") AS ""Number of Training Sessions""
FROM
""employee"" AS e
JOIN
""employee_training"" AS et ON e.""employee_id"" = et.""employee_id""
JOIN
""training"" AS t ON et.""training_id"" = t.""training_id""
WHERE
EXTRACT(YEAR FROM t.""date"") = 2023
GROUP BY
e.""employee_id"", e.""first_name"", e.""last_name""
ORDER BY
""Number of Training Sessions"" DESC
LIMIT
1;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'DATE', 'LIMIT']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42703', 'M': 'column sa.company_id does not exist', 'H': 'Perhaps you meant to reference the column ""co.company_id"".', 'P': '364', 'F': 'parse_relation.c', 'L': '3738', 'R': 'errorMissingColumn'}
[SQL: 
SELECT
ROUND(((AVG(sa.""salary"" * (
sa.""end_date"" > '2023-04-01' AND sa.""end_date"" <= '2024-03-31'
)) - AVG(sa.""salary"" * (
sa.""end_date"" > '2022-04-01' AND sa.""end_date"" <= '2023-03-31'
))) / AVG(sa.""salary"" * (
sa.""end_date"" > '2022-04-01' AND sa.""end_date"" <= '2023-03-31'
))) * 100, 2) AS percentage_increase
FROM ""salary"" AS sa
INNER JOIN ""company"" AS co
ON sa.""company_id"" = co.""company_id""
INNER JOIN ""employee"" AS em
ON sa.""employee_id"" = em.""employee_id""
INNER JOIN ""department"" AS de
ON em.""department_id"" = de.""department_id""
WHERE
de.""department_name"" = 'Finance';
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Calculate the percentage increase in the average salary for employees in the ""Finance"" department from the financial year 2023-24 to the current financial year 2024-25.",[],"
SELECT
  ROUND(((AVG(sa.""salary"" * (
    sa.""end_date"" > '2023-04-01' AND sa.""end_date"" <= '2024-03-31'
  )) - AVG(sa.""salary"" * (
    sa.""end_date"" > '2022-04-01' AND sa.""end_date"" <= '2023-03-31'
  ))) / AVG(sa.""salary"" * (
    sa.""end_date"" > '2022-04-01' AND sa.""end_date"" <= '2023-03-31'
  ))) * 100, 2) AS percentage_increase
FROM ""salary"" AS sa
INNER JOIN ""company"" AS co
  ON sa.""company_id"" = co.""company_id""
INNER JOIN ""employee"" AS em
  ON sa.""employee_id"" = em.""employee_id""
INNER JOIN ""department"" AS de
  ON em.""department_id"" = de.""department_id""
WHERE
  de.""department_name"" = 'Finance';
```",,[{'percentage_increase': '8.77192982456140350900'}],"[""SELECT ((current_year_avg_salary - prev_year_avg_salary) / prev_year_avg_salary) * 100 AS percentage_increase FROM (SELECT AVG(salary) AS current_year_avg_salary FROM salary WHERE start_date >= '2024-01-01' AND start_date < '2025-01-01' AND employee_id IN (SELECT employee_id FROM employee WHERE department_id = (SELECT department_id FROM department WHERE department_name = 'Finance'))) AS current_year, (SELECT AVG(salary) AS prev_year_avg_salary FROM salary WHERE start_date >= '2023-01-01' AND start_date < '2024-01-01' AND employee_id IN (SELECT employee_id FROM employee WHERE department_id = (SELECT department_id FROM department WHERE department_name = 'Finance'))) AS prev_year;""]",71,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Calculate the percentage increase in the average salary for employees in the ""Finance"" department from the financial year 2023-24 to the current financial year 2024-25.","{'Comment': '""LGTM, Fixed the years.""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""department_name = \'Finance\'""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
ROUND(((AVG(sa.""salary"" * (
sa.""end_date"" > '2023-04-01' AND sa.""end_date"" <= '2024-03-31'
)) - AVG(sa.""salary"" * (
sa.""end_date"" > '2022-04-01' AND sa.""end_date"" <= '2023-03-31'
))) / AVG(sa.""salary"" * (
sa.""end_date"" > '2022-04-01' AND sa.""end_date"" <= '2023-03-31'
))) * 100, 2) AS percentage_increase
FROM ""salary"" AS sa
INNER JOIN ""company"" AS co
ON sa.""company_id"" = co.""company_id""
INNER JOIN ""employee"" AS em
ON sa.""employee_id"" = em.""employee_id""
INNER JOIN ""department"" AS de
ON em.""department_id"" = de.""department_id""
WHERE
de.""department_name"" = 'Finance';
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'AGGREGATE', 'time']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Determine the percentage of employees who have completed mandatory training sessions out of the total number of employees in the company.",[{'percentage_of_employees_completed_mandatory_training': 85}],"
SELECT
    100 * SUM(CASE WHEN t.attendance_required = TRUE THEN 1 ELSE 0 END) / COUNT(e.employee_id) AS percentage_of_employees_completed_mandatory_training
FROM employee_training AS et
JOIN training AS t ON et.training_id = t.training_id
LEFT JOIN employee AS e ON et.employee_id = e.employee_id;
```",,[{'completion_percentage': 85}],['SELECT (COUNT(DISTINCT employee_id) * 100 / (SELECT COUNT(*) FROM public.employee)) AS completion_percentage FROM public.employee_training WHERE training_id IN (SELECT training_id FROM public.training WHERE attendance_required = true);'],64,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Determine the percentage of employees who have completed mandatory training sessions out of the total number of employees in the company.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
100 * SUM(CASE WHEN t.attendance_required = TRUE THEN 1 ELSE 0 END) / COUNT(e.employee_id) AS percentage_of_employees_completed_mandatory_training
FROM employee_training AS et
JOIN training AS t ON et.training_id = t.training_id
LEFT JOIN employee AS e ON et.employee_id = e.employee_id;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'COUNT', 'NESTED QUERY']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


What are the top 5 employees that had the most benefits last year?",[],"
/* Select the employee's first and last names, the number of benefits they have, and their department name. */
SELECT
    e.""first_name"",
    e.""last_name"",
    COUNT(eb.""benefit_id"") AS ""number_of_benefits"",
    d.""department_name""
/* Join the ""employee"" table with the ""employee_x_benefit"" and ""department"" tables. */
FROM
    ""employee"" AS e
JOIN
    ""employee_x_benefit"" AS eb ON e.""employee_id"" = eb.""employee_id""
JOIN
    ""department"" AS d ON e.""department_id"" = d.""department_id""
/* Filter the benefits to only include those that were active last year. */
WHERE
    eb.""start_date"" <= NOW() - INTERVAL '1 year' AND (eb.""end_date"" IS NULL OR eb.""end_date"" >= NOW() - INTERVAL '1 year')
/* Group the results by employee and department. */
GROUP BY
    e.""employee_id"",
    e.""first_name"",
    e.""last_name"",
    d.""department_name""
/* Order the results by the number of benefits in descending order. */
ORDER BY
    ""number_of_benefits"" DESC
/* Limit the results to the top 5 employees. */
LIMIT 5;
```",,[],"['SELECT e.employee_id, COUNT(*) AS total_benefits FROM employee e JOIN employee_x_benefit xb ON e.employee_id = xb.employee_id WHERE  EXTRACT(YEAR FROM xb.start_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 2 GROUP BY e.employee_id, e.first_name, e.last_name ORDER BY total_benefits DESC LIMIT 5;']",5,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,What are the top 5 employees that had the most benefits last year?,"{'Comment': '""LGTM. LIMIT 5 may not be strictly correct if two employees have the same number.""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
/* Select the employee's first and last names, the number of benefits they have, and their department name. */
SELECT
e.""first_name"",
e.""last_name"",
COUNT(eb.""benefit_id"") AS ""number_of_benefits"",
d.""department_name""
/* Join the ""employee"" table with the ""employee_x_benefit"" and ""department"" tables. */
FROM
""employee"" AS e
JOIN
""employee_x_benefit"" AS eb ON e.""employee_id"" = eb.""employee_id""
JOIN
""department"" AS d ON e.""department_id"" = d.""department_id""
/* Filter the benefits to only include those that were active last year. */
WHERE
eb.""start_date"" <= NOW() - INTERVAL '1 year' AND (eb.""end_date"" IS NULL OR eb.""end_date"" >= NOW() - INTERVAL '1 year')
/* Group the results by employee and department. */
GROUP BY
e.""employee_id"",
e.""first_name"",
e.""last_name"",
d.""department_name""
/* Order the results by the number of benefits in descending order. */
ORDER BY
""number_of_benefits"" DESC
/* Limit the results to the top 5 employees. */
LIMIT 5;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'DATE', 'JOIN', 'AGGREGATE', 'SORT', 'LIMIT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Which employee has the oldest assigned laptop?","[{'first_name': 'Alice', 'last_name': 'Smith', 'purchase_date': '2019-10-20'}]","
SELECT
  e.first_name,
  e.last_name,
  ec.purchase_date
FROM employee AS e
INNER JOIN employee_computer AS ec
  ON e.employee_id = ec.employee_id
ORDER BY
  ec.purchase_date
LIMIT 1;
```",,[{'employee_id': 3536252}],['SELECT e.employee_id FROM employee_computer ec JOIN employee e ON ec.employee_id = e.employee_id WHERE ec.purchase_date = ( SELECT MIN(purchase_date) FROM employee_computer );'],9,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Which employee has the oldest assigned laptop?,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
e.first_name,
e.last_name,
ec.purchase_date
FROM employee AS e
INNER JOIN employee_computer AS ec
ON e.employee_id = ec.employee_id
ORDER BY
ec.purchase_date
LIMIT 1;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'MIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the list of computers assigned to employees along with their warranty expiry dates.","[{'computer_name': 'Laptop 1', 'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe', 'warranty_expiry_date': '2023-05-10'}, {'computer_name': 'Desktop 1', 'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith', 'warranty_expiry_date': '2022-10-20'}, {'computer_name': 'Laptop 2', 'employee_id': 3536253, 'first_name': 'Michael', 'last_name': 'Johnson', 'warranty_expiry_date': '2024-03-15'}, {'computer_name': 'Desktop 2', 'employee_id': 3536254, 'first_name': 'Emily', 'last_name': 'Williams', 'warranty_expiry_date': '2025-07-30'}, {'computer_name': 'Laptop 3', 'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown', 'warranty_expiry_date': '2023-11-25'}, {'computer_name': 'Desktop 3', 'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones', 'warranty_expiry_date': '2022-12-10'}, {'computer_name': 'Laptop 4', 'employee_id': 3536257, 'first_name': 'Christopher', 'last_name': 'Davis', 'warranty_expiry_date': '2024-09-05'}, {'computer_name': 'Desktop 4', 'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez', 'warranty_expiry_date': '2025-04-18'}, {'computer_name': 'Laptop 5', 'employee_id': 3536259, 'first_name': 'Daniel', 'last_name': 'Garcia', 'warranty_expiry_date': '2026-01-20'}, {'computer_name': 'Desktop 5', 'employee_id': 3536260, 'first_name': 'Taylor', 'last_name': 'Rodriguez', 'warranty_expiry_date': '2023-08-15'}, {'computer_name': 'Laptop 6', 'employee_id': 3536261, 'first_name': 'David', 'last_name': 'Lopez', 'warranty_expiry_date': '2025-05-10'}, {'computer_name': 'Desktop 6', 'employee_id': 3536262, 'first_name': 'Megan', 'last_name': 'Hernandez', 'warranty_expiry_date': '2024-07-20'}, {'computer_name': 'Laptop 7', 'employee_id': 3536263, 'first_name': 'Andrew', 'last_name': 'Gonzalez', 'warranty_expiry_date': '2023-11-30'}, {'computer_name': 'Desktop 7', 'employee_id': 3536264, 'first_name': 'Sophia', 'last_name': 'Perez', 'warranty_expiry_date': '2022-10-25'}, {'computer_name': 'Laptop 8', 'employee_id': 3536265, 'first_name': 'Aiden', 'last_name': 'Torres', 'warranty_expiry_date': '2024-06-15'}, {'computer_name': 'Desktop 8', 'employee_id': 3536266, 'first_name': 'Olivia', 'last_name': 'Rivera', 'warranty_expiry_date': '2026-02-28'}, {'computer_name': 'Laptop 9', 'employee_id': 3536267, 'first_name': 'Liam', 'last_name': 'Gomez', 'warranty_expiry_date': '2025-09-20'}, {'computer_name': 'Desktop 9', 'employee_id': 3536268, 'first_name': 'Emma', 'last_name': 'Reyes', 'warranty_expiry_date': '2023-05-12'}, {'computer_name': 'Laptop 10', 'employee_id': 3536269, 'first_name': 'Noah', 'last_name': 'King', 'warranty_expiry_date': '2024-04-18'}, {'computer_name': 'Desktop 10', 'employee_id': 3536270, 'first_name': 'Charlotte', 'last_name': 'Cooper', 'warranty_expiry_date': '2026-03-05'}]","
SELECT
  e.""employee_id"",
  e.""first_name"",
  e.""last_name"",
  ec.""computer_name"",
  ec.""warranty_expiry_date""
FROM ""employee"" AS e
JOIN ""employee_computer"" AS ec
  ON e.""employee_id"" = ec.""employee_id"";
```",,"[{'computer_name': 'Laptop 1', 'first_name': 'John', 'last_name': 'Doe', 'model': 'Dell XPS 15', 'serial_number': 'SN123456', 'warranty_expiry_date': '2023-05-10'}, {'computer_name': 'Desktop 1', 'first_name': 'Alice', 'last_name': 'Smith', 'model': 'HP Pavilion', 'serial_number': 'SN789012', 'warranty_expiry_date': '2022-10-20'}, {'computer_name': 'Laptop 2', 'first_name': 'Michael', 'last_name': 'Johnson', 'model': 'MacBook Pro', 'serial_number': 'SN234567', 'warranty_expiry_date': '2024-03-15'}, {'computer_name': 'Desktop 2', 'first_name': 'Emily', 'last_name': 'Williams', 'model': 'Lenovo ThinkCentre', 'serial_number': 'SN890123', 'warranty_expiry_date': '2025-07-30'}, {'computer_name': 'Laptop 3', 'first_name': 'Matthew', 'last_name': 'Brown', 'model': 'Asus ZenBook', 'serial_number': 'SN345678', 'warranty_expiry_date': '2023-11-25'}, {'computer_name': 'Desktop 3', 'first_name': 'Sarah', 'last_name': 'Jones', 'model': 'Acer Aspire', 'serial_number': 'SN901234', 'warranty_expiry_date': '2022-12-10'}, {'computer_name': 'Laptop 4', 'first_name': 'Christopher', 'last_name': 'Davis', 'model': 'Microsoft Surface', 'serial_number': 'SN456789', 'warranty_expiry_date': '2024-09-05'}, {'computer_name': 'Desktop 4', 'first_name': 'Jessica', 'last_name': 'Martinez', 'model': 'Dell OptiPlex', 'serial_number': 'SN012345', 'warranty_expiry_date': '2025-04-18'}, {'computer_name': 'Laptop 5', 'first_name': 'Daniel', 'last_name': 'Garcia', 'model': 'HP Spectre', 'serial_number': 'SN567890', 'warranty_expiry_date': '2026-01-20'}, {'computer_name': 'Desktop 5', 'first_name': 'Taylor', 'last_name': 'Rodriguez', 'model': 'Asus ROG Strix', 'serial_number': 'SN123456', 'warranty_expiry_date': '2023-08-15'}, {'computer_name': 'Laptop 6', 'first_name': 'David', 'last_name': 'Lopez', 'model': 'Lenovo Yoga', 'serial_number': 'SN234567', 'warranty_expiry_date': '2025-05-10'}, {'computer_name': 'Desktop 6', 'first_name': 'Megan', 'last_name': 'Hernandez', 'model': 'Microsoft Surface Studio', 'serial_number': 'SN345678', 'warranty_expiry_date': '2024-07-20'}, {'computer_name': 'Laptop 7', 'first_name': 'Andrew', 'last_name': 'Gonzalez', 'model': 'Dell Inspiron', 'serial_number': 'SN456789', 'warranty_expiry_date': '2023-11-30'}, {'computer_name': 'Desktop 7', 'first_name': 'Sophia', 'last_name': 'Perez', 'model': 'Apple iMac', 'serial_number': 'SN567890', 'warranty_expiry_date': '2022-10-25'}, {'computer_name': 'Laptop 8', 'first_name': 'Aiden', 'last_name': 'Torres', 'model': 'HP Envy', 'serial_number': 'SN678901', 'warranty_expiry_date': '2024-06-15'}, {'computer_name': 'Desktop 8', 'first_name': 'Olivia', 'last_name': 'Rivera', 'model': 'Acer Predator', 'serial_number': 'SN789012', 'warranty_expiry_date': '2026-02-28'}, {'computer_name': 'Laptop 9', 'first_name': 'Liam', 'last_name': 'Gomez', 'model': 'Microsoft Surface Book', 'serial_number': 'SN890123', 'warranty_expiry_date': '2025-09-20'}, {'computer_name': 'Desktop 9', 'first_name': 'Emma', 'last_name': 'Reyes', 'model': 'Lenovo Legion', 'serial_number': 'SN901234', 'warranty_expiry_date': '2023-05-12'}, {'computer_name': 'Laptop 10', 'first_name': 'Noah', 'last_name': 'King', 'model': 'Asus VivoBook', 'serial_number': 'SN012345', 'warranty_expiry_date': '2024-04-18'}, {'computer_name': 'Desktop 10', 'first_name': 'Charlotte', 'last_name': 'Cooper', 'model': 'Dell Precision', 'serial_number': 'SN123456', 'warranty_expiry_date': '2026-03-05'}]","['SELECT e.first_name, e.last_name, ec.computer_name, ec.serial_number, ec.model, ec.warranty_expiry_date FROM employee e JOIN employee_computer ec ON e.employee_id = ec.employee_id;']",101,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve the list of computers assigned to employees along with their warranty expiry dates.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
e.""employee_id"",
e.""first_name"",
e.""last_name"",
ec.""computer_name"",
ec.""warranty_expiry_date""
FROM ""employee"" AS e
JOIN ""employee_computer"" AS ec
ON e.""employee_id"" = ec.""employee_id"";
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Identify the employee id with the highest salary",[{'employee_id': 3536265}],"
SELECT ""employee_id""
FROM ""salary""
ORDER BY ""salary"" DESC
LIMIT 1;
```",,"[{'employee_id': 3536265, 'salary': '90000.00'}]","['SELECT employee_id, salary FROM salary ORDER BY salary DESC LIMIT 1;']",91,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Identify the employee id with the highest salary,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT ""employee_id""
FROM ""salary""
ORDER BY ""salary"" DESC
LIMIT 1;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'DATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List all employees who have participated in at least one training session conducted by an external trainer in the year 2023, along with the total number of sessions they attended.",[],"
SELECT
    e.""first_name"" AS ""Employee First Name"",
    e.""last_name"" AS ""Employee Last Name"",
    COUNT(t.""training_id"") AS ""Total Training Sessions""
FROM
    ""employee"" AS e
JOIN
    ""employee_training"" AS et ON e.""employee_id"" = et.""employee_id""
JOIN
    ""training"" AS t ON et.""training_id"" = t.""training_id""
WHERE
    t.""trainer"" <> e.""first_name""
    AND t.""trainer"" <> e.""last_name""
    AND t.""date"" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY
    e.""employee_id"", e.""first_name"", e.""last_name""
ORDER BY
    ""Total Training Sessions"" DESC;
```",,"[{'employee_id': 3536253, 'total_training_sessions': 1}]","[""SELECT e.employee_id, COUNT(et.training_id) AS total_training_sessions FROM employee e JOIN employee_training et ON e.employee_id = et.employee_id JOIN training t ON et.training_id = t.training_id WHERE EXTRACT(YEAR FROM et.start_date) = 2023 AND t.trainer LIKE '%David%' GROUP BY e.employee_id HAVING COUNT(et.training_id) >= 1;""]",47,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"List all employees who have participated in at least one training session conducted by an external trainer in the year 2023, along with the total number of sessions they attended.","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""External trainer = \\""David\\""""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
e.""first_name"" AS ""Employee First Name"",
e.""last_name"" AS ""Employee Last Name"",
COUNT(t.""training_id"") AS ""Total Training Sessions""
FROM
""employee"" AS e
JOIN
""employee_training"" AS et ON e.""employee_id"" = et.""employee_id""
JOIN
""training"" AS t ON et.""training_id"" = t.""training_id""
WHERE
t.""trainer"" <> e.""first_name""
AND t.""trainer"" <> e.""last_name""
AND t.""date"" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY
e.""employee_id"", e.""first_name"", e.""last_name""
ORDER BY
""Total Training Sessions"" DESC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'AGGREGATE', 'DATE', 'HAVING']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Determine the total amount spent on salaries for each pay frequency (e.g., monthly, bi-weekly).","[{'pay_frequency': 'Bi-weekly', 'total_salary': '593300.00'}, {'pay_frequency': 'Monthly', 'total_salary': '654300.00'}]","
SELECT
  ""pay_frequency"",
  SUM(""salary"" + ""bonus"" - ""deductions"" - ""taxes"") AS ""total_salary""
FROM ""salary""
GROUP BY
  ""pay_frequency""
ORDER BY
  ""pay_frequency"" NULLS LAST;
```",,"[{'pay_frequency': 'Monthly', 'total_salary_expense': '745000.00'}, {'pay_frequency': 'Bi-weekly', 'total_salary_expense': '675000.00'}]","['SELECT pay_frequency, SUM(salary) AS total_salary_expense FROM salary GROUP BY pay_frequency;']",90,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Determine the total amount spent on salaries for each pay frequency (e.g., monthly, bi-weekly).","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
""pay_frequency"",
SUM(""salary"" + ""bonus"" - ""deductions"" - ""taxes"") AS ""total_salary""
FROM ""salary""
GROUP BY
""pay_frequency""
ORDER BY
""pay_frequency"" NULLS LAST;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'Data Linking']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Identify employee id and their ratings who have received performance ratings above 3 in their last review.","[{'employee_id': 3536251, 'performance_rating': '4.50'}, {'employee_id': 3536252, 'performance_rating': '4.20'}, {'employee_id': 3536253, 'performance_rating': '3.80'}, {'employee_id': 3536254, 'performance_rating': '4.00'}, {'employee_id': 3536255, 'performance_rating': '4.60'}, {'employee_id': 3536256, 'performance_rating': '4.30'}, {'employee_id': 3536257, 'performance_rating': '3.90'}, {'employee_id': 3536258, 'performance_rating': '4.10'}, {'employee_id': 3536259, 'performance_rating': '4.40'}, {'employee_id': 3536260, 'performance_rating': '4.50'}, {'employee_id': 3536261, 'performance_rating': '4.20'}, {'employee_id': 3536262, 'performance_rating': '4.30'}, {'employee_id': 3536263, 'performance_rating': '3.80'}, {'employee_id': 3536264, 'performance_rating': '4.00'}, {'employee_id': 3536265, 'performance_rating': '4.60'}, {'employee_id': 3536266, 'performance_rating': '4.40'}, {'employee_id': 3536267, 'performance_rating': '3.90'}, {'employee_id': 3536268, 'performance_rating': '4.10'}, {'employee_id': 3536269, 'performance_rating': '4.30'}, {'employee_id': 3536270, 'performance_rating': '4.50'}]","
SELECT e.""employee_id"", pr.""performance_rating""
FROM ""employee"" AS e
JOIN ""performance_review"" AS pr
ON e.""employee_id"" = pr.""employee_id""
WHERE pr.""review_date"" = (
    SELECT MAX(""review_date"")
    FROM ""performance_review"" AS pr2
    WHERE pr2.""employee_id"" = e.""employee_id""
)
AND pr.""performance_rating"" > 3;
```",,"[{'employee_id': 3536251, 'performance_rating': '4.50'}, {'employee_id': 3536252, 'performance_rating': '4.20'}, {'employee_id': 3536253, 'performance_rating': '3.80'}, {'employee_id': 3536254, 'performance_rating': '4.00'}, {'employee_id': 3536255, 'performance_rating': '4.60'}, {'employee_id': 3536256, 'performance_rating': '4.30'}, {'employee_id': 3536257, 'performance_rating': '3.90'}, {'employee_id': 3536258, 'performance_rating': '4.10'}, {'employee_id': 3536259, 'performance_rating': '4.40'}, {'employee_id': 3536260, 'performance_rating': '4.50'}, {'employee_id': 3536261, 'performance_rating': '4.20'}, {'employee_id': 3536262, 'performance_rating': '4.30'}, {'employee_id': 3536263, 'performance_rating': '3.80'}, {'employee_id': 3536264, 'performance_rating': '4.00'}, {'employee_id': 3536265, 'performance_rating': '4.60'}, {'employee_id': 3536266, 'performance_rating': '4.40'}, {'employee_id': 3536267, 'performance_rating': '3.90'}, {'employee_id': 3536268, 'performance_rating': '4.10'}, {'employee_id': 3536269, 'performance_rating': '4.30'}, {'employee_id': 3536270, 'performance_rating': '4.50'}]","['SELECT e.employee_id, pr.performance_rating FROM employee e JOIN performance_review pr ON e.employee_id = pr.employee_id WHERE pr.performance_rating > 3;']",89,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Identify employee id and their ratings who have received performance ratings above 3 in their last review.,"{'Comment': '""LGTM ""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""performance_rating > 3""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT e.""employee_id"", pr.""performance_rating""
FROM ""employee"" AS e
JOIN ""performance_review"" AS pr
ON e.""employee_id"" = pr.""employee_id""
WHERE pr.""review_date"" = (
SELECT MAX(""review_date"")
FROM ""performance_review"" AS pr2
WHERE pr2.""employee_id"" = e.""employee_id""
)
AND pr.""performance_rating"" > 3;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List all payments made in in Aug 2024 and six months back, including invoice details (such as invoice number, date and total amount).","[{'invoice_amount': '1200.00', 'invoice_date': '2024-02-01', 'invoice_id': 14, 'payment_amount': '1200.00', 'payment_date': '2024-02-10'}, {'invoice_amount': '1100.00', 'invoice_date': '2024-08-01', 'invoice_id': 20, 'payment_amount': '1100.00', 'payment_date': '2024-08-10'}]","
WITH PaymentData AS (
    SELECT
        P.payment_date,
        P.amount AS payment_amount,
        I.invoice_id,
        I.invoice_date,
        I.total_amount AS invoice_amount
    FROM Payment AS P
    INNER JOIN Invoice AS I
        ON P.invoice_id = I.invoice_id
    WHERE
        P.payment_date BETWEEN '2024-08-01' AND '2024-08-31'
        OR P.payment_date BETWEEN '2024-02-01' AND '2024-02-29'
)
SELECT
    PD.payment_date,
    PD.payment_amount,
    PD.invoice_id,
    PD.invoice_date,
    PD.invoice_amount
FROM PaymentData AS PD;
```",,"[{'amount': '1200.00', 'invoice_date': '2024-02-01', 'invoice_id': 14, 'payment_id': 14, 'total_amount': '1200.00'}, {'amount': '1800.00', 'invoice_date': '2024-03-01', 'invoice_id': 15, 'payment_id': 15, 'total_amount': '1800.00'}, {'amount': '900.00', 'invoice_date': '2024-04-01', 'invoice_id': 16, 'payment_id': 16, 'total_amount': '900.00'}, {'amount': '2000.00', 'invoice_date': '2024-05-01', 'invoice_id': 17, 'payment_id': 17, 'total_amount': '2000.00'}, {'amount': '1600.00', 'invoice_date': '2024-06-01', 'invoice_id': 18, 'payment_id': 18, 'total_amount': '1600.00'}, {'amount': '1400.00', 'invoice_date': '2024-07-01', 'invoice_id': 19, 'payment_id': 19, 'total_amount': '1400.00'}, {'amount': '1100.00', 'invoice_date': '2024-08-01', 'invoice_id': 20, 'payment_id': 20, 'total_amount': '1100.00'}]","[""SELECT p.payment_id, p.amount, i.invoice_id, i.invoice_date, i.total_amount FROM payment p JOIN invoice i ON p.invoice_id = i.invoice_id WHERE p.payment_date >= DATE('2024-08-01') - INTERVAL '6 month';""]",24,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"List all payments made in in Aug 2024 and six months back, including invoice details (such as invoice number, date and total amount).","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH PaymentData AS (
SELECT
P.payment_date,
P.amount AS payment_amount,
I.invoice_id,
I.invoice_date,
I.total_amount AS invoice_amount
FROM Payment AS P
INNER JOIN Invoice AS I
ON P.invoice_id = I.invoice_id
WHERE
P.payment_date BETWEEN '2024-08-01' AND '2024-08-31'
OR P.payment_date BETWEEN '2024-02-01' AND '2024-02-29'
)
SELECT
PD.payment_date,
PD.payment_amount,
PD.invoice_id,
PD.invoice_date,
PD.invoice_amount
FROM PaymentData AS PD;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'DATE', 'time']",
[],db_hr,['postgres'],[],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the average number of vacation days requested by employees in each department:",[],"
SELECT
  d.""department_name"",
  AVG(lr.""duration"") AS ""average_vacation_days""
FROM ""leave_request"" AS lr
JOIN ""employee"" AS e
  ON lr.""employee_id"" = e.""employee_id""
JOIN ""department"" AS d
  ON e.""department_id"" = d.""department_id""
WHERE
  lr.""leave_type"" = 'vacation'
GROUP BY
  d.""department_name""
ORDER BY
  d.""department_name"" ASC;
```",,[],[],134,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve the average number of vacation days requested by employees in each department:,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
d.""department_name"",
AVG(lr.""duration"") AS ""average_vacation_days""
FROM ""leave_request"" AS lr
JOIN ""employee"" AS e
ON lr.""employee_id"" = e.""employee_id""
JOIN ""department"" AS d
ON e.""department_id"" = d.""department_id""
WHERE
lr.""leave_type"" = 'vacation'
GROUP BY
d.""department_name""
ORDER BY
d.""department_name"" ASC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


How many employees have received a performance review this year?",[{'count': 0}],"
SELECT COUNT(DISTINCT t1.employee_id)
FROM performance_review AS t1
INNER JOIN employee AS t2
ON t1.employee_id = t2.employee_id
WHERE EXTRACT(YEAR FROM t1.review_date) = EXTRACT(YEAR FROM CURRENT_DATE)
```",,[{'total_employees_reviewed': 0}],['SELECT COUNT(DISTINCT pr.employee_id) AS total_employees_reviewed FROM performance_review pr JOIN employee e ON pr.employee_id = e.employee_id WHERE EXTRACT(YEAR FROM pr.review_date) = EXTRACT(YEAR FROM CURRENT_DATE);'],7,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,How many employees have received a performance review this year?,"{'Comment': '""LGTM. Current date is not ideal since an empty result set is the likely outcome. But useful to have some testcases for that""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT COUNT(DISTINCT t1.employee_id)
FROM performance_review AS t1
INNER JOIN employee AS t2
ON t1.employee_id = t2.employee_id
WHERE EXTRACT(YEAR FROM t1.review_date) = EXTRACT(YEAR FROM CURRENT_DATE)
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'JOIN', 'AGGREGATE', 'DATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Identify the top three employees who have received the highest total allowances in the current year, considering both fixed and variable allowances.",[],"
SELECT e.employee_id, e.first_name, e.last_name, SUM(ea.amount) AS total_allowances
FROM employee e
JOIN employee_allowances ea ON e.employee_id = ea.employee_id
WHERE ea.date_created BETWEEN DATE_TRUNC('year', CURRENT_DATE) AND CURRENT_DATE
GROUP BY e.employee_id, e.first_name, e.last_name
ORDER BY total_allowances DESC
LIMIT 3;
```",,[],"['SELECT e.employee_id, e.first_name, SUM(ea.amount) AS total_allowances FROM employee e JOIN employee_allowances ea ON e.employee_id = ea.employee_id WHERE EXTRACT(YEAR FROM ea.effective_date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 GROUP BY e.employee_id, e.first_name ORDER BY total_allowances DESC LIMIT 3;']",61,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Identify the top three employees who have received the highest total allowances in the current year, considering both fixed and variable allowances.","{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT e.employee_id, e.first_name, e.last_name, SUM(ea.amount) AS total_allowances
FROM employee e
JOIN employee_allowances ea ON e.employee_id = ea.employee_id
WHERE ea.date_created BETWEEN DATE_TRUNC('year', CURRENT_DATE) AND CURRENT_DATE
GROUP BY e.employee_id, e.first_name, e.last_name
ORDER BY total_allowances DESC
LIMIT 3;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'DATE', 'SORT', 'LIMIT', 'JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the total number of employees managed by each manager.","[{'Number of Employees Managed': 9, 'manager_id': 3536251}, {'Number of Employees Managed': 4, 'manager_id': 3536254}, {'Number of Employees Managed': 3, 'manager_id': 3536256}, {'Number of Employees Managed': 4, 'manager_id': 3536269}]","
SELECT
    m.""manager_id"",
    COUNT(e.""employee_id"") AS ""Number of Employees Managed""
FROM
    ""manager"" AS m
JOIN
    ""employee"" AS e ON m.""manager_id"" = e.""manager_id""
GROUP BY
    m.""manager_id""
ORDER BY
    m.""manager_id"" NULLS LAST;
```",,"[{'manager_id': 3536254, 'total_employees_managed': 4}, {'manager_id': 3536256, 'total_employees_managed': 3}, {'manager_id': 3536251, 'total_employees_managed': 9}, {'manager_id': 3536269, 'total_employees_managed': 4}]","['SELECT m.manager_id, COUNT(*) AS total_employees_managed FROM manager m JOIN employee e ON m.manager_id = e.manager_id GROUP BY m.manager_id;']",87,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve the total number of employees managed by each manager.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
m.""manager_id"",
COUNT(e.""employee_id"") AS ""Number of Employees Managed""
FROM
""manager"" AS m
JOIN
""employee"" AS e ON m.""manager_id"" = e.""manager_id""
GROUP BY
m.""manager_id""
ORDER BY
m.""manager_id"" NULLS LAST;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'JOIN']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42703', 'M': 'column a.department_id does not exist', 'H': 'Perhaps you meant to reference the column ""d.department_id"".', 'P': '168', 'F': 'parse_relation.c', 'L': '3738', 'R': 'errorMissingColumn'}
[SQL: 
WITH DepartmentAvgHours AS (
SELECT
d.department_id,
d.department_name,
AVG(a.work_hours) AS avg_hours
FROM department AS d
JOIN attendance AS a
ON d.department_id = a.department_id
WHERE
a.date BETWEEN '2023-01-01' AND '2023-06-30'
GROUP BY
d.department_id,
d.department_name
)
SELECT
department_name
FROM DepartmentAvgHours
ORDER BY
avg_hours DESC,
department_name
LIMIT 1;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find the department with the highest average number of hours worked per employee in the first two quarters of 2023. In the event of a tie, prioritize the option that comes first in lexicographical order.",[],"
WITH DepartmentAvgHours AS (
  SELECT
    d.department_id,
    d.department_name,
    AVG(a.work_hours) AS avg_hours
  FROM department AS d
  JOIN attendance AS a
    ON d.department_id = a.department_id
  WHERE
    a.date BETWEEN '2023-01-01' AND '2023-06-30'
  GROUP BY
    d.department_id,
    d.department_name
)
SELECT
  department_name
FROM DepartmentAvgHours
ORDER BY
  avg_hours DESC,
  department_name
LIMIT 1;
```",,"[{'avg_hours_worked_per_employee': '8.0833333333333333', 'min': 'Finance'}]","[""SELECT MIN(d.department_name), AVG(t.working_hours) AS avg_hours_worked_per_employee FROM department d JOIN employee e ON d.department_id = e.department_id JOIN timesheet_employee te ON e.employee_id = te.employee_id JOIN timesheet t ON te.timesheet_id = t.timesheet_id WHERE t.date >= '2023-01-01' AND t.date <= '2023-06-30'  GROUP BY d.department_id ORDER BY avg_hours_worked_per_employee DESC LIMIT 1;""]",50,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Find the department with the highest average number of hours worked per employee in the first two quarters of 2023. In the event of a tie, prioritize the option that comes first in lexicographical order.","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH DepartmentAvgHours AS (
SELECT
d.department_id,
d.department_name,
AVG(a.work_hours) AS avg_hours
FROM department AS d
JOIN attendance AS a
ON d.department_id = a.department_id
WHERE
a.date BETWEEN '2023-01-01' AND '2023-06-30'
GROUP BY
d.department_id,
d.department_name
)
SELECT
department_name
FROM DepartmentAvgHours
ORDER BY
avg_hours DESC,
department_name
LIMIT 1;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'JOIN', 'AGGREGATE', 'DATE', 'SORT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find the employee with the most number of certifications.","[{'first_name': 'Alice', 'last_name': 'Smith', 'number_of_certifications': 2}]","
SELECT e.""first_name"", e.""last_name"", COUNT(*) AS ""number_of_certifications""
FROM ""employee"" AS e
JOIN ""employee_certification"" AS ec ON e.""employee_id"" = ec.""employee_id""
GROUP BY e.""employee_id"", e.""first_name"", e.""last_name""
ORDER BY ""number_of_certifications"" DESC
LIMIT 1;
```",,"[{'employee_id': 3536252, 'total_certifications': 2}]","['SELECT employee_id, COUNT(certification_id) AS total_certifications FROM employee_certification GROUP BY employee_id ORDER BY COUNT(certification_id) DESC LIMIT 1;']",135,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Find the employee with the most number of certifications.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT e.""first_name"", e.""last_name"", COUNT(*) AS ""number_of_certifications""
FROM ""employee"" AS e
JOIN ""employee_certification"" AS ec ON e.""employee_id"" = ec.""employee_id""
GROUP BY e.""employee_id"", e.""first_name"", e.""last_name""
ORDER BY ""number_of_certifications"" DESC
LIMIT 1;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'AGGREGATE', 'LIMIT']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42703', 'M': 'column et.training_date does not exist', 'P': '52', 'F': 'parse_relation.c', 'L': '3727', 'R': 'errorMissingColumn'}
[SQL: 
SELECT
ROUND(
(
COUNT(CASE WHEN EXTRACT(YEAR FROM ""et"".""training_date"") = 2023 THEN 1 END) * 100.0
) / COUNT(DISTINCT ""e"".""employee_id""),
2
) AS ""percentage_of_employees_trained""
FROM ""employee"" AS ""e""
LEFT JOIN ""employee_training"" AS ""et""
ON ""e"".""employee_id"" = ""et"".""employee_id"";
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Calculate the percentage of employees who have completed any training in the year 2023.",[],"
SELECT
  ROUND(
    (
      COUNT(CASE WHEN EXTRACT(YEAR FROM ""et"".""training_date"") = 2023 THEN 1 END) * 100.0
    ) / COUNT(DISTINCT ""e"".""employee_id""),
    2
  ) AS ""percentage_of_employees_trained""
FROM ""employee"" AS ""e""
LEFT JOIN ""employee_training"" AS ""et""
  ON ""e"".""employee_id"" = ""et"".""employee_id"";
```",,[{'completion_percentage': 60}],"[""SELECT (COUNT(DISTINCT e.employee_id) * 100 / (SELECT COUNT(*) FROM public.employee)) AS completion_percentage FROM public.employee e JOIN public.employee_training et ON e.employee_id = et.employee_id JOIN public.training t ON et.training_id = t.training_id WHERE et.start_date >= '2023-01-01' AND et.start_date <= '2023-12-31';""]",52,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Calculate the percentage of employees who have completed any training in the year 2023.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
ROUND(
(
COUNT(CASE WHEN EXTRACT(YEAR FROM ""et"".""training_date"") = 2023 THEN 1 END) * 100.0
) / COUNT(DISTINCT ""e"".""employee_id""),
2
) AS ""percentage_of_employees_trained""
FROM ""employee"" AS ""e""
LEFT JOIN ""employee_training"" AS ""et""
ON ""e"".""employee_id"" = ""et"".""employee_id"";
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'JOIN', 'DATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Identify the department with the highest turnover rate based on the number of employee terminations compared to the total number of employees in the department.",[{'department_name': 'Marketing'}],"
WITH DepartmentTurnover AS (
  SELECT
    d.department_name,
    COUNT(et.employee_id) AS terminations,
    COUNT(DISTINCT e.employee_id) AS total_employees
  FROM department AS d
  JOIN employee AS e
    ON d.department_id = e.department_id
  LEFT JOIN employee_termination AS et
    ON e.employee_id = et.employee_id
  GROUP BY
    d.department_name
), DepartmentTurnoverPercentages AS (
  SELECT
    department_name,
    terminations,
    total_employees,
    CAST(terminations AS REAL) / CAST(total_employees AS REAL) * 100 AS turnover_percentage
  FROM DepartmentTurnover
)
SELECT
  department_name
FROM DepartmentTurnoverPercentages
ORDER BY
  turnover_percentage DESC
LIMIT 1;
```",,"[{'min': 'Finance', 'turnover_rate': 0}]","['SELECT MIN(d.department_name), COUNT(et.employee_id) / COUNT(e.employee_id) AS turnover_rate FROM department d JOIN employee e ON d.department_id = e.department_id LEFT JOIN employee_termination et ON e.employee_id = et.employee_id GROUP BY d.department_id ORDER BY turnover_rate DESC LIMIT 1;']",57,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Identify the department with the highest turnover rate based on the number of employee terminations compared to the total number of employees in the department.,"{'Comment': '""LGTM, little Ambiguous NL prompt.""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH DepartmentTurnover AS (
SELECT
d.department_name,
COUNT(et.employee_id) AS terminations,
COUNT(DISTINCT e.employee_id) AS total_employees
FROM department AS d
JOIN employee AS e
ON d.department_id = e.department_id
LEFT JOIN employee_termination AS et
ON e.employee_id = et.employee_id
GROUP BY
d.department_name
), DepartmentTurnoverPercentages AS (
SELECT
department_name,
terminations,
total_employees,
CAST(terminations AS REAL) / CAST(total_employees AS REAL) * 100 AS turnover_percentage
FROM DepartmentTurnover
)
SELECT
department_name
FROM DepartmentTurnoverPercentages
ORDER BY
turnover_percentage DESC
LIMIT 1;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'JOIN', 'DATE', 'LIMIT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List all employees id who have received a certification from ""Microsoft"" and whose certification expiration date is within the first 3 months of 2024",[{'employee_id': 3536254}],"
SELECT
  employee_id
FROM employee_certification AS ec
WHERE
  ec.issuing_organization = 'Microsoft' AND ec.expiration_date BETWEEN '2024-01-01' AND '2024-03-31';
```",,[{'employee_id': 3536254}],"[""SELECT employee_id FROM employee_certification WHERE issuing_organization = 'Microsoft' AND employee_certification.expiration_date >= date('2024-01-01') AND employee_certification.expiration_date <= date('2024-01-01') + INTERVAL '3 months';""]",68,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"List all employees id who have received a certification from ""Microsoft"" and whose certification expiration date is within the first 3 months of 2024","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
employee_id
FROM employee_certification AS ec
WHERE
ec.issuing_organization = 'Microsoft' AND ec.expiration_date BETWEEN '2024-01-01' AND '2024-03-31';
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'DATE', 'time']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find employees id who have received a certification that matches a 'AWS' & 'AMAZON' keyword in its name or issuing organization.","[{'employee_id': 3536251}, {'employee_id': 3536254}]","
SELECT ""employee"".""employee_id""
FROM ""employee""
INNER JOIN ""employee_certification"" ON ""employee"".""employee_id"" = ""employee_certification"".""employee_id""
WHERE ""employee_certification"".""certification_name"" ILIKE '%AWS%' OR ""employee_certification"".""issuing_organization"" ILIKE '%AMAZON%';
```",,"[{'employee_id': 3536251}, {'employee_id': 3536254}]","[""SELECT ec.employee_id FROM employee_certification as ec WHERE UPPER(certification_name) LIKE '%AWS%' OR UPPER(issuing_organization) LIKE '%AMAZON%';""]",75,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Find employees id who have received a certification that matches a 'AWS' & 'AMAZON' keyword in its name or issuing organization.,"{'Comment': '""LGTM, the search should be case insensitive""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""UPPER(certification_name) LIKE \'%AWS%\' OR UPPER(issuing_organization) LIKE \'%AMAZON%\'""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT ""employee"".""employee_id""
FROM ""employee""
INNER JOIN ""employee_certification"" ON ""employee"".""employee_id"" = ""employee_certification"".""employee_id""
WHERE ""employee_certification"".""certification_name"" ILIKE '%AWS%' OR ""employee_certification"".""issuing_organization"" ILIKE '%AMAZON%';
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'LIKE', 'Data Linking']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42703', 'M': 'column erd.returned_days does not exist', 'H': 'Perhaps you meant to reference the column ""erd.returned_date"".', 'P': '1231', 'F': 'parse_relation.c', 'L': '3738', 'R': 'errorMissingColumn'}
[SQL: 
/* Step 1: Identify the Relevant Tables and Columns */
/* We need the ""employee_termination"" table for termination data, 
and ""employee_computer"" table for computer return data. */
/* From ""employee_termination"", we need the employee_id and termination_date columns. 
From ""employee_computer"", we need the employee_id, returned_date, and assigned_date columns. */
/* Join the two tables on employee_id to link the termination and computer return data for each employee. */

/* Step 2: Link the Tables */
/* Left join ""employee_computer"" and ""employee_termination"" on employee_id. */
WITH employee_return_data AS (
SELECT
ec.employee_id,
ec.returned_date,
ec.assigned_date,
et.termination_date
FROM ""employee_computer"" AS ec
LEFT JOIN ""employee_termination"" AS et
ON ec.employee_id = et.employee_id
)

/* Step 3: Calculate the Difference in Days */
/* Subtract assigned_date from returned_date to get the number of days for returning the computer. */
/* Filter out employees who haven't returned their computers by checking for non-null returned_date values. */
/* Calculate the average number of days for returning computers, categorized by reason for termination. */
SELECT
et.reason, /* Category: Reason for termination */
AVG(erd.returned_days) AS average_days_to_return_computer
FROM employee_return_data AS erd
LEFT JOIN ""employee_termination"" AS et
ON erd.employee_id = et.employee_id
WHERE
erd.returned_date IS NOT NULL /* Filter out employees who haven't returned their computers */
GROUP BY
et.reason /* Group by termination reason */
ORDER BY
et.reason NULLS LAST;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Determine the average number of days taken for employees to return company-owned computers after termination, categorized by the reason for termination.",[],"
/* Step 1: Identify the Relevant Tables and Columns */
/* We need the ""employee_termination"" table for termination data, 
and ""employee_computer"" table for computer return data. */
/* From ""employee_termination"", we need the employee_id and termination_date columns. 
From ""employee_computer"", we need the employee_id, returned_date, and assigned_date columns. */
/* Join the two tables on employee_id to link the termination and computer return data for each employee. */

/* Step 2: Link the Tables */
/* Left join ""employee_computer"" and ""employee_termination"" on employee_id. */
WITH employee_return_data AS (
  SELECT
    ec.employee_id,
    ec.returned_date,
    ec.assigned_date,
    et.termination_date
  FROM ""employee_computer"" AS ec
  LEFT JOIN ""employee_termination"" AS et
    ON ec.employee_id = et.employee_id
)

/* Step 3: Calculate the Difference in Days */
/* Subtract assigned_date from returned_date to get the number of days for returning the computer. */
/* Filter out employees who haven't returned their computers by checking for non-null returned_date values. */
/* Calculate the average number of days for returning computers, categorized by reason for termination. */
SELECT
  et.reason, /* Category: Reason for termination */
  AVG(erd.returned_days) AS average_days_to_return_computer
FROM employee_return_data AS erd
LEFT JOIN ""employee_termination"" AS et
  ON erd.employee_id = et.employee_id
WHERE
  erd.returned_date IS NOT NULL /* Filter out employees who haven't returned their computers */
GROUP BY
  et.reason /* Group by termination reason */
ORDER BY
  et.reason NULLS LAST;
```",,"[{'avg_return_days': '-974.0000000000000000', 'reason': 'Dismissal'}]","['SELECT et.reason, AVG(ec.returned_date - et.termination_date) AS avg_return_days FROM employee_termination et JOIN employee_computer ec ON et.employee_id = ec.employee_id WHERE ec.returned_date IS NOT NULL GROUP BY et.reason;']",44,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Determine the average number of days taken for employees to return company-owned computers after termination, categorized by the reason for termination.","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
/* Step 1: Identify the Relevant Tables and Columns */
/* We need the ""employee_termination"" table for termination data, 
and ""employee_computer"" table for computer return data. */
/* From ""employee_termination"", we need the employee_id and termination_date columns. 
From ""employee_computer"", we need the employee_id, returned_date, and assigned_date columns. */
/* Join the two tables on employee_id to link the termination and computer return data for each employee. */

/* Step 2: Link the Tables */
/* Left join ""employee_computer"" and ""employee_termination"" on employee_id. */
WITH employee_return_data AS (
SELECT
ec.employee_id,
ec.returned_date,
ec.assigned_date,
et.termination_date
FROM ""employee_computer"" AS ec
LEFT JOIN ""employee_termination"" AS et
ON ec.employee_id = et.employee_id
)

/* Step 3: Calculate the Difference in Days */
/* Subtract assigned_date from returned_date to get the number of days for returning the computer. */
/* Filter out employees who haven't returned their computers by checking for non-null returned_date values. */
/* Calculate the average number of days for returning computers, categorized by reason for termination. */
SELECT
et.reason, /* Category: Reason for termination */
AVG(erd.returned_days) AS average_days_to_return_computer
FROM employee_return_data AS erd
LEFT JOIN ""employee_termination"" AS et
ON erd.employee_id = et.employee_id
WHERE
erd.returned_date IS NOT NULL /* Filter out employees who haven't returned their computers */
GROUP BY
et.reason /* Group by termination reason */
ORDER BY
et.reason NULLS LAST;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'AGGREGATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List employees who have requested leave due to burnout or work-related stress in the last six months, along with their leave duration and reasons cited in their leave requests",[],"
SELECT 
    e.""first_name"" || ' ' || e.""last_name"" AS ""Employee Name"",
    lr.""leave_type"" AS ""Leave Type"",
    lr.""duration"" AS ""Leave Duration (Days)"",
    lr.""reason"" AS ""Leave Reason""
FROM 
    ""employee"" e
JOIN 
    ""leave_request"" lr ON e.""employee_id"" = lr.""employee_id""
WHERE 
    lr.""leave_type"" IN ('Burnout', 'Work Related Stress') AND lr.""start_date"" BETWEEN CURRENT_DATE - INTERVAL '6 months' AND CURRENT_DATE
ORDER BY 
    e.""last_name"", e.""first_name"";
```",,[],"[""SELECT e.employee_id, e.first_name, e.last_name, lr.leave_type, lr.start_date, lr.end_date, lr.duration, lr.reason, lr.comments FROM employee e JOIN leave_request lr ON e.employee_id = lr.employee_id WHERE lr.start_date BETWEEN CURRENT_DATE - INTERVAL '6 MONTH' AND CURRENT_DATE AND (lr.reason LIKE '%Personal%' OR lr.reason LIKE '%stress%');""]",111,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"List employees who have requested leave due to burnout or work-related stress in the last six months, along with their leave duration and reasons cited in their leave requests","{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT 
e.""first_name"" || ' ' || e.""last_name"" AS ""Employee Name"",
lr.""leave_type"" AS ""Leave Type"",
lr.""duration"" AS ""Leave Duration (Days)"",
lr.""reason"" AS ""Leave Reason""
FROM 
""employee"" e
JOIN 
""leave_request"" lr ON e.""employee_id"" = lr.""employee_id""
WHERE 
lr.""leave_type"" IN ('Burnout', 'Work Related Stress') AND lr.""start_date"" BETWEEN CURRENT_DATE - INTERVAL '6 months' AND CURRENT_DATE
ORDER BY 
e.""last_name"", e.""first_name"";
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'JOIN', 'DATE', 'LIKE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Calculate the percentage of leaves approved or rejected categorized by leave type in the year 2023.","[{'leave_type': 'Sick Leave', 'percentage': 8.333333333333334, 'status': 'Pending'}, {'leave_type': 'Personal Leave', 'percentage': 8.333333333333334, 'status': 'Approved'}, {'leave_type': 'Annual Leave', 'percentage': 16.666666666666668, 'status': 'Approved'}, {'leave_type': 'Annual Leave', 'percentage': 16.666666666666668, 'status': 'Pending'}, {'leave_type': 'Annual Leave', 'percentage': 8.333333333333334, 'status': 'Rejected'}, {'leave_type': 'Maternity Leave', 'percentage': 16.666666666666668, 'status': 'Approved'}, {'leave_type': 'Personal Leave', 'percentage': 8.333333333333334, 'status': 'Pending'}, {'leave_type': 'Sick Leave', 'percentage': 16.666666666666668, 'status': 'Approved'}]","
WITH LeaveRequests AS (
  SELECT
    leave_id,
    leave_type,
    status
  FROM leave_request
  WHERE
    start_date >= '2023-01-01' AND start_date <= '2023-12-31'
), LeaveCounts AS (
  SELECT
    leave_type,
    status,
    COUNT(*) AS count
  FROM LeaveRequests
  GROUP BY
    leave_type,
    status
)
SELECT
  lc.leave_type,
  lc.status,
  CAST(lc.count AS REAL) * 100 / (
    SELECT
      COUNT(*)
    FROM LeaveRequests
  ) AS percentage
FROM LeaveCounts lc;
```",,"[{'approved_percentage': '50.00', 'leave_type': 'Personal Leave', 'rejected_percentage': '0.00'}, {'approved_percentage': '100.00', 'leave_type': 'Maternity Leave', 'rejected_percentage': '0.00'}, {'approved_percentage': '66.67', 'leave_type': 'Sick Leave', 'rejected_percentage': '0.00'}, {'approved_percentage': '40.00', 'leave_type': 'Annual Leave', 'rejected_percentage': '20.00'}]","[""SELECT leave_type, CAST(SUM(CASE WHEN status = 'Approved' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS NUMERIC(5,2)) AS approved_percentage, CAST(SUM(CASE WHEN status = 'Rejected' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS NUMERIC(5,2)) AS rejected_percentage FROM leave_request WHERE EXTRACT(YEAR FROM leave_request.start_date) = 2023 GROUP BY leave_type;""]",55,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Calculate the percentage of leaves approved or rejected categorized by leave type in the year 2023.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH LeaveRequests AS (
SELECT
leave_id,
leave_type,
status
FROM leave_request
WHERE
start_date >= '2023-01-01' AND start_date <= '2023-12-31'
), LeaveCounts AS (
SELECT
leave_type,
status,
COUNT(*) AS count
FROM LeaveRequests
GROUP BY
leave_type,
status
)
SELECT
lc.leave_type,
lc.status,
CAST(lc.count AS REAL) * 100 / (
SELECT
COUNT(*)
FROM LeaveRequests
) AS percentage
FROM LeaveCounts lc;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'CASE', 'DATE']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '22P02', 'M': 'invalid input syntax for type numeric: ""1 DAY""', 'P': '168', 'F': 'numeric.c', 'L': '803', 'R': 'numeric_in'}
[SQL: 
SELECT
e.""employee_id"" AS ""Employee ID"",
COALESCE(e.""first_name"", '') || ' ' || COALESCE(e.""last_name"", '') AS ""Employee Name"",
SUM(
COALESCE(leave_request.duration, '1 DAY')
) AS ""Total Sick Leave Duration""
FROM employee AS e
JOIN leave_request
ON leave_request.""employee_id"" = e.""employee_id"" AND leave_request.leave_type = 'Sick Leave'
WHERE
DATE(leave_request.start_date) >= DATE '2023-01-01'
AND DATE(leave_request.start_date) < DATE '2023-04-01'
GROUP BY
1,
2
HAVING
COUNT(*) >= 2
ORDER BY
""Total Sick Leave Duration"" DESC;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find employees id and names who have taken sick leave are twice or more in the first quarter of 2023 and list their total sick leave duration.",[],"
SELECT
  e.""employee_id"" AS ""Employee ID"",
  COALESCE(e.""first_name"", '') || ' ' || COALESCE(e.""last_name"", '') AS ""Employee Name"",
  SUM(
    COALESCE(leave_request.duration, '1 DAY')
  ) AS ""Total Sick Leave Duration""
FROM employee AS e
JOIN leave_request
  ON leave_request.""employee_id"" = e.""employee_id"" AND leave_request.leave_type = 'Sick Leave'
WHERE
  DATE(leave_request.start_date) >= DATE '2023-01-01'
  AND DATE(leave_request.start_date) < DATE '2023-04-01'
GROUP BY
  1,
  2
HAVING
  COUNT(*) >= 2
ORDER BY
  ""Total Sick Leave Duration"" DESC;
```",,"[{'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith', 'total_sick_leave_days': 2}]","[""SELECT e.employee_id, e.first_name, e.last_name, SUM(lr.end_date - lr.start_date) AS total_sick_leave_days FROM employee e JOIN leave_request lr ON e.employee_id = lr.employee_id WHERE lr.leave_type = 'Sick Leave' AND lr.start_date >= '2023-01-01' AND lr.start_date <= '2023-03-31' GROUP BY e.employee_id, e.first_name, e.last_name HAVING SUM(lr.end_date - lr.start_date) >= 2;""]",78,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Find employees id and names who have taken sick leave are twice or more in the first quarter of 2023 and list their total sick leave duration.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""leave_type= \'Sick Leave\'""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
e.""employee_id"" AS ""Employee ID"",
COALESCE(e.""first_name"", '') || ' ' || COALESCE(e.""last_name"", '') AS ""Employee Name"",
SUM(
COALESCE(leave_request.duration, '1 DAY')
) AS ""Total Sick Leave Duration""
FROM employee AS e
JOIN leave_request
ON leave_request.""employee_id"" = e.""employee_id"" AND leave_request.leave_type = 'Sick Leave'
WHERE
DATE(leave_request.start_date) >= DATE '2023-01-01'
AND DATE(leave_request.start_date) < DATE '2023-04-01'
GROUP BY
1,
2
HAVING
COUNT(*) >= 2
ORDER BY
""Total Sick Leave Duration"" DESC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'HAVING', 'JOIN', 'time', 'Data Linking', 'DATEDIFF']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve employees id who have worked overtime for more than 1 hours in a single shift.",[],"
SELECT DISTINCT a.employee_id
FROM attendance AS a
JOIN timesheet_employee AS te ON a.employee_id = te.employee_id
WHERE a.date >= DATE('2023-01-01') AND a.overtime_hours > 1;
```",,"[{'employee_id': 3536256}, {'employee_id': 3536259}, {'employee_id': 3536262}, {'employee_id': 3536264}]",['SELECT employee_id FROM attendance WHERE overtime_hours >= 1;'],77,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve employees id who have worked overtime for more than 1 hours in a single shift.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""overtime_hours= 2""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT DISTINCT a.employee_id
FROM attendance AS a
JOIN timesheet_employee AS te ON a.employee_id = te.employee_id
WHERE a.date >= DATE('2023-01-01') AND a.overtime_hours > 1;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42703', 'M': 'column tr.job_id does not exist', 'P': '706', 'F': 'parse_relation.c', 'L': '3727', 'R': 'errorMissingColumn'}
[SQL: SELECT D.department_name,
 count(DISTINCT T.training_id) AS total_mandatory_trainings,
 count(DISTINCT A.employee_id) AS total_employees_attended_mandatory_trainings,
 CAST(100 * count(DISTINCT A.employee_id) AS REAL) / count(DISTINCT T.training_id) AS attendance_percentage
 from department D
JOIN job J ON D.department_id = J.department_id
JOIN job_history JH ON J.job_id = JH.job_id
JOIN employee E ON JH.employee_id = E.employee_id
JOIN employee_training ET ON E.employee_id = ET.employee_id
JOIN training T ON ET.training_id = T.training_id
JOIN attendance A ON A.employee_id = E.employee_id

WHERE A.date = T.date AND J.job_title IN (SELECT JT.job_title FROM job JT
JOIN training TR ON TR.job_id = JT.job_id 
WHERE TR.attendance_required = TRUE)
GROUP BY 
D.department_id
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Break down attendance rates for mandatory trainings for each department. Compute the percentage.",[],"SELECT D.department_name,
       count(DISTINCT T.training_id) AS total_mandatory_trainings,
       count(DISTINCT A.employee_id) AS total_employees_attended_mandatory_trainings,
       CAST(100 * count(DISTINCT A.employee_id) AS REAL) / count(DISTINCT T.training_id) AS attendance_percentage
       from department D
JOIN job J ON D.department_id = J.department_id
JOIN job_history JH ON J.job_id = JH.job_id
JOIN employee E ON JH.employee_id = E.employee_id
JOIN employee_training ET ON E.employee_id = ET.employee_id
JOIN training T ON ET.training_id = T.training_id
JOIN attendance A ON A.employee_id = E.employee_id

WHERE A.date = T.date AND J.job_title IN (SELECT JT.job_title FROM job JT
JOIN training TR ON TR.job_id = JT.job_id 
WHERE TR.attendance_required = TRUE)
GROUP BY 
D.department_id
",,"[{'completion_rate': '150.00', 'department_id': 3}, {'completion_rate': '116.67', 'department_id': 2}, {'completion_rate': '100.00', 'department_id': 1}]","[""select e.department_id, round(100.0 * sum(case when end_date is not null then 1 else 0 end) / sum(case when t.attendance_required then 1 else 0 end), 2) as completion_rate from employee e inner join employee_training et on e.employee_id = et.employee_id inner join training t on et.training_id = t.training_id and t.date BETWEEN '2023-01-01' and '2024-12-31' group by e.department_id order by completion_rate desc""]",18,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Break down attendance rates for mandatory trainings for each department. Compute the percentage.,"{'Comment': '""LGTM. Question may need more context""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"SELECT D.department_name,
 count(DISTINCT T.training_id) AS total_mandatory_trainings,
 count(DISTINCT A.employee_id) AS total_employees_attended_mandatory_trainings,
 CAST(100 * count(DISTINCT A.employee_id) AS REAL) / count(DISTINCT T.training_id) AS attendance_percentage
 from department D
JOIN job J ON D.department_id = J.department_id
JOIN job_history JH ON J.job_id = JH.job_id
JOIN employee E ON JH.employee_id = E.employee_id
JOIN employee_training ET ON E.employee_id = ET.employee_id
JOIN training T ON ET.training_id = T.training_id
JOIN attendance A ON A.employee_id = E.employee_id

WHERE A.date = T.date AND J.job_title IN (SELECT JT.job_title FROM job JT
JOIN training TR ON TR.job_id = JT.job_id 
WHERE TR.attendance_required = TRUE)
GROUP BY 
D.department_id
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'JOIN', 'AGGREGATE', 'CASE', 'ROUND']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Which employee has the most certifications?","[{'employee_id': 3536251}, {'employee_id': 3536251}, {'employee_id': 3536252}, {'employee_id': 3536252}, {'employee_id': 3536253}, {'employee_id': 3536253}, {'employee_id': 3536254}, {'employee_id': 3536254}, {'employee_id': 3536255}, {'employee_id': 3536255}, {'employee_id': 3536256}, {'employee_id': 3536256}, {'employee_id': 3536257}, {'employee_id': 3536257}, {'employee_id': 3536258}, {'employee_id': 3536258}, {'employee_id': 3536259}, {'employee_id': 3536259}, {'employee_id': 3536260}, {'employee_id': 3536260}]","
SELECT
  cert.""employee_id""
FROM ""employee_certification"" AS cert
ORDER BY
  cert.""employee_id"";
```",,"[{'employee_id': 3536252}, {'employee_id': 3536258}, {'employee_id': 3536259}, {'employee_id': 3536256}, {'employee_id': 3536251}, {'employee_id': 3536254}, {'employee_id': 3536260}, {'employee_id': 3536253}, {'employee_id': 3536257}, {'employee_id': 3536255}]","['WITH employee_cert_count AS (SELECT employee_id, COUNT(*) cnt FROM employee_certification GROUP BY employee_id ORDER BY cnt DESC) SELECT employee_id FROM employee_cert_count WHERE cnt IN (SELECT MAX(cnt) FROM employee_cert_count)']",6,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Which employee has the most certifications?,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
cert.""employee_id""
FROM ""employee_certification"" AS cert
ORDER BY
cert.""employee_id"";
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'SORT', 'LIMIT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the names and contact information of employees who have incurred business expenses exceeding $400 in the second quarter of 2024.","[{'email': 'sarah.jones@example.com', 'first_name': 'Sarah', 'last_name': 'Jones', 'phone_number': '333-333-3333'}]","SELECT ""e"".""first_name"", ""e"".""last_name"", ""e"".""phone_number"", ""e"".""email""
FROM ""employee"" AS ""e""
JOIN ""employee_business_expense"" AS ""ebe"" ON ""e"".""employee_id"" = ""ebe"".""employee_id""
WHERE ""ebe"".""expense_date"" BETWEEN '2024-04-01' AND '2024-06-30'
AND ""ebe"".""expense_amount"" > 400;",,"[{'email': 'sarah.jones@example.com', 'first_name': 'Sarah', 'phone_number': '333-333-3333'}]","[""SELECT e.first_name, e.email, e.phone_number FROM employee e JOIN employee_business_expense b ON e.employee_id = b.employee_id WHERE b.expense_amount > 400 AND b.expense_date BETWEEN '2024-04-01'AND '2024-06-30';""]",65,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve the names and contact information of employees who have incurred business expenses exceeding $400 in the second quarter of 2024.,"{'Comment': '""LGTM, fixing the year, due to the static nature of our database""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""b.expense_amount > 400 AND b.expense_date BETWEEN \'2024-04-01\'AND \'2024-06-30\'""'}",,dql,2025-02-10 18:36:22.083420,"SELECT ""e"".""first_name"", ""e"".""last_name"", ""e"".""phone_number"", ""e"".""email""
FROM ""employee"" AS ""e""
JOIN ""employee_business_expense"" AS ""ebe"" ON ""e"".""employee_id"" = ""ebe"".""employee_id""
WHERE ""ebe"".""expense_date"" BETWEEN '2024-04-01' AND '2024-06-30'
AND ""ebe"".""expense_amount"" > 400;",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'JOIN', 'DATE', 'BETWEEN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Determine the total amount spent on employee business expenses categorized by expense category in Q3 of 2024.","[{'expense_category': 'Accommodation', 'total_expense': '180.00'}, {'expense_category': 'Transportation', 'total_expense': '400.00'}]","
SELECT
    ec.""expense_category"",
    SUM(ec.""expense_amount"") AS ""total_expense""
FROM
    ""employee_business_expense"" AS ec
WHERE
    ec.""expense_date"" BETWEEN '2024-07-01' AND '2024-09-30'
GROUP BY
    ec.""expense_category""
ORDER BY
    ec.""expense_category"" NULLS LAST;
```",,"[{'expense_category': 'Transportation', 'total_expense_amount': '400.00'}, {'expense_category': 'Accommodation', 'total_expense_amount': '180.00'}]","[""SELECT expense_category, SUM(expense_amount) AS total_expense_amount FROM employee_business_expense WHERE expense_date >= '2024-07-01' AND expense_date <= '2024-09-30' GROUP BY expense_category;""]",59,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Determine the total amount spent on employee business expenses categorized by expense category in Q3 of 2024.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
ec.""expense_category"",
SUM(ec.""expense_amount"") AS ""total_expense""
FROM
""employee_business_expense"" AS ec
WHERE
ec.""expense_date"" BETWEEN '2024-07-01' AND '2024-09-30'
GROUP BY
ec.""expense_category""
ORDER BY
ec.""expense_category"" NULLS LAST;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'AGGREGATE', 'DATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List all employees names who have attended training sessions on weekends.","[{'first_name': 'John', 'last_name': 'Doe'}, {'first_name': 'Matthew', 'last_name': 'Brown'}, {'first_name': 'Daniel', 'last_name': 'Garcia'}, {'first_name': 'Megan', 'last_name': 'Hernandez'}, {'first_name': 'Olivia', 'last_name': 'Rivera'}, {'first_name': 'Charlotte', 'last_name': 'Cooper'}]","
WITH EmployeeTraining AS (
  SELECT
    e.""employee_id"",
    t.""date"" AS training_date
  FROM ""employee"" AS e
  INNER JOIN ""employee_training"" AS et
    ON e.""employee_id"" = et.""employee_id""
  INNER JOIN ""training"" AS t
    ON et.""training_id"" = t.""training_id""
  WHERE
    EXTRACT(ISODOW FROM t.""date"") IN (6, 7)
)
SELECT
  e.""first_name"",
  e.""last_name""
FROM ""employee"" AS e
INNER JOIN EmployeeTraining AS et
  ON e.""employee_id"" = et.""employee_id"";
```",,"[{'first_name': 'John', 'last_name': 'Doe'}, {'first_name': 'Matthew', 'last_name': 'Brown'}, {'first_name': 'Daniel', 'last_name': 'Garcia'}, {'first_name': 'Megan', 'last_name': 'Hernandez'}, {'first_name': 'Olivia', 'last_name': 'Rivera'}, {'first_name': 'Charlotte', 'last_name': 'Cooper'}]","['SELECT e.first_name, e.last_name FROM employee e JOIN employee_training et ON e.employee_id = et.employee_id JOIN training t ON et.training_id = t.training_id WHERE EXTRACT(ISODOW FROM t.date) IN (6, 7);']",100,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,List all employees names who have attended training sessions on weekends.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH EmployeeTraining AS (
SELECT
e.""employee_id"",
t.""date"" AS training_date
FROM ""employee"" AS e
INNER JOIN ""employee_training"" AS et
ON e.""employee_id"" = et.""employee_id""
INNER JOIN ""training"" AS t
ON et.""training_id"" = t.""training_id""
WHERE
EXTRACT(ISODOW FROM t.""date"") IN (6, 7)
)
SELECT
e.""first_name"",
e.""last_name""
FROM ""employee"" AS e
INNER JOIN EmployeeTraining AS et
ON e.""employee_id"" = et.""employee_id"";
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'DATE', 'DAY OF WEEK']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Determine the total number of benefits each employee is enrolled in.","[{'employee_id': 3536261, 'first_name': 'David', 'last_name': 'Lopez', 'total_benefits': 1}, {'employee_id': 3536264, 'first_name': 'Sophia', 'last_name': 'Perez', 'total_benefits': 1}, {'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe', 'total_benefits': 1}, {'employee_id': 3536269, 'first_name': 'Noah', 'last_name': 'King', 'total_benefits': 1}, {'employee_id': 3536268, 'first_name': 'Emma', 'last_name': 'Reyes', 'total_benefits': 1}, {'employee_id': 3536254, 'first_name': 'Emily', 'last_name': 'Williams', 'total_benefits': 1}, {'employee_id': 3536260, 'first_name': 'Taylor', 'last_name': 'Rodriguez', 'total_benefits': 1}, {'employee_id': 3536253, 'first_name': 'Michael', 'last_name': 'Johnson', 'total_benefits': 1}, {'employee_id': 3536262, 'first_name': 'Megan', 'last_name': 'Hernandez', 'total_benefits': 1}, {'employee_id': 3536270, 'first_name': 'Charlotte', 'last_name': 'Cooper', 'total_benefits': 1}, {'employee_id': 3536267, 'first_name': 'Liam', 'last_name': 'Gomez', 'total_benefits': 1}, {'employee_id': 3536266, 'first_name': 'Olivia', 'last_name': 'Rivera', 'total_benefits': 1}, {'employee_id': 3536257, 'first_name': 'Christopher', 'last_name': 'Davis', 'total_benefits': 1}, {'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown', 'total_benefits': 1}, {'employee_id': 3536265, 'first_name': 'Aiden', 'last_name': 'Torres', 'total_benefits': 1}, {'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith', 'total_benefits': 1}, {'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez', 'total_benefits': 1}, {'employee_id': 3536259, 'first_name': 'Daniel', 'last_name': 'Garcia', 'total_benefits': 1}, {'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones', 'total_benefits': 1}, {'employee_id': 3536263, 'first_name': 'Andrew', 'last_name': 'Gonzalez', 'total_benefits': 1}]","
-- Count the number of benefits for each employee
SELECT
    e.employee_id,
    e.first_name,
    e.last_name,
    COUNT(eb.benefit_id) AS total_benefits
-- Join the 'employee' table with the 'employee_x_benefit' table
FROM employee AS e
LEFT JOIN employee_x_benefit AS eb
    ON e.employee_id = eb.employee_id
-- Group the results by employee ID and their names
GROUP BY
    e.employee_id,
    e.first_name,
    e.last_name
-- Order the results in descending order of the total number of benefits
ORDER BY
    total_benefits DESC;
```",,"[{'employee_id': 3536261, 'total_benefits_enrolled': 1}, {'employee_id': 3536264, 'total_benefits_enrolled': 1}, {'employee_id': 3536251, 'total_benefits_enrolled': 1}, {'employee_id': 3536269, 'total_benefits_enrolled': 1}, {'employee_id': 3536268, 'total_benefits_enrolled': 1}, {'employee_id': 3536254, 'total_benefits_enrolled': 1}, {'employee_id': 3536260, 'total_benefits_enrolled': 1}, {'employee_id': 3536253, 'total_benefits_enrolled': 1}, {'employee_id': 3536262, 'total_benefits_enrolled': 1}, {'employee_id': 3536270, 'total_benefits_enrolled': 1}, {'employee_id': 3536267, 'total_benefits_enrolled': 1}, {'employee_id': 3536266, 'total_benefits_enrolled': 1}, {'employee_id': 3536257, 'total_benefits_enrolled': 1}, {'employee_id': 3536255, 'total_benefits_enrolled': 1}, {'employee_id': 3536265, 'total_benefits_enrolled': 1}, {'employee_id': 3536252, 'total_benefits_enrolled': 1}, {'employee_id': 3536258, 'total_benefits_enrolled': 1}, {'employee_id': 3536259, 'total_benefits_enrolled': 1}, {'employee_id': 3536256, 'total_benefits_enrolled': 1}, {'employee_id': 3536263, 'total_benefits_enrolled': 1}]","['SELECT e.employee_id, COUNT(eb.benefit_id) AS total_benefits_enrolled FROM employee e LEFT JOIN employee_x_benefit eb ON e.employee_id = eb.employee_id GROUP BY e.employee_id;']",96,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Determine the total number of benefits each employee is enrolled in.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
-- Count the number of benefits for each employee
SELECT
e.employee_id,
e.first_name,
e.last_name,
COUNT(eb.benefit_id) AS total_benefits
-- Join the 'employee' table with the 'employee_x_benefit' table
FROM employee AS e
LEFT JOIN employee_x_benefit AS eb
ON e.employee_id = eb.employee_id
-- Group the results by employee ID and their names
GROUP BY
e.employee_id,
e.first_name,
e.last_name
-- Order the results in descending order of the total number of benefits
ORDER BY
total_benefits DESC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'LEFT_JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List the holidays observed by the company in the last year, along with the occasions and geographic locations where they were celebrated.","[{'holiday_date': '2024-02-14', 'holiday_location': 'USA', 'holiday_occasion': ""Valentine's Day""}, {'holiday_date': '2024-03-17', 'holiday_location': 'USA', 'holiday_occasion': ""St. Patrick's Day""}, {'holiday_date': '2024-04-01', 'holiday_location': 'USA', 'holiday_occasion': 'Easter Sunday'}, {'holiday_date': '2024-05-27', 'holiday_location': 'USA', 'holiday_occasion': 'Memorial Day'}, {'holiday_date': '2024-07-04', 'holiday_location': 'USA', 'holiday_occasion': 'Independence Day'}, {'holiday_date': '2024-09-02', 'holiday_location': 'USA', 'holiday_occasion': 'Labor Day'}, {'holiday_date': '2024-10-31', 'holiday_location': 'USA', 'holiday_occasion': 'Halloween'}, {'holiday_date': '2024-11-28', 'holiday_location': 'USA', 'holiday_occasion': 'Thanksgiving Day'}, {'holiday_date': '2024-12-25', 'holiday_location': 'USA', 'holiday_occasion': 'Christmas Day'}, {'holiday_date': '2025-01-01', 'holiday_location': 'USA', 'holiday_occasion': ""New Year's Day""}, {'holiday_date': '2025-01-20', 'holiday_location': 'USA', 'holiday_occasion': 'Martin Luther King Jr. Day'}, {'holiday_date': '2025-02-14', 'holiday_location': 'USA', 'holiday_occasion': ""Valentine's Day""}, {'holiday_date': '2025-03-17', 'holiday_location': 'USA', 'holiday_occasion': ""St. Patrick's Day""}, {'holiday_date': '2025-04-20', 'holiday_location': 'USA', 'holiday_occasion': 'Easter Sunday'}, {'holiday_date': '2025-05-26', 'holiday_location': 'USA', 'holiday_occasion': 'Memorial Day'}, {'holiday_date': '2025-07-04', 'holiday_location': 'USA', 'holiday_occasion': 'Independence Day'}]","
SELECT holiday.occasion AS holiday_occasion, holiday.date AS holiday_date, holiday.geographic_location AS holiday_location
FROM holiday
WHERE holiday.date >= (current_date - interval '1 year')
ORDER BY holiday.date ASC;
```",,"[{'date': '2024-01-01', 'geographic_location': 'USA', 'occasion': ""New Year's Day""}, {'date': '2024-01-15', 'geographic_location': 'USA', 'occasion': 'Martin Luther King Jr. Day'}, {'date': '2024-02-14', 'geographic_location': 'USA', 'occasion': ""Valentine's Day""}, {'date': '2024-03-17', 'geographic_location': 'USA', 'occasion': ""St. Patrick's Day""}, {'date': '2024-04-01', 'geographic_location': 'USA', 'occasion': 'Easter Sunday'}, {'date': '2024-05-27', 'geographic_location': 'USA', 'occasion': 'Memorial Day'}, {'date': '2024-07-04', 'geographic_location': 'USA', 'occasion': 'Independence Day'}, {'date': '2024-09-02', 'geographic_location': 'USA', 'occasion': 'Labor Day'}, {'date': '2024-10-31', 'geographic_location': 'USA', 'occasion': 'Halloween'}, {'date': '2024-11-28', 'geographic_location': 'USA', 'occasion': 'Thanksgiving Day'}, {'date': '2024-12-25', 'geographic_location': 'USA', 'occasion': 'Christmas Day'}]","['SELECT Date, Occasion, Geographic_location FROM holiday WHERE EXTRACT(YEAR FROM Date) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;']",63,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"List the holidays observed by the company in the last year, along with the occasions and geographic locations where they were celebrated.","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT holiday.occasion AS holiday_occasion, holiday.date AS holiday_date, holiday.geographic_location AS holiday_location
FROM holiday
WHERE holiday.date >= (current_date - interval '1 year')
ORDER BY holiday.date ASC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'DATE', 'time']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


How many employees have been hired each year and there avg salary?","[{'avg_salary': '68333.333333333333', 'total_employees_hired': 12, 'year_hired': '2023'}, {'avg_salary': '75000.000000000000', 'total_employees_hired': 8, 'year_hired': '2024'}]","
SELECT
    to_char(e.""hire_date"", 'YYYY') AS year_hired,
    COUNT(e.""employee_id"") AS total_employees_hired,
    AVG(s.""salary"") AS avg_salary
FROM
    ""employee"" e
INNER JOIN
    ""salary"" s ON e.""employee_id"" = s.""employee_id""
WHERE
    (s.""end_date"" IS NULL OR s.""end_date"" >= CURRENT_DATE)
GROUP BY
    year_hired
ORDER BY
    year_hired;
```",,"[{'avg_salary': '75000.000000000000', 'hire_year': '2024', 'total_hired': 8}, {'avg_salary': '68333.333333333333', 'hire_year': '2023', 'total_hired': 12}]","['SELECT EXTRACT(YEAR FROM hire_date) AS hire_year, COUNT(*) AS total_hired, AVG(salary) AS avg_salary FROM employee JOIN salary ON employee.employee_id = salary.employee_id GROUP BY EXTRACT(YEAR FROM hire_date);']",2,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,How many employees have been hired each year and there avg salary?,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
to_char(e.""hire_date"", 'YYYY') AS year_hired,
COUNT(e.""employee_id"") AS total_employees_hired,
AVG(s.""salary"") AS avg_salary
FROM
""employee"" e
INNER JOIN
""salary"" s ON e.""employee_id"" = s.""employee_id""
WHERE
(s.""end_date"" IS NULL OR s.""end_date"" >= CURRENT_DATE)
GROUP BY
year_hired
ORDER BY
year_hired;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'JOIN', 'AGGREGATE', 'DATE']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42703', 'M': 'column ""department_id"" does not exist', 'P': '47', 'F': 'parse_relation.c', 'L': '3727', 'R': 'errorMissingColumn'}
[SQL: 
WITH DepartmentAverageSalaries AS (
SELECT
department_id,
AVG(salary) AS department_average_salary
FROM salary
GROUP BY department_id

)

SELECT
e.employee_id,
e.first_name,
e.last_name,
s.salary,
COALESCE(das.department_average_salary, 0) AS department_average_salary,
s.salary - COALESCE(das.department_average_salary, 0) AS salary_difference
FROM salary s
JOIN employee e
ON s.employee_id = e.employee_id
LEFT JOIN DepartmentAverageSalaries das
ON e.department_id = das.department_id;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Calculate the difference between an employees salary and the average salary in their department.",[],"
WITH DepartmentAverageSalaries AS (
SELECT
department_id,
AVG(salary) AS department_average_salary
FROM salary
GROUP BY department_id

)

SELECT
e.employee_id,
e.first_name,
e.last_name,
s.salary,
COALESCE(das.department_average_salary, 0) AS department_average_salary,
s.salary - COALESCE(das.department_average_salary, 0) AS salary_difference
FROM salary s
JOIN employee e
ON s.employee_id = e.employee_id
LEFT JOIN DepartmentAverageSalaries das
ON e.department_id = das.department_id;
```",,"[{'employee_id': 3536254, 'first_name': 'Emily', 'last_name': 'Williams', 'salary': '55000.00', 'salary_difference': '-11428.571428571429'}, {'employee_id': 3536266, 'first_name': 'Olivia', 'last_name': 'Rivera', 'salary': '70000.00', 'salary_difference': '3571.428571428571'}, {'employee_id': 3536260, 'first_name': 'Taylor', 'last_name': 'Rodriguez', 'salary': '60000.00', 'salary_difference': '-6428.571428571429'}, {'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe', 'salary': '60000.00', 'salary_difference': '-6428.571428571429'}, {'employee_id': 3536263, 'first_name': 'Andrew', 'last_name': 'Gonzalez', 'salary': '70000.00', 'salary_difference': '3571.428571428571'}, {'employee_id': 3536269, 'first_name': 'Noah', 'last_name': 'King', 'salary': '70000.00', 'salary_difference': '3571.428571428571'}, {'employee_id': 3536257, 'first_name': 'Christopher', 'last_name': 'Davis', 'salary': '80000.00', 'salary_difference': '13571.428571428571'}, {'employee_id': 3536270, 'first_name': 'Charlotte', 'last_name': 'Cooper', 'salary': '80000.00', 'salary_difference': '6428.571428571429'}, {'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith', 'salary': '70000.00', 'salary_difference': '-3571.428571428571'}, {'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown', 'salary': '65000.00', 'salary_difference': '-8571.428571428571'}, {'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez', 'salary': '70000.00', 'salary_difference': '-3571.428571428571'}, {'employee_id': 3536261, 'first_name': 'David', 'last_name': 'Lopez', 'salary': '75000.00', 'salary_difference': '1428.571428571429'}, {'employee_id': 3536264, 'first_name': 'Sophia', 'last_name': 'Perez', 'salary': '80000.00', 'salary_difference': '6428.571428571429'}, {'employee_id': 3536267, 'first_name': 'Liam', 'last_name': 'Gomez', 'salary': '75000.00', 'salary_difference': '1428.571428571429'}, {'employee_id': 3536265, 'first_name': 'Aiden', 'last_name': 'Torres', 'salary': '90000.00', 'salary_difference': '16666.666666666667'}, {'employee_id': 3536259, 'first_name': 'Daniel', 'last_name': 'Garcia', 'salary': '85000.00', 'salary_difference': '11666.666666666667'}, {'employee_id': 3536253, 'first_name': 'Michael', 'last_name': 'Johnson', 'salary': '75000.00', 'salary_difference': '1666.666666666667'}, {'employee_id': 3536268, 'first_name': 'Emma', 'last_name': 'Reyes', 'salary': '65000.00', 'salary_difference': '-8333.333333333333'}, {'employee_id': 3536262, 'first_name': 'Megan', 'last_name': 'Hernandez', 'salary': '65000.00', 'salary_difference': '-8333.333333333333'}, {'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones', 'salary': '60000.00', 'salary_difference': '-13333.333333333333'}]","['SELECT e.employee_id, e.first_name, e.last_name, s.salary, s.salary - AVG(s.salary) OVER (PARTITION BY e.department_id) AS salary_difference FROM employee e JOIN salary s ON e.employee_id = s.employee_id;']",137,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Calculate the difference between an employees salary and the average salary in their department.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH DepartmentAverageSalaries AS (
SELECT
department_id,
AVG(salary) AS department_average_salary
FROM salary
GROUP BY department_id

)

SELECT
e.employee_id,
e.first_name,
e.last_name,
s.salary,
COALESCE(das.department_average_salary, 0) AS department_average_salary,
s.salary - COALESCE(das.department_average_salary, 0) AS salary_difference
FROM salary s
JOIN employee e
ON s.employee_id = e.employee_id
LEFT JOIN DepartmentAverageSalaries das
ON e.department_id = das.department_id;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Who are the newest employees for each department to join the company and their manager?","[{'department_name': 'Marketing', 'end_date': '2024-12-31', 'first_name': 'Charlotte', 'hire_date': '2024-08-15', 'last_name': 'Cooper', 'manager_id': 3536269, 'start_date': '2024-01-10'}, {'department_name': 'Human Resources', 'end_date': '2023-12-31', 'first_name': 'Noah', 'hire_date': '2024-07-10', 'last_name': 'King', 'manager_id': 3536251, 'start_date': '2023-01-01'}, {'department_name': 'Finance', 'end_date': '2023-12-31', 'first_name': 'Emma', 'hire_date': '2024-06-20', 'last_name': 'Reyes', 'manager_id': 3536251, 'start_date': '2023-01-01'}, {'department_name': 'Marketing', 'end_date': '2023-12-31', 'first_name': 'Liam', 'hire_date': '2024-05-15', 'last_name': 'Gomez', 'manager_id': 3536251, 'start_date': '2023-01-01'}, {'department_name': 'Human Resources', 'end_date': '2023-12-31', 'first_name': 'Olivia', 'hire_date': '2024-04-05', 'last_name': 'Rivera', 'manager_id': 3536251, 'start_date': '2023-01-01'}, {'department_name': 'Finance', 'end_date': '2023-12-31', 'first_name': 'Aiden', 'hire_date': '2024-03-20', 'last_name': 'Torres', 'manager_id': 3536251, 'start_date': '2023-01-01'}, {'department_name': 'Marketing', 'end_date': '2023-12-31', 'first_name': 'Sophia', 'hire_date': '2024-02-15', 'last_name': 'Perez', 'manager_id': 3536251, 'start_date': '2023-01-01'}, {'department_name': 'Human Resources', 'end_date': '2023-12-31', 'first_name': 'Andrew', 'hire_date': '2024-01-10', 'last_name': 'Gonzalez', 'manager_id': 3536251, 'start_date': '2023-01-01'}, {'department_name': 'Finance', 'end_date': '2023-12-31', 'first_name': 'Megan', 'hire_date': '2023-12-20', 'last_name': 'Hernandez', 'manager_id': 3536251, 'start_date': '2023-01-01'}, {'department_name': 'Marketing', 'end_date': '2023-12-31', 'first_name': 'David', 'hire_date': '2023-11-15', 'last_name': 'Lopez', 'manager_id': 3536251, 'start_date': '2023-01-01'}]","
SELECT
  e.""first_name"",
  e.""last_name"",
  e.""hire_date"",
  e.""manager_id"",
  m.""manager_id"",
  m.""start_date"",
  m.""end_date"",
  d.""department_name""
FROM ""employee"" AS e
JOIN ""manager"" AS m
  ON e.""manager_id"" = m.""manager_id""
JOIN ""department"" AS d
  ON e.""department_id"" = d.""department_id""
WHERE
  d.""department_name"" IN (
    SELECT
      ""department_name""
    FROM ""department""
  )
ORDER BY
  e.""hire_date"" DESC
LIMIT 10;
```",,"[{'department_id': 3, 'employee_id': 3536268, 'manager_id': 3536251}, {'department_id': 1, 'employee_id': 3536269, 'manager_id': 3536251}, {'department_id': 2, 'employee_id': 3536270, 'manager_id': 3536269}]","['WITH NewestEmployees AS ( SELECT e.employee_id, e.department_id, e.manager_id, e.hire_date, ROW_NUMBER() OVER (PARTITION BY e.department_id ORDER BY e.hire_date DESC) AS rn FROM employee e ) SELECT ne.employee_id, ne.department_id, ne.manager_id FROM NewestEmployees ne JOIN employee m ON ne.employee_id = m.employee_id WHERE ne.rn = 1;']",1,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Who are the newest employees for each department to join the company and their manager?,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
e.""first_name"",
e.""last_name"",
e.""hire_date"",
e.""manager_id"",
m.""manager_id"",
m.""start_date"",
m.""end_date"",
d.""department_name""
FROM ""employee"" AS e
JOIN ""manager"" AS m
ON e.""manager_id"" = m.""manager_id""
JOIN ""department"" AS d
ON e.""department_id"" = d.""department_id""
WHERE
d.""department_name"" IN (
SELECT
""department_name""
FROM ""department""
)
ORDER BY
e.""hire_date"" DESC
LIMIT 10;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'JOIN', 'RANK', 'SORT', 'WITH']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Calculate the total duration of approved leaves for each employee id.","[{'employee_id': 3536253, 'total_approved_leave_duration': '60.00'}, {'employee_id': 3536262, 'total_approved_leave_duration': '60.00'}, {'employee_id': 3536260, 'total_approved_leave_duration': '6.00'}, {'employee_id': 3536268, 'total_approved_leave_duration': '6.00'}, {'employee_id': 3536251, 'total_approved_leave_duration': '5.00'}, {'employee_id': 3536266, 'total_approved_leave_duration': '4.00'}, {'employee_id': 3536259, 'total_approved_leave_duration': '3.00'}, {'employee_id': 3536264, 'total_approved_leave_duration': '3.00'}, {'employee_id': 3536257, 'total_approved_leave_duration': '2.00'}, {'employee_id': 3536255, 'total_approved_leave_duration': '2.00'}, {'employee_id': 3536269, 'total_approved_leave_duration': '2.00'}]","
SELECT
    e.employee_id,
    SUM(lr.duration) AS total_approved_leave_duration
FROM
    employee AS e
INNER JOIN
    leave_request AS lr ON e.employee_id = lr.employee_id
WHERE
    lr.status = 'Approved'
GROUP BY
    e.employee_id
ORDER BY
    total_approved_leave_duration DESC;
```",,"[{'employee_id': 3536251, 'total_approved_leave_duration': '5.00'}, {'employee_id': 3536253, 'total_approved_leave_duration': '60.00'}, {'employee_id': 3536255, 'total_approved_leave_duration': '2.00'}, {'employee_id': 3536257, 'total_approved_leave_duration': '2.00'}, {'employee_id': 3536259, 'total_approved_leave_duration': '3.00'}, {'employee_id': 3536260, 'total_approved_leave_duration': '6.00'}, {'employee_id': 3536262, 'total_approved_leave_duration': '60.00'}, {'employee_id': 3536264, 'total_approved_leave_duration': '3.00'}, {'employee_id': 3536266, 'total_approved_leave_duration': '4.00'}, {'employee_id': 3536268, 'total_approved_leave_duration': '6.00'}, {'employee_id': 3536269, 'total_approved_leave_duration': '2.00'}]","[""SELECT e.employee_id, SUM(lr.duration) AS total_approved_leave_duration FROM employee e JOIN leave_request lr ON e.employee_id = lr.employee_id WHERE lr.status = 'Approved' GROUP BY e.employee_id, e.first_name, e.last_name;""]",98,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Calculate the total duration of approved leaves for each employee id.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
e.employee_id,
SUM(lr.duration) AS total_approved_leave_duration
FROM
employee AS e
INNER JOIN
leave_request AS lr ON e.employee_id = lr.employee_id
WHERE
lr.status = 'Approved'
GROUP BY
e.employee_id
ORDER BY
total_approved_leave_duration DESC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'AGGREGATE', 'SUM']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find the maximum budget among all departments.",[{'max_budget': '300000.00'}],"
SELECT MAX(""budget"") AS ""max_budget""
FROM ""department"";
```",,[{'max_budget': '300000.00'}],['SELECT MAX(budget) AS max_budget FROM department;'],143,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Find the maximum budget among all departments.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT MAX(""budget"") AS ""max_budget""
FROM ""department"";
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'AGGREGATE']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42702', 'M': 'column reference ""employee_id"" is ambiguous', 'P': '9', 'F': 'parse_relation.c', 'L': '835', 'R': 'scanRTEForColumn'}
[SQL: 
SELECT ""employee_id"", ""first_name"", ""last_name"", ""total_compensation""
FROM ""employee"" AS ""e""
JOIN ""salary"" AS ""s"" ON ""e"".""employee_id"" = ""s"".""employee_id""
WHERE ""s"".""end_date"" IS NULL
AND ""s"".""start_date"" <= CURRENT_DATE
AND ""e"".""department_id"" IN (
SELECT ""department_id""
FROM ""department""
WHERE ""department_name"" = 'Finance'
)
ORDER BY ""total_compensation"" ASC
LIMIT 1;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find the employee with the lowest total compensation in the current year, considering only employees in the ""Finance"" department.",[],"
SELECT ""employee_id"", ""first_name"", ""last_name"", ""total_compensation""
FROM ""employee"" AS ""e""
JOIN ""salary"" AS ""s"" ON ""e"".""employee_id"" = ""s"".""employee_id""
WHERE ""s"".""end_date"" IS NULL
AND ""s"".""start_date"" <= CURRENT_DATE
AND ""e"".""department_id"" IN (
  SELECT ""department_id""
  FROM ""department""
  WHERE ""department_name"" = 'Finance'
)
ORDER BY ""total_compensation"" ASC
LIMIT 1;
```",,"[{'employee_id': 3536256, 'total_compensation': '57000.00'}]","[""SELECT employee.employee_id, salary.total_compensation FROM employee JOIN salary ON employee.employee_id = salary.employee_id JOIN department ON employee.department_id = department.department_id WHERE salary.start_date >= '2023-01-01' AND department.department_name = 'Finance' AND salary.total_compensation = (SELECT MIN(salary.total_compensation) FROM salary JOIN employee ON salary.employee_id = employee.employee_id JOIN department ON employee.department_id = department.department_id WHERE salary.start_date >= '2023-01-01' AND department.department_name = 'Finance');""]",69,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Find the employee with the lowest total compensation in the current year, considering only employees in the ""Finance"" department.","{'Comment': '""LGTM, There can be multiple people with lowest compensations""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""department_name = \'Finance\'""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT ""employee_id"", ""first_name"", ""last_name"", ""total_compensation""
FROM ""employee"" AS ""e""
JOIN ""salary"" AS ""s"" ON ""e"".""employee_id"" = ""s"".""employee_id""
WHERE ""s"".""end_date"" IS NULL
AND ""s"".""start_date"" <= CURRENT_DATE
AND ""e"".""department_id"" IN (
SELECT ""department_id""
FROM ""department""
WHERE ""department_name"" = 'Finance'
)
ORDER BY ""total_compensation"" ASC
LIMIT 1;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'SORT', 'LIMIT', 'NESTED QUERY']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42803', 'M': 'column ""p.amount"" must appear in the GROUP BY clause or be used in an aggregate function', 'P': '65', 'F': 'parse_agg.c', 'L': '1444', 'R': 'check_ungrouped_columns_walker'}
[SQL: 
SELECT 
	i.invoice_id,
i.invoice_date,
	i.due_date,
	i.status,
p.amount as paid_amount
FROM 
	""invoice"" AS i
LEFT JOIN 
	""payment"" AS p ON i.invoice_id = p.invoice_id
GROUP BY 
	i.invoice_id, i.invoice_date, i.due_date, i.status
ORDER BY 
	i.invoice_id
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find the total amount paid for each invoice, including invoice details.",[],"
SELECT 
	i.invoice_id,
    i.invoice_date,
	i.due_date,
	i.status,
    p.amount as paid_amount
FROM 
	""invoice"" AS i
LEFT JOIN 
	""payment"" AS p ON i.invoice_id = p.invoice_id
GROUP BY 
	i.invoice_id, i.invoice_date, i.due_date, i.status
ORDER BY 
	i.invoice_id
```",,"[{'invoice_date': '2023-11-01', 'invoice_id': 11, 'total_amount': '1900.00', 'total_paid': '1900.00'}, {'invoice_date': '2023-08-01', 'invoice_id': 8, 'total_amount': '1100.00', 'total_paid': '1100.00'}, {'invoice_date': '2024-07-01', 'invoice_id': 19, 'total_amount': '1400.00', 'total_paid': '1400.00'}, {'invoice_date': '2023-04-01', 'invoice_id': 4, 'total_amount': '900.00', 'total_paid': '900.00'}, {'invoice_date': '2024-02-01', 'invoice_id': 14, 'total_amount': '1200.00', 'total_paid': '1200.00'}, {'invoice_date': '2023-03-01', 'invoice_id': 3, 'total_amount': '1800.00', 'total_paid': '1800.00'}, {'invoice_date': '2024-05-01', 'invoice_id': 17, 'total_amount': '2000.00', 'total_paid': '2000.00'}, {'invoice_date': '2024-08-01', 'invoice_id': 20, 'total_amount': '1100.00', 'total_paid': '1100.00'}, {'invoice_date': '2024-01-01', 'invoice_id': 13, 'total_amount': '1500.00', 'total_paid': '1500.00'}, {'invoice_date': '2023-10-01', 'invoice_id': 10, 'total_amount': '1300.00', 'total_paid': '1300.00'}, {'invoice_date': '2023-09-01', 'invoice_id': 9, 'total_amount': '1700.00', 'total_paid': '1700.00'}, {'invoice_date': '2023-07-01', 'invoice_id': 7, 'total_amount': '1400.00', 'total_paid': '1400.00'}, {'invoice_date': '2023-01-01', 'invoice_id': 1, 'total_amount': '1500.00', 'total_paid': '1500.00'}, {'invoice_date': '2023-05-01', 'invoice_id': 5, 'total_amount': '2000.00', 'total_paid': '2000.00'}, {'invoice_date': '2024-06-01', 'invoice_id': 18, 'total_amount': '1600.00', 'total_paid': '1600.00'}, {'invoice_date': '2023-02-01', 'invoice_id': 2, 'total_amount': '1200.00', 'total_paid': '1200.00'}, {'invoice_date': '2024-04-01', 'invoice_id': 16, 'total_amount': '900.00', 'total_paid': '900.00'}, {'invoice_date': '2024-03-01', 'invoice_id': 15, 'total_amount': '1800.00', 'total_paid': '1800.00'}, {'invoice_date': '2023-06-01', 'invoice_id': 6, 'total_amount': '1600.00', 'total_paid': '1600.00'}, {'invoice_date': '2023-12-01', 'invoice_id': 12, 'total_amount': '1000.00', 'total_paid': '1000.00'}]","['SELECT i.invoice_id, i.invoice_date, i.total_amount, SUM(p.amount) AS total_paid FROM invoice i LEFT JOIN payment p ON i.invoice_id = p.invoice_id GROUP BY i.invoice_id, i.invoice_date, i.total_amount;']",23,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Find the total amount paid for each invoice, including invoice details.","{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT 
	i.invoice_id,
i.invoice_date,
	i.due_date,
	i.status,
p.amount as paid_amount
FROM 
	""invoice"" AS i
LEFT JOIN 
	""payment"" AS p ON i.invoice_id = p.invoice_id
GROUP BY 
	i.invoice_id, i.invoice_date, i.due_date, i.status
ORDER BY 
	i.invoice_id
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: easy', 'SELECT']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42P01', 'M': 'relation ""employee_jobchangecount"" does not exist', 'P': '257', 'F': 'parse_relation.c', 'L': '1452', 'R': 'parserOpenTable'}
[SQL: 
WITH EmployeeJobChangeCount AS (
SELECT e.employee_id, COUNT(*) AS total_job_changes
FROM employee e
LEFT JOIN job_history AS jh ON e.employee_id= jh.employee_id
GROUP BY
e.employee_id
)
SELECT e.first_name, e.employee_id, total_job_changes as count
FROM employee_jobchangecount
LEFT JOIN employee AS e 
ON employee_jobChangeCount . employee_id = e. employee_id 
ORDER BY total_job_changes desc;

]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Total job changes for all employees and the titles they have held, most job changes first.",[],"
WITH EmployeeJobChangeCount AS (
  SELECT e.employee_id, COUNT(*) AS total_job_changes
  FROM employee e
  LEFT JOIN job_history AS jh ON e.employee_id= jh.employee_id
GROUP BY
  e.employee_id
)
SELECT e.first_name, e.employee_id, total_job_changes as count
FROM employee_jobchangecount
LEFT JOIN employee AS e 
ON employee_jobChangeCount . employee_id = e  . employee_id 
ORDER BY total_job_changes desc;

```",,"[{'employee_id': 3536251, 'job_title': 'Software Engineer', 'total_job_changes': 2}, {'employee_id': 3536251, 'job_title': 'Financial Analyst', 'total_job_changes': 2}, {'employee_id': 3536252, 'job_title': 'Marketing Manager', 'total_job_changes': 1}, {'employee_id': 3536253, 'job_title': 'Sales Representative', 'total_job_changes': 1}, {'employee_id': 3536254, 'job_title': 'HR Specialist', 'total_job_changes': 1}, {'employee_id': 3536255, 'job_title': 'Financial Analyst', 'total_job_changes': 1}, {'employee_id': 3536256, 'job_title': 'Software Engineer', 'total_job_changes': 1}, {'employee_id': 3536257, 'job_title': 'Marketing Manager', 'total_job_changes': 1}, {'employee_id': 3536258, 'job_title': 'Sales Representative', 'total_job_changes': 1}, {'employee_id': 3536259, 'job_title': 'Financial Analyst', 'total_job_changes': 1}, {'employee_id': 3536260, 'job_title': 'HR Specialist', 'total_job_changes': 1}, {'employee_id': 3536261, 'job_title': 'Software Engineer', 'total_job_changes': 1}, {'employee_id': 3536262, 'job_title': 'Marketing Manager', 'total_job_changes': 1}, {'employee_id': 3536263, 'job_title': 'Sales Representative', 'total_job_changes': 1}, {'employee_id': 3536264, 'job_title': 'HR Specialist', 'total_job_changes': 1}, {'employee_id': 3536265, 'job_title': 'Financial Analyst', 'total_job_changes': 1}, {'employee_id': 3536266, 'job_title': 'Software Engineer', 'total_job_changes': 1}, {'employee_id': 3536267, 'job_title': 'Marketing Manager', 'total_job_changes': 1}, {'employee_id': 3536268, 'job_title': 'Sales Representative', 'total_job_changes': 1}, {'employee_id': 3536269, 'job_title': 'Financial Analyst', 'total_job_changes': 1}]","['WITH EmployeeJobChanges AS ( SELECT employee_id, COUNT(*) AS total_job_changes FROM job_history GROUP BY employee_id) SELECT jh.employee_id, ejc.total_job_changes, j.job_title FROM EmployeeJobChanges ejc JOIN employee e ON ejc.employee_id = e.employee_id JOIN job_history jh ON ejc.employee_id = jh.employee_id JOIN job j ON jh.job_id = j.job_id ;']",12,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Total job changes for all employees and the titles they have held, most job changes first.","{'Comment': '""Ambiguous when it comes to how to format the output.""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH EmployeeJobChangeCount AS (
SELECT e.employee_id, COUNT(*) AS total_job_changes
FROM employee e
LEFT JOIN job_history AS jh ON e.employee_id= jh.employee_id
GROUP BY
e.employee_id
)
SELECT e.first_name, e.employee_id, total_job_changes as count
FROM employee_jobchangecount
LEFT JOIN employee AS e 
ON employee_jobChangeCount . employee_id = e. employee_id 
ORDER BY total_job_changes desc;

",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'JOIN', 'AGGREGATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Could you provide a split of 5 age groups and the average salary for each group?","[{'age_group': '30 and below', 'avg_salary': '71000.000000000000'}]","
WITH age_groups AS (
  SELECT
    employee_id,
    CASE
      WHEN date_of_birth < TIMESTAMP '2018-04-26 00:00:00'
      THEN '30 and below'
      WHEN date_of_birth >= TIMESTAMP '2018-04-26 00:00:00' AND date_of_birth < TIMESTAMP '1993-04-26 00:00:00'
      THEN '31 to 40'
      WHEN date_of_birth >= TIMESTAMP '1993-04-26 00:00:00' AND date_of_birth < TIMESTAMP '1988-04-26 00:00:00'
      THEN '41 to 50'
      WHEN date_of_birth >= TIMESTAMP '1988-04-26 00:00:00' AND date_of_birth < TIMESTAMP '1978-04-26 00:00:00'
      THEN '51 to 60'
      ELSE 'Above 60'
    END AS age_group
  FROM employee
)
SELECT
  age_group,
  AVG(salary.salary) AS avg_salary
FROM age_groups
JOIN employee
  ON age_groups.employee_id = employee.employee_id
JOIN salary
  ON employee.employee_id = salary.employee_id
GROUP BY
  age_group
ORDER BY
  age_group;
```",,"[{'age_group': '18-30', 'avg_salary': '72500.000000000000'}, {'age_group': '31-40', 'avg_salary': '70833.333333333333'}]","[""WITH AgeGroups AS ( SELECT employee_id, FLOOR(EXTRACT(EPOCH FROM AGE(NOW(), date_of_birth)) / 31556952) AS age, salary FROM employee JOIN salary USING (employee_id) ) SELECT CASE WHEN age BETWEEN 18 AND 30 THEN '18-30' WHEN age BETWEEN 31 AND 40 THEN '31-40' WHEN age BETWEEN 41 AND 50 THEN '41-50' WHEN age BETWEEN 51 AND 60 THEN '51-60' ELSE 'Over 60' END AS age_group, AVG(salary) AS avg_salary FROM AgeGroups GROUP BY age_group ORDER BY MIN(age);""]",20,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Could you provide a split of 5 age groups and the average salary for each group?,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""Age groups: WHEN age BETWEEN 18 AND 30 THEN \'18-30\' WHEN age BETWEEN 31 AND 40 THEN \'31-40\' WHEN age BETWEEN 41 AND 50 THEN \'41-50\' WHEN age BETWEEN 51 AND 60 THEN \'51-60\' ELSE \'Over 60\'""'}",,dql,2025-02-10 18:36:22.083420,"
WITH age_groups AS (
SELECT
employee_id,
CASE
WHEN date_of_birth < TIMESTAMP '2018-04-26 00:00:00'
THEN '30 and below'
WHEN date_of_birth >= TIMESTAMP '2018-04-26 00:00:00' AND date_of_birth < TIMESTAMP '1993-04-26 00:00:00'
THEN '31 to 40'
WHEN date_of_birth >= TIMESTAMP '1993-04-26 00:00:00' AND date_of_birth < TIMESTAMP '1988-04-26 00:00:00'
THEN '41 to 50'
WHEN date_of_birth >= TIMESTAMP '1988-04-26 00:00:00' AND date_of_birth < TIMESTAMP '1978-04-26 00:00:00'
THEN '51 to 60'
ELSE 'Above 60'
END AS age_group
FROM employee
)
SELECT
age_group,
AVG(salary.salary) AS avg_salary
FROM age_groups
JOIN employee
ON age_groups.employee_id = employee.employee_id
JOIN salary
ON employee.employee_id = salary.employee_id
GROUP BY
age_group
ORDER BY
age_group;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'WITH', 'JOIN', 'AGGREGATE', 'SORT', 'DATE']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42703', 'M': 'column mtc.total_employees does not exist', 'H': 'Perhaps you meant to reference the column ""mec.total_employees"".', 'P': '721', 'F': 'parse_relation.c', 'L': '3738', 'R': 'errorMissingColumn'}
[SQL: 
WITH MonthlyEmployeeCount AS (
SELECT
EXTRACT(MONTH FROM h.start_date) AS month,
EXTRACT(YEAR FROM h.start_date) AS year,
COUNT(DISTINCT e.employee_id) AS total_employees
FROM employee AS e
JOIN job_history AS h ON e.employee_id = h.employee_id
GROUP BY EXTRACT(MONTH FROM h.start_date), EXTRACT(YEAR FROM h.start_date)
), MonthlyTerminationCount AS (
SELECT
EXTRACT(MONTH FROM t.termination_date) AS month,
EXTRACT(YEAR FROM t.termination_date) AS year,
COUNT(*) AS total_terminations
FROM employee_termination AS t
GROUP BY EXTRACT(MONTH FROM t.termination_date), EXTRACT(YEAR FROM t.termination_date)
), MonthlyTurnoverRate AS (
SELECT
mtc.month,
mtc.year,
(1.0 * mtc.total_terminations) / (mtc.total_terminations + mtc.total_employees) AS turnover_rate
FROM MonthlyTerminationCount AS mtc
JOIN MonthlyEmployeeCount AS mec ON mtc.month = mec.month AND mtc.year = mec.year
)
SELECT
d.department_id,
d.department_name,
AVG(mtr.turnover_rate) AS average_monthly_turnover
FROM MonthlyTurnoverRate AS mtr
JOIN job_history AS jh ON mtr.month = EXTRACT(MONTH FROM jh.start_date) AND mtr.year = EXTRACT(YEAR FROM jh.start_date)
JOIN department AS d ON jh.department_id = d.department_id
GROUP BY d.department_id, d.department_name
ORDER BY average_monthly_turnover DESC
LIMIT 1;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Which department has the highest overall employee turnover rate?",[],"
WITH MonthlyEmployeeCount AS (
    SELECT
        EXTRACT(MONTH FROM h.start_date) AS month,
        EXTRACT(YEAR FROM h.start_date) AS year,
        COUNT(DISTINCT e.employee_id) AS total_employees
    FROM employee AS e
    JOIN job_history AS h ON e.employee_id = h.employee_id
    GROUP BY EXTRACT(MONTH FROM h.start_date), EXTRACT(YEAR FROM h.start_date)
), MonthlyTerminationCount AS (
    SELECT
        EXTRACT(MONTH FROM t.termination_date) AS month,
        EXTRACT(YEAR FROM t.termination_date) AS year,
        COUNT(*) AS total_terminations
    FROM employee_termination AS t
    GROUP BY EXTRACT(MONTH FROM t.termination_date), EXTRACT(YEAR FROM t.termination_date)
), MonthlyTurnoverRate AS (
    SELECT
        mtc.month,
        mtc.year,
        (1.0 * mtc.total_terminations) / (mtc.total_terminations + mtc.total_employees) AS turnover_rate
    FROM MonthlyTerminationCount AS mtc
    JOIN MonthlyEmployeeCount AS mec ON mtc.month = mec.month AND mtc.year = mec.year
)
SELECT
    d.department_id,
    d.department_name,
    AVG(mtr.turnover_rate) AS average_monthly_turnover
FROM MonthlyTurnoverRate AS mtr
JOIN job_history AS jh ON mtr.month = EXTRACT(MONTH FROM jh.start_date) AND mtr.year = EXTRACT(YEAR FROM jh.start_date)
JOIN department AS d ON jh.department_id = d.department_id
GROUP BY d.department_id, d.department_name
ORDER BY average_monthly_turnover DESC
LIMIT 1;
```",,"[{'department_id': 2, 'terminated_employees': 1, 'total_employees': 7, 'turnover_rate': '0.14285714285714285714'}]","['WITH TurnoverRates AS ( SELECT department_id, COUNT(*) AS total_employees, SUM(CASE WHEN termination_date IS NOT NULL THEN 1 ELSE 0 END) AS terminated_employees, CAST(SUM(CASE WHEN termination_date IS NOT NULL THEN 1 ELSE 0 END) AS NUMERIC) / COUNT(*) AS turnover_rate FROM employee a LEFT JOIN employee_termination b ON a.employee_id = b.employee_id GROUP BY department_id ) SELECT * FROM TurnoverRates ORDER BY turnover_rate DESC LIMIT 1;']",10,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Which department has the highest overall employee turnover rate?,"{'Comment': '""LGTM. Somewhat ambiguous question given the lack of explicit dates.""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH MonthlyEmployeeCount AS (
SELECT
EXTRACT(MONTH FROM h.start_date) AS month,
EXTRACT(YEAR FROM h.start_date) AS year,
COUNT(DISTINCT e.employee_id) AS total_employees
FROM employee AS e
JOIN job_history AS h ON e.employee_id = h.employee_id
GROUP BY EXTRACT(MONTH FROM h.start_date), EXTRACT(YEAR FROM h.start_date)
), MonthlyTerminationCount AS (
SELECT
EXTRACT(MONTH FROM t.termination_date) AS month,
EXTRACT(YEAR FROM t.termination_date) AS year,
COUNT(*) AS total_terminations
FROM employee_termination AS t
GROUP BY EXTRACT(MONTH FROM t.termination_date), EXTRACT(YEAR FROM t.termination_date)
), MonthlyTurnoverRate AS (
SELECT
mtc.month,
mtc.year,
(1.0 * mtc.total_terminations) / (mtc.total_terminations + mtc.total_employees) AS turnover_rate
FROM MonthlyTerminationCount AS mtc
JOIN MonthlyEmployeeCount AS mec ON mtc.month = mec.month AND mtc.year = mec.year
)
SELECT
d.department_id,
d.department_name,
AVG(mtr.turnover_rate) AS average_monthly_turnover
FROM MonthlyTurnoverRate AS mtr
JOIN job_history AS jh ON mtr.month = EXTRACT(MONTH FROM jh.start_date) AND mtr.year = EXTRACT(YEAR FROM jh.start_date)
JOIN department AS d ON jh.department_id = d.department_id
GROUP BY d.department_id, d.department_name
ORDER BY average_monthly_turnover DESC
LIMIT 1;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'AGGREGATE', 'SORT', 'LIMIT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find the number of vacancies available for each job title in the company.",[],"
SELECT
  jobs.job_title,
  COUNT(jobs.job_title) AS number_of_vacancies
FROM job AS jobs
WHERE
  jobs.status = 'Open'
GROUP BY
  jobs.job_title
ORDER BY
  number_of_vacancies DESC;
```",,"[{'job_title': 'Web Developer', 'vacancies': 1}, {'job_title': 'Legal Assistant', 'vacancies': 1}, {'job_title': 'Content Writer', 'vacancies': 1}, {'job_title': 'Financial Analyst', 'vacancies': 1}, {'job_title': 'Accountant', 'vacancies': 1}, {'job_title': 'Network Administrator', 'vacancies': 1}, {'job_title': 'Quality Assurance Analyst', 'vacancies': 1}, {'job_title': 'Data Analyst', 'vacancies': 1}, {'job_title': 'Human Resources Manager', 'vacancies': 1}, {'job_title': 'Customer Service Representative', 'vacancies': 1}, {'job_title': 'HR Specialist', 'vacancies': 1}, {'job_title': 'Marketing Manager', 'vacancies': 1}, {'job_title': 'Technical Support Specialist', 'vacancies': 1}, {'job_title': 'Software Engineer', 'vacancies': 1}, {'job_title': 'Project Manager', 'vacancies': 1}, {'job_title': 'IT Support Specialist', 'vacancies': 1}, {'job_title': 'Sales Representative', 'vacancies': 1}, {'job_title': 'Administrative Assistant', 'vacancies': 1}, {'job_title': 'Business Analyst', 'vacancies': 1}, {'job_title': 'Graphic Designer', 'vacancies': 1}]","['SELECT job_title, COUNT(*) AS vacancies FROM job GROUP BY job_title;']",85,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Find the number of vacancies available for each job title in the company.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
jobs.job_title,
COUNT(jobs.job_title) AS number_of_vacancies
FROM job AS jobs
WHERE
jobs.status = 'Open'
GROUP BY
jobs.job_title
ORDER BY
number_of_vacancies DESC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'AGGREGATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List all clients and company name of the companies operating in the healthcare industry.","[{'client_name': None, 'clients': ['Client L'], 'company_name': 'LMN Corporation'}, {'client_name': None, 'clients': ['Client L'], 'company_name': 'LMN Corporation'}]","
SELECT clients, clients->'client_name' AS client_name, ""company_name""
FROM company
WHERE ""industry"" = 'Healthcare';
```",,"[{'clients': ['Client L'], 'company_name': 'LMN Corporation'}, {'clients': ['Client L'], 'company_name': 'LMN Corporation'}]","[""SELECT company_name, clients FROM company WHERE industry = 'Healthcare';""]",82,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,List all clients and company name of the companies operating in the healthcare industry.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""industry = \'Healthcare\'""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT clients, clients->'client_name' AS client_name, ""company_name""
FROM company
WHERE ""industry"" = 'Healthcare';
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'Data Linking']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find the employees who have received bonuses exceeding $5000 in the last quarter of 2023, along with the total bonus amount received by each employee.",[],"
-- Selecting employee first and last names
SELECT
    e.""first_name"",
    e.""last_name"",
    SUM(s.""bonus"") AS ""total_bonus""
-- Joining the ""employee"" and ""salary"" tables on ""employee_id""
FROM
    ""employee"" AS e
JOIN
    ""salary"" AS s
ON
    e.""employee_id"" = s.""employee_id""
WHERE
    -- Filtering for salaries in the last quarter of 2023
    s.""start_date"" >= '2023-10-01' AND s.""end_date"" <= '2023-12-31'
    -- Filtering for bonuses greater than $5000
    AND s.""bonus"" > 5000
-- Grouping by employee first and last names to get total bonuses for each employee
GROUP BY
    e.""first_name"",
    e.""last_name""
-- Ordering the results in descending order of total bonuses
ORDER BY
    ""total_bonus"" DESC;
```",,"[{'employee_id': 3536261, 'total_bonus_amount': '7000.00'}, {'employee_id': 3536262, 'total_bonus_amount': '5500.00'}]","[""SELECT e.employee_id, SUM(bonus) AS total_bonus_amount FROM employee e JOIN salary s ON e.employee_id = s.employee_id WHERE s.start_date >= '2023-10-01' AND s.start_date <= '2023-12-31' AND bonus > 5000 GROUP BY e.employee_id;""]",45,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Find the employees who have received bonuses exceeding $5000 in the last quarter of 2023, along with the total bonus amount received by each employee.","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
-- Selecting employee first and last names
SELECT
e.""first_name"",
e.""last_name"",
SUM(s.""bonus"") AS ""total_bonus""
-- Joining the ""employee"" and ""salary"" tables on ""employee_id""
FROM
""employee"" AS e
JOIN
""salary"" AS s
ON
e.""employee_id"" = s.""employee_id""
WHERE
-- Filtering for salaries in the last quarter of 2023
s.""start_date"" >= '2023-10-01' AND s.""end_date"" <= '2023-12-31'
-- Filtering for bonuses greater than $5000
AND s.""bonus"" > 5000
-- Grouping by employee first and last names to get total bonuses for each employee
GROUP BY
e.""first_name"",
e.""last_name""
-- Ordering the results in descending order of total bonuses
ORDER BY
""total_bonus"" DESC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'AGGREGATE', 'DATE']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42703', 'M': 'column ""address"" does not exist', 'P': '570', 'F': 'parse_relation.c', 'L': '3727', 'R': 'errorMissingColumn'}
[SQL: 
WITH EligibleEmployees AS (
SELECT
e.employee_id,
e.first_name,
e.last_name,
j.job_title,
d.department_name
FROM employee AS e
JOIN job AS j
ON e.job_id = j.job_id
JOIN department AS d
ON e.department_id = d.department_id
LEFT JOIN salary AS s
ON e.employee_id = s.employee_id
LEFT JOIN employee_x_benefit AS exb
ON e.employee_id = exb.employee_id
LEFT JOIN benefit AS b
ON exb.benefit_id = b.benefit_id
WHERE
b.benefit_name = 'Health Insurance' AND (
s.start_date <= now() OR s.end_date IS NULL
)
), DependentsCoverage AS (
SELECT
e.employee_id,
jsonb_array_elements(address -> 'dependents') AS dependent_info
FROM EligibleEmployees AS e
)
SELECT
ee.first_name,
ee.last_name,
ee.department_name,
ee.job_title,
dc.dependent_info ->> 'name' AS dependent_name,
dc.dependent_info ->> 'coverage' AS dependent_coverage,
b.provider AS insurance_provider,
b.contact_info AS insurance_contact_info
FROM EligibleEmployees AS ee
JOIN DependentsCoverage AS dc
ON ee.employee_id = dc.employee_id
LEFT JOIN employee_x_benefit AS exb
ON ee.employee_id = exb.employee_id
LEFT JOIN benefit AS b
ON exb.benefit_id = b.benefit_id
WHERE
b.benefit_name = 'Health Insurance' AND (
dc.dependent_info ->> 'coverage' = 'Covered' OR dc.dependent_info ->> 'coverage' IS NULL
);
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List all employees eligible for health insurance benefits, including their dependents coverage status and contact information for insurance providers",[],"
WITH EligibleEmployees AS (
  SELECT
    e.employee_id,
    e.first_name,
    e.last_name,
    j.job_title,
    d.department_name
  FROM employee AS e
  JOIN job AS j
    ON e.job_id = j.job_id
  JOIN department AS d
    ON e.department_id = d.department_id
  LEFT JOIN salary AS s
    ON e.employee_id = s.employee_id
  LEFT JOIN employee_x_benefit AS exb
    ON e.employee_id = exb.employee_id
  LEFT JOIN benefit AS b
    ON exb.benefit_id = b.benefit_id
  WHERE
    b.benefit_name = 'Health Insurance' AND (
      s.start_date <= now() OR s.end_date IS NULL
    )
), DependentsCoverage AS (
  SELECT
    e.employee_id,
    jsonb_array_elements(address -> 'dependents') AS dependent_info
  FROM EligibleEmployees AS e
)
SELECT
  ee.first_name,
  ee.last_name,
  ee.department_name,
  ee.job_title,
  dc.dependent_info ->> 'name' AS dependent_name,
  dc.dependent_info ->> 'coverage' AS dependent_coverage,
  b.provider AS insurance_provider,
  b.contact_info AS insurance_contact_info
FROM EligibleEmployees AS ee
JOIN DependentsCoverage AS dc
  ON ee.employee_id = dc.employee_id
LEFT JOIN employee_x_benefit AS exb
  ON ee.employee_id = exb.employee_id
LEFT JOIN benefit AS b
  ON exb.benefit_id = b.benefit_id
WHERE
  b.benefit_name = 'Health Insurance' AND (
    dc.dependent_info ->> 'coverage' = 'Covered' OR dc.dependent_info ->> 'coverage' IS NULL
  );
```",,"[{'benefit_description': 'Comprehensive health coverage for employees and their families.', 'benefit_name': 'Health Insurance', 'coverage': 'Medical, Dental, Vision', 'dependents': None, 'email': 'john.doe@example.com', 'employee_id': 3536251, 'end_date': '2022-12-31', 'first_name': 'John', 'insurance_provider': 'ABC Insurance Company', 'last_name': 'Doe', 'start_date': '2022-01-01'}]","[""SELECT e.employee_id, e.first_name, e.last_name, e.email, eb.start_date, eb.end_date, b.benefit_name, b.description AS benefit_description, b.coverage, b.provider AS insurance_provider, e.address ->> '$.dependents' AS dependents FROM employee e JOIN employee_x_benefit eb ON e.employee_id = eb.employee_id JOIN benefit b ON eb.benefit_id = b.benefit_id WHERE b.benefit_name = 'Health Insurance';""]",107,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"List all employees eligible for health insurance benefits, including their dependents coverage status and contact information for insurance providers","{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH EligibleEmployees AS (
SELECT
e.employee_id,
e.first_name,
e.last_name,
j.job_title,
d.department_name
FROM employee AS e
JOIN job AS j
ON e.job_id = j.job_id
JOIN department AS d
ON e.department_id = d.department_id
LEFT JOIN salary AS s
ON e.employee_id = s.employee_id
LEFT JOIN employee_x_benefit AS exb
ON e.employee_id = exb.employee_id
LEFT JOIN benefit AS b
ON exb.benefit_id = b.benefit_id
WHERE
b.benefit_name = 'Health Insurance' AND (
s.start_date <= now() OR s.end_date IS NULL
)
), DependentsCoverage AS (
SELECT
e.employee_id,
jsonb_array_elements(address -> 'dependents') AS dependent_info
FROM EligibleEmployees AS e
)
SELECT
ee.first_name,
ee.last_name,
ee.department_name,
ee.job_title,
dc.dependent_info ->> 'name' AS dependent_name,
dc.dependent_info ->> 'coverage' AS dependent_coverage,
b.provider AS insurance_provider,
b.contact_info AS insurance_contact_info
FROM EligibleEmployees AS ee
JOIN DependentsCoverage AS dc
ON ee.employee_id = dc.employee_id
LEFT JOIN employee_x_benefit AS exb
ON ee.employee_id = exb.employee_id
LEFT JOIN benefit AS b
ON exb.benefit_id = b.benefit_id
WHERE
b.benefit_name = 'Health Insurance' AND (
dc.dependent_info ->> 'coverage' = 'Covered' OR dc.dependent_info ->> 'coverage' IS NULL
);
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'JOIN']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42703', 'M': 'column s.department_id does not exist', 'H': 'Perhaps you meant to reference the column ""d.department_id"".', 'P': '186', 'F': 'parse_relation.c', 'L': '3738', 'R': 'errorMissingColumn'}
[SQL: 
SELECT 
d.""department_name"", 
SUM(s.""bonus"" + s.""salary"" + s.""deductions"" + s.""taxes"") AS ""Total Salary Expenditure""
FROM 
""department"" d
JOIN 
""salary"" s ON d.""department_id"" = s.""department_id""
WHERE 
s.""end_date"" >= (SELECT ""financial_year_end"" FROM ""company"" WHERE ""company_id"" = 1) AND s.""start_date"" < (SELECT ""financial_year_end"" FROM ""company"" WHERE ""company_id"" = 1) + INTERVAL '1 year'
GROUP BY 
d.""department_name""
ORDER BY 
""Total Salary Expenditure"" DESC;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Total salary expenditure for each department in the current financial year, including bonuses, taxes, and deductions",[],"
SELECT 
    d.""department_name"", 
    SUM(s.""bonus"" + s.""salary"" + s.""deductions"" + s.""taxes"") AS ""Total Salary Expenditure""
FROM 
    ""department"" d
JOIN 
    ""salary"" s ON d.""department_id"" = s.""department_id""
WHERE 
    s.""end_date"" >= (SELECT ""financial_year_end"" FROM ""company"" WHERE ""company_id"" = 1) AND s.""start_date"" < (SELECT ""financial_year_end"" FROM ""company"" WHERE ""company_id"" = 1) + INTERVAL '1 year'
GROUP BY 
    d.""department_name""
ORDER BY 
    ""Total Salary Expenditure"" DESC;
```",,"[{'department_name': 'Finance', 'total_salary_expenditure': '250300.00'}, {'department_name': 'Human Resources', 'total_salary_expenditure': '224200.00'}, {'department_name': 'Marketing', 'total_salary_expenditure': '246300.00'}]","[""SELECT d.department_name, SUM(s.salary + s.bonus - s.taxes - s.deductions) AS total_salary_expenditure FROM department d JOIN employee e ON d.department_id = e.department_id JOIN salary s ON e.employee_id = s.employee_id AND s.start_date BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY d.department_name;""]",105,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Total salary expenditure for each department in the current financial year, including bonuses, taxes, and deductions","{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT 
d.""department_name"", 
SUM(s.""bonus"" + s.""salary"" + s.""deductions"" + s.""taxes"") AS ""Total Salary Expenditure""
FROM 
""department"" d
JOIN 
""salary"" s ON d.""department_id"" = s.""department_id""
WHERE 
s.""end_date"" >= (SELECT ""financial_year_end"" FROM ""company"" WHERE ""company_id"" = 1) AND s.""start_date"" < (SELECT ""financial_year_end"" FROM ""company"" WHERE ""company_id"" = 1) + INTERVAL '1 year'
GROUP BY 
d.""department_name""
ORDER BY 
""Total Salary Expenditure"" DESC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'AGGREGATE', 'JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List all employees id who have traveled to the ""New York"" location for business purposes in the year of 2023, along with their travel expenses.",[],"
SELECT et.""employee_id"", et.""travel_expenses""
FROM ""employee_travel"" et
JOIN ""employee"" e ON et.""employee_id"" = e.""employee_id""
WHERE et.""travel_destination"" = 'New York' and et.""travel_purpose"" = 'business' AND et.""travel_start_date"" BETWEEN '2023-01-01' AND '2023-12-31'
ORDER BY et.""employee_id"" NULLS LAST;
```",,"[{'employee_id': 3536251, 'travel_expenses': '1200.50'}]","[""SELECT e.employee_id, t.travel_expenses FROM employee e JOIN employee_travel t ON e.employee_id = t.employee_id WHERE t.travel_destination LIKE '%New York%' AND t.travel_start_date >= '2023-01-01'AND t.travel_end_date <= '2023-12-31';""]",66,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"List all employees id who have traveled to the ""New York"" location for business purposes in the year of 2023, along with their travel expenses.","{'Comment': '""LGTM, fixing the year due to the static nature of our database""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""travel_destination LIKE \'%New York%\'""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT et.""employee_id"", et.""travel_expenses""
FROM ""employee_travel"" et
JOIN ""employee"" e ON et.""employee_id"" = e.""employee_id""
WHERE et.""travel_destination"" = 'New York' and et.""travel_purpose"" = 'business' AND et.""travel_start_date"" BETWEEN '2023-01-01' AND '2023-12-31'
ORDER BY et.""employee_id"" NULLS LAST;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'JOIN', 'DATE', 'BETWEEN', 'time']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42803', 'M': 'column ""d.department_name"" must appear in the GROUP BY clause or be used in an aggregate function', 'P': '58', 'F': 'parse_agg.c', 'L': '1444', 'R': 'check_ungrouped_columns_walker'}
[SQL: 
SELECT
SUM(total_compensation) AS ""Total Compensation"",
d.department_name AS ""Department""
FROM salary AS s
JOIN employee AS e
ON s.employee_id = e.employee_id
JOIN department AS d
ON e.department_id = d.department_id
GROUP BY
e.department_id;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


What is the total cost of salaries for all employees in each department?",[],"
SELECT
  SUM(total_compensation) AS ""Total Compensation"",
  d.department_name AS ""Department""
FROM salary AS s
JOIN employee AS e
  ON s.employee_id = e.employee_id
JOIN department AS d
  ON e.department_id = d.department_id
GROUP BY
  e.department_id;
```",,"[{'department_id': 3, 'department_name': 'Finance', 'total_salary_cost': '440000.00'}, {'department_id': 1, 'department_name': 'Human Resources', 'total_salary_cost': '465000.00'}, {'department_id': 2, 'department_name': 'Marketing', 'total_salary_cost': '515000.00'}]","['SELECT d.department_id, d.department_name, SUM(s.salary) AS total_salary_cost FROM salary s JOIN employee e ON s.employee_id = e.employee_id JOIN department d ON e.department_id = d.department_id GROUP BY d.department_id, d.department_name;']",16,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,What is the total cost of salaries for all employees in each department?,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
SUM(total_compensation) AS ""Total Compensation"",
d.department_name AS ""Department""
FROM salary AS s
JOIN employee AS e
ON s.employee_id = e.employee_id
JOIN department AS d
ON e.department_id = d.department_id
GROUP BY
e.department_id;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the list of employees id who have been enrolled in benefits with their benefit name, start and end dates","[{'benefit_name': 'Health Insurance', 'employee_id': 3536251, 'end_date': '2022-12-31', 'start_date': '2022-01-01'}, {'benefit_name': '401(k) Matching', 'employee_id': 3536252, 'end_date': '2022-12-31', 'start_date': '2022-02-01'}, {'benefit_name': 'Paid Time Off (PTO)', 'employee_id': 3536253, 'end_date': '2022-12-31', 'start_date': '2022-03-01'}, {'benefit_name': 'Employee Assistance Program (EAP)', 'employee_id': 3536254, 'end_date': '2022-12-31', 'start_date': '2022-04-01'}, {'benefit_name': 'Tuition Reimbursement', 'employee_id': 3536255, 'end_date': '2022-12-31', 'start_date': '2022-05-01'}, {'benefit_name': 'Flexible Spending Account (FSA)', 'employee_id': 3536256, 'end_date': '2022-12-31', 'start_date': '2022-06-01'}, {'benefit_name': 'Wellness Program', 'employee_id': 3536257, 'end_date': '2022-12-31', 'start_date': '2022-07-01'}, {'benefit_name': 'Life Insurance', 'employee_id': 3536258, 'end_date': '2022-12-31', 'start_date': '2022-08-01'}, {'benefit_name': 'Professional Development', 'employee_id': 3536259, 'end_date': '2022-12-31', 'start_date': '2022-09-01'}, {'benefit_name': 'Employee Discounts', 'employee_id': 3536260, 'end_date': '2022-12-31', 'start_date': '2022-10-01'}, {'benefit_name': 'Vision Care', 'employee_id': 3536261, 'end_date': '2022-12-31', 'start_date': '2022-11-01'}, {'benefit_name': 'Legal Assistance', 'employee_id': 3536262, 'end_date': '2022-12-31', 'start_date': '2022-12-01'}, {'benefit_name': 'Employee Referral Program', 'employee_id': 3536263, 'end_date': '2022-12-31', 'start_date': '2022-01-15'}, {'benefit_name': 'Travel Assistance', 'employee_id': 3536264, 'end_date': '2022-12-31', 'start_date': '2022-02-15'}, {'benefit_name': 'Child Care Assistance', 'employee_id': 3536265, 'end_date': '2022-12-31', 'start_date': '2022-03-15'}, {'benefit_name': 'Stock Options', 'employee_id': 3536266, 'end_date': '2022-12-31', 'start_date': '2022-04-15'}, {'benefit_name': 'Employee Recognition Program', 'employee_id': 3536267, 'end_date': '2022-12-31', 'start_date': '2022-05-15'}, {'benefit_name': 'Mobile Phone Allowance', 'employee_id': 3536268, 'end_date': '2022-12-31', 'start_date': '2022-06-15'}, {'benefit_name': 'On-site Gym Membership', 'employee_id': 3536269, 'end_date': '2022-12-31', 'start_date': '2022-07-15'}, {'benefit_name': 'Pet Insurance', 'employee_id': 3536270, 'end_date': '2022-12-31', 'start_date': '2022-08-15'}]","
-- Select the employee ID, benefit name, start date, and end date
SELECT
  e.""employee_id"",
  b.""benefit_name"",
  exb.""start_date"",
  exb.""end_date""
-- From the ""employee"" table (aliased as ""e"")
FROM ""employee"" AS e
-- Join with the ""employee_x_benefit"" table (aliased as ""exb"") on the employee ID
INNER JOIN ""employee_x_benefit"" AS exb
  ON e.""employee_id"" = exb.""employee_id""
-- Join with the ""benefit"" table (aliased as ""b"") on the benefit ID
INNER JOIN ""benefit"" AS b
  ON exb.""benefit_id"" = b.""benefit_id"";
```",,"[{'benefit_name': 'Health Insurance', 'employee_id': 3536251, 'end_date': '2022-12-31', 'start_date': '2022-01-01'}, {'benefit_name': '401(k) Matching', 'employee_id': 3536252, 'end_date': '2022-12-31', 'start_date': '2022-02-01'}, {'benefit_name': 'Paid Time Off (PTO)', 'employee_id': 3536253, 'end_date': '2022-12-31', 'start_date': '2022-03-01'}, {'benefit_name': 'Employee Assistance Program (EAP)', 'employee_id': 3536254, 'end_date': '2022-12-31', 'start_date': '2022-04-01'}, {'benefit_name': 'Tuition Reimbursement', 'employee_id': 3536255, 'end_date': '2022-12-31', 'start_date': '2022-05-01'}, {'benefit_name': 'Flexible Spending Account (FSA)', 'employee_id': 3536256, 'end_date': '2022-12-31', 'start_date': '2022-06-01'}, {'benefit_name': 'Wellness Program', 'employee_id': 3536257, 'end_date': '2022-12-31', 'start_date': '2022-07-01'}, {'benefit_name': 'Life Insurance', 'employee_id': 3536258, 'end_date': '2022-12-31', 'start_date': '2022-08-01'}, {'benefit_name': 'Professional Development', 'employee_id': 3536259, 'end_date': '2022-12-31', 'start_date': '2022-09-01'}, {'benefit_name': 'Employee Discounts', 'employee_id': 3536260, 'end_date': '2022-12-31', 'start_date': '2022-10-01'}, {'benefit_name': 'Vision Care', 'employee_id': 3536261, 'end_date': '2022-12-31', 'start_date': '2022-11-01'}, {'benefit_name': 'Legal Assistance', 'employee_id': 3536262, 'end_date': '2022-12-31', 'start_date': '2022-12-01'}, {'benefit_name': 'Employee Referral Program', 'employee_id': 3536263, 'end_date': '2022-12-31', 'start_date': '2022-01-15'}, {'benefit_name': 'Travel Assistance', 'employee_id': 3536264, 'end_date': '2022-12-31', 'start_date': '2022-02-15'}, {'benefit_name': 'Child Care Assistance', 'employee_id': 3536265, 'end_date': '2022-12-31', 'start_date': '2022-03-15'}, {'benefit_name': 'Stock Options', 'employee_id': 3536266, 'end_date': '2022-12-31', 'start_date': '2022-04-15'}, {'benefit_name': 'Employee Recognition Program', 'employee_id': 3536267, 'end_date': '2022-12-31', 'start_date': '2022-05-15'}, {'benefit_name': 'Mobile Phone Allowance', 'employee_id': 3536268, 'end_date': '2022-12-31', 'start_date': '2022-06-15'}, {'benefit_name': 'On-site Gym Membership', 'employee_id': 3536269, 'end_date': '2022-12-31', 'start_date': '2022-07-15'}, {'benefit_name': 'Pet Insurance', 'employee_id': 3536270, 'end_date': '2022-12-31', 'start_date': '2022-08-15'}]","['SELECT e.employee_id, b.benefit_name, eb.start_date, eb.end_date FROM employee e JOIN employee_x_benefit eb ON e.employee_id = eb.employee_id JOIN benefit b ON eb.benefit_id = b.benefit_id;']",95,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Retrieve the list of employees id who have been enrolled in benefits with their benefit name, start and end dates","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
-- Select the employee ID, benefit name, start date, and end date
SELECT
e.""employee_id"",
b.""benefit_name"",
exb.""start_date"",
exb.""end_date""
-- From the ""employee"" table (aliased as ""e"")
FROM ""employee"" AS e
-- Join with the ""employee_x_benefit"" table (aliased as ""exb"") on the employee ID
INNER JOIN ""employee_x_benefit"" AS exb
ON e.""employee_id"" = exb.""employee_id""
-- Join with the ""benefit"" table (aliased as ""b"") on the benefit ID
INNER JOIN ""benefit"" AS b
ON exb.""benefit_id"" = b.""benefit_id"";
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find the employee who has completed the highest number of performance reviews as a reviewer in the year 2023, along with the average performance rating given by them.","[{'avg_rating': '4.1500000000000000', 'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe', 'total_reviews': 2}]","
SELECT
  ""emp"".""employee_id"",
  ""emp"".""first_name"",
  ""emp"".""last_name"",
  COUNT(""pr"".""review_id"") AS ""total_reviews"",
  AVG(""pr"".""performance_rating"") AS ""avg_rating""
FROM ""employee"" AS ""emp""
JOIN ""performance_review"" AS ""pr""
  ON ""emp"".""employee_id"" = ""pr"".""reviewer_id""
WHERE
  ""pr"".""review_date"" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY
  ""emp"".""employee_id"",
  ""emp"".""first_name"",
  ""emp"".""last_name""
ORDER BY
  ""total_reviews"" DESC
LIMIT 1;
```",,"[{'avg_performance_rating': '4.5000000000000000', 'employee_id': 3536251}]","[""SELECT employee_id, AVG(performance_rating) AS avg_performance_rating FROM performance_review WHERE review_date >= '2023-01-01' AND review_date <= '2023-12-31' GROUP BY employee_id ORDER BY COUNT(review_id) DESC LIMIT 1;""]",54,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Find the employee who has completed the highest number of performance reviews as a reviewer in the year 2023, along with the average performance rating given by them.","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
""emp"".""employee_id"",
""emp"".""first_name"",
""emp"".""last_name"",
COUNT(""pr"".""review_id"") AS ""total_reviews"",
AVG(""pr"".""performance_rating"") AS ""avg_rating""
FROM ""employee"" AS ""emp""
JOIN ""performance_review"" AS ""pr""
ON ""emp"".""employee_id"" = ""pr"".""reviewer_id""
WHERE
""pr"".""review_date"" BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY
""emp"".""employee_id"",
""emp"".""first_name"",
""emp"".""last_name""
ORDER BY
""total_reviews"" DESC
LIMIT 1;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'DATE', 'LIMIT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Determine the top three employees id and name with the highest total business expenses in the last quarter of 2023, considering expenses across all categories.","[{'employee_id': 3536260, 'employee_name': 'Taylor Rodriguez', 'total_business_expenses': '300.00'}, {'employee_id': 3536252, 'employee_name': 'Alice Smith', 'total_business_expenses': '90.00'}, {'employee_id': 3536251, 'employee_name': 'John Doe', 'total_business_expenses': '40.00'}]","
WITH EmployeeBusinessExpenseTotal AS (
  SELECT
    e.employee_id,
    e.first_name || ' ' || e.last_name AS employee_name,
    SUM(eb.expense_amount) AS total_business_expenses
  FROM employee AS e
  JOIN employee_business_expense AS eb
    ON e.employee_id = eb.employee_id
  WHERE
    eb.expense_date >= '2023-10-01' AND eb.expense_date <= '2023-12-31'
  GROUP BY
    e.employee_id,
    e.first_name,
    e.last_name
)
SELECT
  employee_id,
  employee_name,
  total_business_expenses
FROM EmployeeBusinessExpenseTotal
ORDER BY
  total_business_expenses DESC
LIMIT 3;
```",,"[{'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe', 'total_business_expenses': '40.00'}, {'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith', 'total_business_expenses': '90.00'}, {'employee_id': 3536260, 'first_name': 'Taylor', 'last_name': 'Rodriguez', 'total_business_expenses': '300.00'}]","[""SELECT e.employee_id, e.first_name, e.last_name, SUM(ebe.expense_amount) AS total_business_expenses FROM employee e JOIN employee_business_expense ebe ON e.employee_id = ebe.employee_id WHERE ebe.expense_date BETWEEN DATE('2023-12-31') - INTERVAL '3 MONTH' AND DATE('2023-12-31') GROUP BY e.employee_id, e.first_name, e.last_name HAVING SUM(ebe.expense_amount) >= ( SELECT total_business_expenses from ( SELECT e.employee_id, e.first_name, e.last_name, SUM(ebe.expense_amount) AS total_business_expenses FROM employee e JOIN employee_business_expense ebe ON e.employee_id = ebe.employee_id WHERE ebe.expense_date BETWEEN DATE('2023-12-31') - INTERVAL '3 MONTH' AND DATE('2023-12-31') GROUP BY e.employee_id, e.first_name, e.last_name ORDER BY total_business_expenses DESC LIMIT 1 OFFSET 2) as tmp) ORDER BY total_business_expenses""]",80,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Determine the top three employees id and name with the highest total business expenses in the last quarter of 2023, considering expenses across all categories.","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH EmployeeBusinessExpenseTotal AS (
SELECT
e.employee_id,
e.first_name || ' ' || e.last_name AS employee_name,
SUM(eb.expense_amount) AS total_business_expenses
FROM employee AS e
JOIN employee_business_expense AS eb
ON e.employee_id = eb.employee_id
WHERE
eb.expense_date >= '2023-10-01' AND eb.expense_date <= '2023-12-31'
GROUP BY
e.employee_id,
e.first_name,
e.last_name
)
SELECT
employee_id,
employee_name,
total_business_expenses
FROM EmployeeBusinessExpenseTotal
ORDER BY
total_business_expenses DESC
LIMIT 3;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'AGGREGATE', 'DATE', 'LIMIT', 'INTERVAL', 'time', 'SORT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Rank departments based on their budget in descending order.","[{'budget': '300000.00', 'department_id': 12, 'department_name': 'Production'}, {'budget': '280000.00', 'department_id': 17, 'department_name': 'Engineering'}, {'budget': '250000.00', 'department_id': 8, 'department_name': 'Research and Development'}, {'budget': '220000.00', 'department_id': 5, 'department_name': 'IT'}, {'budget': '200000.00', 'department_id': 3, 'department_name': 'Finance'}, {'budget': '200000.00', 'department_id': 18, 'department_name': 'Logistics'}, {'budget': '190000.00', 'department_id': 10, 'department_name': 'Legal'}, {'budget': '180000.00', 'department_id': 4, 'department_name': 'Sales'}, {'budget': '180000.00', 'department_id': 13, 'department_name': 'Supply Chain'}, {'budget': '170000.00', 'department_id': 16, 'department_name': 'Customer Success'}, {'budget': '160000.00', 'department_id': 20, 'department_name': 'Product Management'}, {'budget': '160000.00', 'department_id': 6, 'department_name': 'Operations'}, {'budget': '150000.00', 'department_id': 2, 'department_name': 'Marketing'}, {'budget': '150000.00', 'department_id': 15, 'department_name': 'Safety and Compliance'}, {'budget': '130000.00', 'department_id': 9, 'department_name': 'Quality Assurance'}, {'budget': '130000.00', 'department_id': 19, 'department_name': 'Public Relations'}, {'budget': '120000.00', 'department_id': 11, 'department_name': 'Administration'}, {'budget': '120000.00', 'department_id': 7, 'department_name': 'Customer Service'}, {'budget': '100000.00', 'department_id': 14, 'department_name': 'Training and Development'}, {'budget': '100000.00', 'department_id': 1, 'department_name': 'Human Resources'}]","
SELECT
    department_id,
    department_name,
    budget
FROM
    ""department""
ORDER BY
    budget DESC;
```",,"[{'budget': '300000.00', 'budget_rank': 1, 'department_id': 12, 'department_name': 'Production'}, {'budget': '280000.00', 'budget_rank': 2, 'department_id': 17, 'department_name': 'Engineering'}, {'budget': '250000.00', 'budget_rank': 3, 'department_id': 8, 'department_name': 'Research and Development'}, {'budget': '220000.00', 'budget_rank': 4, 'department_id': 5, 'department_name': 'IT'}, {'budget': '200000.00', 'budget_rank': 5, 'department_id': 3, 'department_name': 'Finance'}, {'budget': '200000.00', 'budget_rank': 5, 'department_id': 18, 'department_name': 'Logistics'}, {'budget': '190000.00', 'budget_rank': 7, 'department_id': 10, 'department_name': 'Legal'}, {'budget': '180000.00', 'budget_rank': 8, 'department_id': 4, 'department_name': 'Sales'}, {'budget': '180000.00', 'budget_rank': 8, 'department_id': 13, 'department_name': 'Supply Chain'}, {'budget': '170000.00', 'budget_rank': 10, 'department_id': 16, 'department_name': 'Customer Success'}, {'budget': '160000.00', 'budget_rank': 11, 'department_id': 20, 'department_name': 'Product Management'}, {'budget': '160000.00', 'budget_rank': 11, 'department_id': 6, 'department_name': 'Operations'}, {'budget': '150000.00', 'budget_rank': 13, 'department_id': 2, 'department_name': 'Marketing'}, {'budget': '150000.00', 'budget_rank': 13, 'department_id': 15, 'department_name': 'Safety and Compliance'}, {'budget': '130000.00', 'budget_rank': 15, 'department_id': 9, 'department_name': 'Quality Assurance'}, {'budget': '130000.00', 'budget_rank': 15, 'department_id': 19, 'department_name': 'Public Relations'}, {'budget': '120000.00', 'budget_rank': 17, 'department_id': 11, 'department_name': 'Administration'}, {'budget': '120000.00', 'budget_rank': 17, 'department_id': 7, 'department_name': 'Customer Service'}, {'budget': '100000.00', 'budget_rank': 19, 'department_id': 14, 'department_name': 'Training and Development'}, {'budget': '100000.00', 'budget_rank': 19, 'department_id': 1, 'department_name': 'Human Resources'}]","['SELECT department_id, department_name, budget, RANK() OVER (ORDER BY budget DESC) AS budget_rank FROM department;']",138,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Rank departments based on their budget in descending order.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
department_id,
department_name,
budget
FROM
""department""
ORDER BY
budget DESC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'RANK']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the names and contact information of employees who joined the company in the last six months of 2023.",[],"
SELECT e.""first_name"", e.""last_name"", e.""email"", e.""phone_number""
FROM ""employee"" AS e
JOIN ""job_history"" AS jh ON e.""employee_id"" = jh.""employee_id""
WHERE jh.""start_date"" BETWEEN '2023-07-01' AND '2023-12-31'
ORDER BY e.""first_name"" NULLS LAST, e.""last_name"" NULLS LAST;
```",,"[{'email': 'christopher.davis@example.com', 'first_name': 'Christopher', 'last_name': 'Davis', 'phone_number': '777-777-7777'}, {'email': 'jessica.martinez@example.com', 'first_name': 'Jessica', 'last_name': 'Martinez', 'phone_number': '888-888-8888'}, {'email': 'daniel.garcia@example.com', 'first_name': 'Daniel', 'last_name': 'Garcia', 'phone_number': '999-999-9999'}, {'email': 'taylor.rodriguez@example.com', 'first_name': 'Taylor', 'last_name': 'Rodriguez', 'phone_number': '111-111-1111'}, {'email': 'david.lopez@example.com', 'first_name': 'David', 'last_name': 'Lopez', 'phone_number': '222-333-4444'}, {'email': 'megan.hernandez@example.com', 'first_name': 'Megan', 'last_name': 'Hernandez', 'phone_number': '333-444-5555'}]","[""SELECT first_name, last_name, email, phone_number FROM employee WHERE hire_date >= DATE('2023-12-31') - INTERVAL '6 MONTH' AND hire_date <= DATE('2023-12-31')""]",86,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve the names and contact information of employees who joined the company in the last six months of 2023.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT e.""first_name"", e.""last_name"", e.""email"", e.""phone_number""
FROM ""employee"" AS e
JOIN ""job_history"" AS jh ON e.""employee_id"" = jh.""employee_id""
WHERE jh.""start_date"" BETWEEN '2023-07-01' AND '2023-12-31'
ORDER BY e.""first_name"" NULLS LAST, e.""last_name"" NULLS LAST;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'DATE', 'time']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42703', 'M': 'column e.location does not exist', 'P': '70', 'F': 'parse_relation.c', 'L': '3727', 'R': 'errorMissingColumn'}
[SQL: 
SELECT
*
FROM attendance AS a
WHERE
a.check_in_location <> (
SELECT
e.location
FROM employee AS e
WHERE
e.employee_id = a.employee_id
);
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List all employees who have checked in from a location outside their designated work location.",[],"
SELECT
  *
FROM attendance AS a
WHERE
  a.check_in_location <> (
    SELECT
      e.location
    FROM employee AS e
    WHERE
      e.employee_id = a.employee_id
  );
```",,"[{'check_in_location': 'Office Block A', 'date': '2022-01-01', 'first_name': 'John', 'last_name': 'Doe'}, {'check_in_location': 'Office Block B', 'date': '2022-01-01', 'first_name': 'Alice', 'last_name': 'Smith'}, {'check_in_location': 'Office Block C', 'date': '2022-01-01', 'first_name': 'Michael', 'last_name': 'Johnson'}, {'check_in_location': 'Office Block A', 'date': '2022-01-01', 'first_name': 'Emily', 'last_name': 'Williams'}, {'check_in_location': 'Office Block B', 'date': '2022-01-01', 'first_name': 'Matthew', 'last_name': 'Brown'}, {'check_in_location': 'Office Block C', 'date': '2022-01-01', 'first_name': 'Sarah', 'last_name': 'Jones'}, {'check_in_location': 'Office Block A', 'date': '2022-01-01', 'first_name': 'Christopher', 'last_name': 'Davis'}, {'check_in_location': 'Office Block B', 'date': '2022-01-01', 'first_name': 'Jessica', 'last_name': 'Martinez'}, {'check_in_location': 'Office Block C', 'date': '2022-01-01', 'first_name': 'Daniel', 'last_name': 'Garcia'}, {'check_in_location': 'Office Block A', 'date': '2022-01-01', 'first_name': 'Taylor', 'last_name': 'Rodriguez'}, {'check_in_location': 'Office Block B', 'date': '2022-01-01', 'first_name': 'David', 'last_name': 'Lopez'}, {'check_in_location': 'Office Block C', 'date': '2022-01-01', 'first_name': 'Megan', 'last_name': 'Hernandez'}, {'check_in_location': 'Office Block A', 'date': '2022-01-01', 'first_name': 'Andrew', 'last_name': 'Gonzalez'}, {'check_in_location': 'Office Block B', 'date': '2022-01-01', 'first_name': 'Sophia', 'last_name': 'Perez'}, {'check_in_location': 'Office Block C', 'date': '2022-01-01', 'first_name': 'Aiden', 'last_name': 'Torres'}, {'check_in_location': 'Office Block A', 'date': '2022-01-01', 'first_name': 'Olivia', 'last_name': 'Rivera'}, {'check_in_location': 'Office Block B', 'date': '2022-01-01', 'first_name': 'Liam', 'last_name': 'Gomez'}, {'check_in_location': 'Office Block C', 'date': '2022-01-01', 'first_name': 'Emma', 'last_name': 'Reyes'}, {'check_in_location': 'Office Block A', 'date': '2022-01-01', 'first_name': 'Noah', 'last_name': 'King'}, {'check_in_location': 'Office Block B', 'date': '2022-01-01', 'first_name': 'Charlotte', 'last_name': 'Cooper'}]","['SELECT e.first_name, e.last_name, a.date, a.check_in_location FROM employee e JOIN attendance a ON e.employee_id = a.employee_id WHERE a.check_in_location IN (SELECT check_in_location FROM attendance);']",97,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,List all employees who have checked in from a location outside their designated work location.,"{'Comment': '""Not Exactly sure how to get the designated work location?""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
*
FROM attendance AS a
WHERE
a.check_in_location <> (
SELECT
e.location
FROM employee AS e
WHERE
e.employee_id = a.employee_id
);
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN']",
[],db_hr,['postgres'],[],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '22023', 'M': 'cannot extract elements from an object', 'F': 'jsonfuncs.c', 'L': '2229', 'R': 'elements_worker_jsonb'}
[SQL: 
SELECT *
FROM ""employee"" AS e
JOIN jsonb_array_elements(e.address) AS a ON TRUE
WHERE a ->> 'city' = 'Anothertown City';
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve all employees who live in Anothertown City, from their address.",[],"
SELECT *
FROM ""employee"" AS e
JOIN jsonb_array_elements(e.address) AS a ON TRUE
WHERE a ->> 'city' = 'Anothertown City';
```",,"[{'employee_id': 3536255, 'first_name': 'Matthew'}, {'employee_id': 3536260, 'first_name': 'Taylor'}, {'employee_id': 3536264, 'first_name': 'Sophia'}, {'employee_id': 3536267, 'first_name': 'Liam'}, {'employee_id': 3536270, 'first_name': 'Charlotte'}]","[""SELECT e.employee_id, e.first_name FROM employee as e WHERE address->>'city' = 'Anothertown'""]",74,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Retrieve all employees who live in Anothertown City, from their address.","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT *
FROM ""employee"" AS e
JOIN jsonb_array_elements(e.address) AS a ON TRUE
WHERE a ->> 'city' = 'Anothertown City';
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'JSON_EXTRACT', 'JSON']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42803', 'M': 'aggregate function calls cannot be nested', 'P': '143', 'F': 'parse_agg.c', 'L': '681', 'R': 'check_agg_arguments'}
[SQL: 
-- Calculate the average monthly revenue for the financial year 2023, considering both invoiced and pending payments.

SELECT
AVG(
COALESCE(
SUM(""in"".""total_amount""), 0
) +
COALESCE(
SUM(""pay"".""amount""), 0
)
) AS ""average_monthly_revenue""
FROM
""invoice"" AS ""in""
LEFT JOIN
""payment"" AS ""pay"" ON ""in"".""invoice_id"" = ""pay"".""invoice_id""
WHERE
EXTRACT(YEAR FROM ""in"".""invoice_date"") = 2023
OR EXTRACT(YEAR FROM ""pay"".""payment_date"") = 2023;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Calculate the average monthly revenue generated from clients in the financial year 2023, considering both invoiced and pending payments.",[],"
-- Calculate the average monthly revenue for the financial year 2023, considering both invoiced and pending payments.

SELECT
    AVG(
        COALESCE(
            SUM(""in"".""total_amount""), 0
        ) +
        COALESCE(
            SUM(""pay"".""amount""), 0
        )
    ) AS ""average_monthly_revenue""
FROM
    ""invoice"" AS ""in""
LEFT JOIN
    ""payment"" AS ""pay"" ON ""in"".""invoice_id"" = ""pay"".""invoice_id""
WHERE
    EXTRACT(YEAR FROM ""in"".""invoice_date"") = 2023
    OR EXTRACT(YEAR FROM ""pay"".""payment_date"") = 2023;
```",,"[{'avg_monthly_revenue': '1500.0000000000000000', 'month': '1'}, {'avg_monthly_revenue': '1800.0000000000000000', 'month': '3'}, {'avg_monthly_revenue': '2000.0000000000000000', 'month': '5'}, {'avg_monthly_revenue': '1400.0000000000000000', 'month': '7'}, {'avg_monthly_revenue': '1700.0000000000000000', 'month': '9'}, {'avg_monthly_revenue': '1900.0000000000000000', 'month': '11'}]","[""SELECT EXTRACT(MONTH FROM invoice_date) AS month, AVG(total_amount) AS avg_monthly_revenue FROM invoice WHERE EXTRACT(YEAR FROM invoice_date) = 2023 AND status IN ('Invoiced', 'Pending') GROUP BY EXTRACT(MONTH FROM invoice_date) ORDER BY month;""]",46,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Calculate the average monthly revenue generated from clients in the financial year 2023, considering both invoiced and pending payments.","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
-- Calculate the average monthly revenue for the financial year 2023, considering both invoiced and pending payments.

SELECT
AVG(
COALESCE(
SUM(""in"".""total_amount""), 0
) +
COALESCE(
SUM(""pay"".""amount""), 0
)
) AS ""average_monthly_revenue""
FROM
""invoice"" AS ""in""
LEFT JOIN
""payment"" AS ""pay"" ON ""in"".""invoice_id"" = ""pay"".""invoice_id""
WHERE
EXTRACT(YEAR FROM ""in"".""invoice_date"") = 2023
OR EXTRACT(YEAR FROM ""pay"".""payment_date"") = 2023;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'DATE']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42601', 'M': 'syntax error at or near "".""', 'P': '522', 'F': 'scan.l', 'L': '1246', 'R': 'scanner_yyerror'}
[SQL: 
WITH PaymentSummaries AS (
SELECT
EXTRACT(MONTH FROM p.payment_date) AS payment_month,
SUM(p.amount) AS total_amount_paid
FROM payment AS p
WHERE p.payment_date >= '2000-01-01'
GROUP BY EXTRACT(MONTH FROM p.payment_date)
),
InvoiceSummaries AS (
SELECT
EXTRACT(MONTH FROM i.invoice_date) AS invoice_month,
SUM(i.total_amount) AS total_amount_invoiced
FROM invoice AS i
WHERE i.invoice_date >= '2000-01-01'
GROUP BY EXTRACT(MONTH FROM i.invoice_date)
)
SELECT
ps.payment_month AS month,
ps.total_amount_paid + COALESCE(is.total_amount_invoiced, 0) AS total_amount
FROM PaymentSummaries AS ps
LEFT JOIN InvoiceSummaries AS is ON ps.payment_month = is.invoice_month
ORDER BY ps.payment_month;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Calculate the total amount paid each month, including the total amount of invoices issued in that month.",[],"
WITH PaymentSummaries AS (
    SELECT
        EXTRACT(MONTH FROM p.payment_date) AS payment_month,
        SUM(p.amount) AS total_amount_paid
    FROM payment AS p
    WHERE p.payment_date >= '2000-01-01'
    GROUP BY EXTRACT(MONTH FROM p.payment_date)
),
InvoiceSummaries AS (
    SELECT
        EXTRACT(MONTH FROM i.invoice_date) AS invoice_month,
        SUM(i.total_amount) AS total_amount_invoiced
    FROM invoice AS i
    WHERE i.invoice_date >= '2000-01-01'
    GROUP BY EXTRACT(MONTH FROM i.invoice_date)
)
SELECT
    ps.payment_month AS month,
    ps.total_amount_paid + COALESCE(is.total_amount_invoiced, 0) AS total_amount
FROM PaymentSummaries AS ps
LEFT JOIN InvoiceSummaries AS is ON ps.payment_month = is.invoice_month
ORDER BY ps.payment_month;
```",,"[{'month': '1', 'total_invoiced': '1500.00', 'total_paid': '1500.00', 'year': '2023'}, {'month': '2', 'total_invoiced': '1200.00', 'total_paid': '1200.00', 'year': '2023'}, {'month': '3', 'total_invoiced': '1800.00', 'total_paid': '1800.00', 'year': '2023'}, {'month': '4', 'total_invoiced': '900.00', 'total_paid': '900.00', 'year': '2023'}, {'month': '5', 'total_invoiced': '2000.00', 'total_paid': '2000.00', 'year': '2023'}, {'month': '6', 'total_invoiced': '1600.00', 'total_paid': '1600.00', 'year': '2023'}, {'month': '7', 'total_invoiced': '1400.00', 'total_paid': '1400.00', 'year': '2023'}, {'month': '8', 'total_invoiced': '1100.00', 'total_paid': '1100.00', 'year': '2023'}, {'month': '9', 'total_invoiced': '1700.00', 'total_paid': '1700.00', 'year': '2023'}, {'month': '10', 'total_invoiced': '1300.00', 'total_paid': '1300.00', 'year': '2023'}, {'month': '11', 'total_invoiced': '1900.00', 'total_paid': '1900.00', 'year': '2023'}, {'month': '12', 'total_invoiced': '1000.00', 'total_paid': '1000.00', 'year': '2023'}, {'month': '1', 'total_invoiced': '1500.00', 'total_paid': '1500.00', 'year': '2024'}, {'month': '2', 'total_invoiced': '1200.00', 'total_paid': '1200.00', 'year': '2024'}, {'month': '3', 'total_invoiced': '1800.00', 'total_paid': '1800.00', 'year': '2024'}, {'month': '4', 'total_invoiced': '900.00', 'total_paid': '900.00', 'year': '2024'}, {'month': '5', 'total_invoiced': '2000.00', 'total_paid': '2000.00', 'year': '2024'}, {'month': '6', 'total_invoiced': '1600.00', 'total_paid': '1600.00', 'year': '2024'}, {'month': '7', 'total_invoiced': '1400.00', 'total_paid': '1400.00', 'year': '2024'}, {'month': '8', 'total_invoiced': '1100.00', 'total_paid': '1100.00', 'year': '2024'}]","['SELECT EXTRACT(YEAR FROM p.payment_date) AS year, EXTRACT(MONTH FROM p.payment_date) AS month, SUM(p.amount) AS total_paid, SUM(i.total_amount) AS total_invoiced FROM payment p JOIN invoice i ON p.invoice_id = i.invoice_id GROUP BY EXTRACT(YEAR FROM p.payment_date), EXTRACT(MONTH FROM p.payment_date) ORDER BY year, month;']",22,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Calculate the total amount paid each month, including the total amount of invoices issued in that month.","{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH PaymentSummaries AS (
SELECT
EXTRACT(MONTH FROM p.payment_date) AS payment_month,
SUM(p.amount) AS total_amount_paid
FROM payment AS p
WHERE p.payment_date >= '2000-01-01'
GROUP BY EXTRACT(MONTH FROM p.payment_date)
),
InvoiceSummaries AS (
SELECT
EXTRACT(MONTH FROM i.invoice_date) AS invoice_month,
SUM(i.total_amount) AS total_amount_invoiced
FROM invoice AS i
WHERE i.invoice_date >= '2000-01-01'
GROUP BY EXTRACT(MONTH FROM i.invoice_date)
)
SELECT
ps.payment_month AS month,
ps.total_amount_paid + COALESCE(is.total_amount_invoiced, 0) AS total_amount
FROM PaymentSummaries AS ps
LEFT JOIN InvoiceSummaries AS is ON ps.payment_month = is.invoice_month
ORDER BY ps.payment_month;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'JOIN', 'SORT', 'DATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Identify the employees who have attended training sessions categories within the last six months.",[],"
SELECT 
	e.employee_id,
    e.first_name,
    e.last_name,
    t.title,
    t.date
FROM 
	public.employee AS e
JOIN 
	public.employee_training AS et ON e.employee_id = et.employee_id
JOIN 
	public.training AS t ON et.training_id = t.training_id
WHERE 
	t.date BETWEEN CURRENT_DATE - INTERVAL '6 months' AND CURRENT_DATE
ORDER BY 
	e.employee_id, t.date;
```",,"[{'employee_id': 3536270, 'first_name': 'Charlotte'}]","[""SELECT e.employee_id, e.first_name FROM employee e JOIN employee_training et ON e.employee_id = et.employee_id JOIN training t ON et.training_id = t.training_id WHERE t.title IN (SELECT title FROM training) AND et.start_date >= CURRENT_DATE - INTERVAL '6 months' GROUP BY e.employee_id, e.first_name HAVING COUNT(DISTINCT t.title) = 1;""]",53,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Identify the employees who have attended training sessions categories within the last six months.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT 
	e.employee_id,
e.first_name,
e.last_name,
t.title,
t.date
FROM 
	public.employee AS e
JOIN 
	public.employee_training AS et ON e.employee_id = et.employee_id
JOIN 
	public.training AS t ON et.training_id = t.training_id
WHERE 
	t.date BETWEEN CURRENT_DATE - INTERVAL '6 months' AND CURRENT_DATE
ORDER BY 
	e.employee_id, t.date;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'AGGREGATE', 'HAVING']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Identify employees id and names who have not completed mandatory training sessions in the first six months of 2024, along with the total number of sessions missed",[],"
SELECT
    e.employee_id,
    e.first_name,
    e.last_name,
    COUNT(t.training_id) AS missed_sessions
FROM
    ""employee"" AS e
LEFT JOIN
    ""employee_training"" AS et ON e.employee_id = et.employee_id
LEFT JOIN
    ""training"" AS t ON et.training_id = t.training_id
WHERE
    t.attendance_required = TRUE
    AND t.date BETWEEN '2024-01-01' AND '2024-06-30'
    AND et.employee_id IS NULL
GROUP BY
    e.employee_id,
    e.first_name,
    e.last_name
HAVING
    COUNT(t.training_id) > 0
ORDER BY
    e.employee_id;
```",,"[{'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith', 'total_sessions_missed': 1}, {'employee_id': 3536259, 'first_name': 'Daniel', 'last_name': 'Garcia', 'total_sessions_missed': 1}, {'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones', 'total_sessions_missed': 1}, {'employee_id': 3536263, 'first_name': 'Andrew', 'last_name': 'Gonzalez', 'total_sessions_missed': 1}, {'employee_id': 3536261, 'first_name': 'David', 'last_name': 'Lopez', 'total_sessions_missed': 1}, {'employee_id': 3536264, 'first_name': 'Sophia', 'last_name': 'Perez', 'total_sessions_missed': 1}, {'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe', 'total_sessions_missed': 1}, {'employee_id': 3536269, 'first_name': 'Noah', 'last_name': 'King', 'total_sessions_missed': 1}, {'employee_id': 3536268, 'first_name': 'Emma', 'last_name': 'Reyes', 'total_sessions_missed': 1}, {'employee_id': 3536254, 'first_name': 'Emily', 'last_name': 'Williams', 'total_sessions_missed': 1}, {'employee_id': 3536260, 'first_name': 'Taylor', 'last_name': 'Rodriguez', 'total_sessions_missed': 1}, {'employee_id': 3536262, 'first_name': 'Megan', 'last_name': 'Hernandez', 'total_sessions_missed': 1}, {'employee_id': 3536270, 'first_name': 'Charlotte', 'last_name': 'Cooper', 'total_sessions_missed': 1}, {'employee_id': 3536267, 'first_name': 'Liam', 'last_name': 'Gomez', 'total_sessions_missed': 1}, {'employee_id': 3536266, 'first_name': 'Olivia', 'last_name': 'Rivera', 'total_sessions_missed': 1}, {'employee_id': 3536257, 'first_name': 'Christopher', 'last_name': 'Davis', 'total_sessions_missed': 1}, {'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown', 'total_sessions_missed': 1}]","[""SELECT e.employee_id, e.first_name, e.last_name, COUNT(t.training_id) AS total_sessions_missed FROM employee e LEFT JOIN employee_training te ON e.employee_id = te.employee_id LEFT JOIN training t ON te.training_id = t.training_id WHERE t.date >= '2024-01-01' AND t.date <= '2024-06-30' AND t.attendance_required = true AND t.status = 'Active' GROUP BY e.employee_id, e.first_name, e.last_name;""]",79,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Identify employees id and names who have not completed mandatory training sessions in the first six months of 2024, along with the total number of sessions missed","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""t.attendance_required = 1, t.status = \'Active\'""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
e.employee_id,
e.first_name,
e.last_name,
COUNT(t.training_id) AS missed_sessions
FROM
""employee"" AS e
LEFT JOIN
""employee_training"" AS et ON e.employee_id = et.employee_id
LEFT JOIN
""training"" AS t ON et.training_id = t.training_id
WHERE
t.attendance_required = TRUE
AND t.date BETWEEN '2024-01-01' AND '2024-06-30'
AND et.employee_id IS NULL
GROUP BY
e.employee_id,
e.first_name,
e.last_name
HAVING
COUNT(t.training_id) > 0
ORDER BY
e.employee_id;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'LEFT_JOIN', 'AGGREGATE', 'DATE', 'time', 'COUNT']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42703', 'M': 'column ""day"" does not exist', 'P': '188', 'F': 'parse_relation.c', 'L': '3727', 'R': 'errorMissingColumn'}
[SQL: 
WITH EmployeeWorkData AS (
SELECT
e.employee_id,
a.check_in_time,
a.check_out_time,
a.date,
EXTRACT(EPOCH FROM a.check_out_time - a.check_in_time) / 3600 AS hours_worked,
DATEDIFF(DAY, a.date, e.hire_date) AS days_worked
FROM attendance a
JOIN employee e
ON a.employee_id = e.employee_id
WHERE
DATEDIFF(YEAR, a.date, e.hire_date) >= 1
)
SELECT
SUM(e.hours_worked) / SUM(e.days_worked) AS avg_hours_worked_per_day
FROM EmployeeWorkData e;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Calculate the average number of hours worked per day by employees who have been with the company for more than one years.",[],"
WITH EmployeeWorkData AS (
  SELECT
    e.employee_id,
    a.check_in_time,
    a.check_out_time,
    a.date,
    EXTRACT(EPOCH FROM a.check_out_time - a.check_in_time) / 3600 AS hours_worked,
    DATEDIFF(DAY, a.date, e.hire_date) AS days_worked
  FROM attendance a
  JOIN employee e
    ON a.employee_id = e.employee_id
  WHERE
    DATEDIFF(YEAR, a.date, e.hire_date) >= 1
)
SELECT
  SUM(e.hours_worked) / SUM(e.days_worked) AS avg_hours_worked_per_day
FROM EmployeeWorkData e;
```",,"[{'avg_hours_per_week': '8.2500000000000000', 'employee_id': 3536251}, {'avg_hours_per_week': '7.7500000000000000', 'employee_id': 3536252}, {'avg_hours_per_week': '7.7500000000000000', 'employee_id': 3536254}, {'avg_hours_per_week': '7.5000000000000000', 'employee_id': 3536258}, {'avg_hours_per_week': '8.0000000000000000', 'employee_id': 3536260}, {'avg_hours_per_week': '8.0000000000000000', 'employee_id': 3536259}, {'avg_hours_per_week': '8.0000000000000000', 'employee_id': 3536253}, {'avg_hours_per_week': '8.2500000000000000', 'employee_id': 3536256}, {'avg_hours_per_week': '8.0000000000000000', 'employee_id': 3536257}, {'avg_hours_per_week': '8.2500000000000000', 'employee_id': 3536255}]","[""SELECT te.employee_id, AVG(working_hours) AS avg_hours_per_week FROM timesheet_employee te JOIN timesheet t ON te.timesheet_id = t.timesheet_id JOIN employee e ON te.employee_id = e.employee_id WHERE e.hire_date <= CURRENT_DATE - INTERVAL '1 year' GROUP BY te.employee_id;""]",60,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Calculate the average number of hours worked per day by employees who have been with the company for more than one years.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH EmployeeWorkData AS (
SELECT
e.employee_id,
a.check_in_time,
a.check_out_time,
a.date,
EXTRACT(EPOCH FROM a.check_out_time - a.check_in_time) / 3600 AS hours_worked,
DATEDIFF(DAY, a.date, e.hire_date) AS days_worked
FROM attendance a
JOIN employee e
ON a.employee_id = e.employee_id
WHERE
DATEDIFF(YEAR, a.date, e.hire_date) >= 1
)
SELECT
SUM(e.hours_worked) / SUM(e.days_worked) AS avg_hours_worked_per_day
FROM EmployeeWorkData e;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'JOIN', 'DATE', 'LIMIT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Identify employees who have requested a leave due to personal reasons and provide their emergency contact details.",[],"
SELECT
  e.""first_name"",
  e.""last_name"",
  e.""email"",
  e.""phone_number"",
  e.""emergency_contact_name"",
  e.""emergency_contact_number"",
  lr.""comments"" AS leave_request_reason,
  lr.""start_date"" AS leave_request_start_date,
  lr.""end_date"" AS leave_request_end_date
FROM ""employee"" AS e
JOIN ""leave_request"" AS lr
  ON e.""employee_id"" = lr.""employee_id""
WHERE
  lr.""leave_type"" = 'Personal';
```",,"[{'emergency_contact_name': 'Emma Brown', 'emergency_contact_number': '222-333-4444', 'employee_id': 3536255}, {'emergency_contact_name': 'Sophia Lopez', 'emergency_contact_number': '222-333-4444', 'employee_id': 3536261}, {'emergency_contact_name': 'Emma Torres', 'emergency_contact_number': '666-777-8888', 'employee_id': 3536265}, {'emergency_contact_name': 'Charlotte King', 'emergency_contact_number': '111-222-3333', 'employee_id': 3536269}]","[""SELECT e.employee_id, e.emergency_contact_name, e.emergency_contact_number FROM employee e INNER JOIN leave_request lr ON e.employee_id = lr.employee_id WHERE lr.leave_type LIKE '%Personal%';""]",76,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Identify employees who have requested a leave due to personal reasons and provide their emergency contact details.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""leave_type= \'Personal\'""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
e.""first_name"",
e.""last_name"",
e.""email"",
e.""phone_number"",
e.""emergency_contact_name"",
e.""emergency_contact_number"",
lr.""comments"" AS leave_request_reason,
lr.""start_date"" AS leave_request_start_date,
lr.""end_date"" AS leave_request_end_date
FROM ""employee"" AS e
JOIN ""leave_request"" AS lr
ON e.""employee_id"" = lr.""employee_id""
WHERE
lr.""leave_type"" = 'Personal';
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'JOIN', 'LIKE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the list of employees who are currently on leave, including their names, the start and end dates of their leave, and the number of days left. Provide this information for all employees who have a leave period that included Jan 3, 2023.",[],"
SELECT
    e.""first_name"" || ' ' || e.""last_name"" AS ""Employee Name"",
    lr.""start_date"" AS ""Leave Start Date"",
    lr.""end_date"" AS ""Leave End Date"",
    (lr.""end_date"" - lr.""start_date"") + 1 AS ""Number of Days Remaining on Leave""
FROM
    ""employee"" e
INNER JOIN
    ""employee_x_benefit"" exb ON e.""employee_id"" = exb.""employee_id""
INNER JOIN
    ""benefit"" b ON exb.""benefit_id"" = b.""benefit_id""
INNER JOIN
    ""leave_request"" lr ON e.""employee_id"" = lr.""employee_id""
WHERE
    '""2023-01-03""' BETWEEN lr.""start_date"" AND lr.""end_date"" AND b.""benefit_name"" = 'Leave'
    AND lr.""status"" IN ('Pending', 'Approved')
ORDER BY
    ""Employee Name"";
```",,"[{'days_left': -767, 'end_date': '2023-01-05', 'first_name': 'John', 'last_name': 'Doe', 'start_date': '2023-01-01'}]","[""SELECT e.first_name, e.last_name, lr.start_date, lr.end_date, (lr.end_date - CURRENT_DATE) AS days_left FROM employee e JOIN leave_request lr ON e.employee_id = lr.employee_id WHERE '2023-01-03' BETWEEN lr.start_date AND lr.end_date;""]",4,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Retrieve the list of employees who are currently on leave, including their names, the start and end dates of their leave, and the number of days left. Provide this information for all employees who have a leave period that included Jan 3, 2023.","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
e.""first_name"" || ' ' || e.""last_name"" AS ""Employee Name"",
lr.""start_date"" AS ""Leave Start Date"",
lr.""end_date"" AS ""Leave End Date"",
(lr.""end_date"" - lr.""start_date"") + 1 AS ""Number of Days Remaining on Leave""
FROM
""employee"" e
INNER JOIN
""employee_x_benefit"" exb ON e.""employee_id"" = exb.""employee_id""
INNER JOIN
""benefit"" b ON exb.""benefit_id"" = b.""benefit_id""
INNER JOIN
""leave_request"" lr ON e.""employee_id"" = lr.""employee_id""
WHERE
'""2023-01-03""' BETWEEN lr.""start_date"" AND lr.""end_date"" AND b.""benefit_name"" = 'Leave'
AND lr.""status"" IN ('Pending', 'Approved')
ORDER BY
""Employee Name"";
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'DATE', 'JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Calculate the average budget allocated to each department over the past three years. The current year being 2023.",[],"
/* Retrieve the average budget allocated to departments over the past three years */
SELECT
    d.department_name, /* Department name */
    AVG(d.budget) AS average_budget /* Calculate the average budget */
FROM
    ""department"" AS d
WHERE
    d.end_date >= DATE('2020-01-01') /* Filter for departments within the past three years */
GROUP BY
    d.department_name /* Group the results by department name */
ORDER BY
    d.department_name; /* Sort the results by department name */
```",,"[{'avg_budget': '300000.000000000000', 'department_name': 'Production'}, {'avg_budget': '150000.000000000000', 'department_name': 'Marketing'}, {'avg_budget': '160000.000000000000', 'department_name': 'Operations'}, {'avg_budget': '130000.000000000000', 'department_name': 'Quality Assurance'}, {'avg_budget': '150000.000000000000', 'department_name': 'Safety and Compliance'}, {'avg_budget': '250000.000000000000', 'department_name': 'Research and Development'}, {'avg_budget': '180000.000000000000', 'department_name': 'Sales'}, {'avg_budget': '100000.000000000000', 'department_name': 'Training and Development'}, {'avg_budget': '190000.000000000000', 'department_name': 'Legal'}, {'avg_budget': '130000.000000000000', 'department_name': 'Public Relations'}, {'avg_budget': '120000.000000000000', 'department_name': 'Administration'}, {'avg_budget': '280000.000000000000', 'department_name': 'Engineering'}, {'avg_budget': '220000.000000000000', 'department_name': 'IT'}, {'avg_budget': '200000.000000000000', 'department_name': 'Logistics'}, {'avg_budget': '200000.000000000000', 'department_name': 'Finance'}, {'avg_budget': '160000.000000000000', 'department_name': 'Product Management'}, {'avg_budget': '120000.000000000000', 'department_name': 'Customer Service'}, {'avg_budget': '100000.000000000000', 'department_name': 'Human Resources'}, {'avg_budget': '170000.000000000000', 'department_name': 'Customer Success'}, {'avg_budget': '180000.000000000000', 'department_name': 'Supply Chain'}]","[""SELECT department_name, AVG(budget) AS avg_budget FROM department WHERE start_date >= DATE('2023-01-01') - INTERVAL '3 YEAR' GROUP BY department_name;""]",83,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Calculate the average budget allocated to each department over the past three years. The current year being 2023.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
/* Retrieve the average budget allocated to departments over the past three years */
SELECT
d.department_name, /* Department name */
AVG(d.budget) AS average_budget /* Calculate the average budget */
FROM
""department"" AS d
WHERE
d.end_date >= DATE('2020-01-01') /* Filter for departments within the past three years */
GROUP BY
d.department_name /* Group the results by department name */
ORDER BY
d.department_name; /* Sort the results by department name */
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'AGGREGATE', 'DATE', 'time']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Calculate the total duration of training sessions in hours attended by each employee.","[{'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe', 'total_training_duration_hours': '3.50'}, {'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith', 'total_training_duration_hours': '4.00'}, {'employee_id': 3536253, 'first_name': 'Michael', 'last_name': 'Johnson', 'total_training_duration_hours': '2.50'}, {'employee_id': 3536254, 'first_name': 'Emily', 'last_name': 'Williams', 'total_training_duration_hours': '2.00'}, {'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown', 'total_training_duration_hours': '3.00'}, {'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones', 'total_training_duration_hours': '2.50'}, {'employee_id': 3536257, 'first_name': 'Christopher', 'last_name': 'Davis', 'total_training_duration_hours': '4.00'}, {'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez', 'total_training_duration_hours': '2.00'}, {'employee_id': 3536259, 'first_name': 'Daniel', 'last_name': 'Garcia', 'total_training_duration_hours': '3.50'}, {'employee_id': 3536260, 'first_name': 'Taylor', 'last_name': 'Rodriguez', 'total_training_duration_hours': '3.00'}, {'employee_id': 3536261, 'first_name': 'David', 'last_name': 'Lopez', 'total_training_duration_hours': '2.50'}, {'employee_id': 3536262, 'first_name': 'Megan', 'last_name': 'Hernandez', 'total_training_duration_hours': '3.00'}, {'employee_id': 3536263, 'first_name': 'Andrew', 'last_name': 'Gonzalez', 'total_training_duration_hours': '2.00'}, {'employee_id': 3536264, 'first_name': 'Sophia', 'last_name': 'Perez', 'total_training_duration_hours': '4.00'}, {'employee_id': 3536265, 'first_name': 'Aiden', 'last_name': 'Torres', 'total_training_duration_hours': '2.50'}, {'employee_id': 3536266, 'first_name': 'Olivia', 'last_name': 'Rivera', 'total_training_duration_hours': '3.00'}, {'employee_id': 3536267, 'first_name': 'Liam', 'last_name': 'Gomez', 'total_training_duration_hours': '2.00'}, {'employee_id': 3536268, 'first_name': 'Emma', 'last_name': 'Reyes', 'total_training_duration_hours': '3.50'}, {'employee_id': 3536269, 'first_name': 'Noah', 'last_name': 'King', 'total_training_duration_hours': '3.00'}, {'employee_id': 3536270, 'first_name': 'Charlotte', 'last_name': 'Cooper', 'total_training_duration_hours': '2.50'}]","
SELECT
    e.employee_id,
    e.first_name,
    e.last_name,
    SUM(t.duration) AS total_training_duration_hours
FROM
    ""employee"" AS e
JOIN
    ""employee_training"" AS et
ON
    e.employee_id = et.employee_id
JOIN
    ""training"" AS t
ON
    et.training_id = t.training_id
GROUP BY
    e.employee_id, e.first_name, e.last_name
ORDER BY
    e.employee_id;
```",,"[{'employee_id': 3536261, 'total_training_duration_minutes': 0}, {'employee_id': 3536264, 'total_training_duration_minutes': 0}, {'employee_id': 3536251, 'total_training_duration_minutes': 0}, {'employee_id': 3536269, 'total_training_duration_minutes': 0}, {'employee_id': 3536268, 'total_training_duration_minutes': 0}, {'employee_id': 3536254, 'total_training_duration_minutes': 0}, {'employee_id': 3536260, 'total_training_duration_minutes': 0}, {'employee_id': 3536253, 'total_training_duration_minutes': 0}, {'employee_id': 3536262, 'total_training_duration_minutes': 0}, {'employee_id': 3536270, 'total_training_duration_minutes': 0}, {'employee_id': 3536267, 'total_training_duration_minutes': 0}, {'employee_id': 3536266, 'total_training_duration_minutes': 0}, {'employee_id': 3536257, 'total_training_duration_minutes': 0}, {'employee_id': 3536255, 'total_training_duration_minutes': 0}, {'employee_id': 3536265, 'total_training_duration_minutes': 0}, {'employee_id': 3536252, 'total_training_duration_minutes': 0}, {'employee_id': 3536258, 'total_training_duration_minutes': 0}, {'employee_id': 3536259, 'total_training_duration_minutes': 0}, {'employee_id': 3536256, 'total_training_duration_minutes': 0}, {'employee_id': 3536263, 'total_training_duration_minutes': 0}]","['SELECT e.employee_id, SUM((et.end_date - et.start_date) / 60) AS total_training_duration_minutes FROM employee e JOIN employee_training et ON e.employee_id = et.employee_id GROUP BY e.employee_id;']",94,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Calculate the total duration of training sessions in hours attended by each employee.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
e.employee_id,
e.first_name,
e.last_name,
SUM(t.duration) AS total_training_duration_hours
FROM
""employee"" AS e
JOIN
""employee_training"" AS et
ON
e.employee_id = et.employee_id
JOIN
""training"" AS t
ON
et.training_id = t.training_id
GROUP BY
e.employee_id, e.first_name, e.last_name
ORDER BY
e.employee_id;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'JOIN', 'SUM']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Identify the employees who have taken more than two sick leaves in the last six months of year 2023, along with the total duration of their sick leaves.",[],"
-- Select the employee's first name, last name, and total sick leave duration.
SELECT
    e.""first_name"",
    e.""last_name"",
    SUM(lr.""duration"") AS ""total_sick_leave_duration""
-- Join the 'employee' table (aliased as 'e') with the 'leave_request' table (aliased as 'lr') on the 'employee_id' column.
FROM
    ""employee"" AS e
INNER JOIN
    ""leave_request"" AS lr
ON
    e.""employee_id"" = lr.""employee_id""
-- Filter the leave requests to include only those with the 'leave_type' of 'Sick Leave'.
WHERE
    lr.""leave_type"" = 'Sick Leave'
-- Filter the leave requests to include only those within the last six months of year 2023.
AND
    lr.""start_date"" BETWEEN '2023-07-01' AND '2023-12-31'
-- Group the results by employee first name and last name.
GROUP BY
    e.""first_name"",
    e.""last_name""
-- Filter the results to include only those employees who have taken more than two sick leaves.
HAVING
    COUNT(*) > 2
-- Order the results in descending order of total sick leave duration.
ORDER BY
    ""total_sick_leave_duration"" DESC;
```",,"[{'employee_id': 3536259, 'total_sick_leave_duration': '3.00'}]","[""SELECT e.employee_id, SUM(duration) AS total_sick_leave_duration FROM employee e JOIN leave_request l ON e.employee_id = l.employee_id WHERE l.leave_type = 'Sick Leave' AND l.start_date >= '2023-07-01' AND l.start_date <= '2023-12-31' GROUP BY e.employee_id HAVING SUM(duration) > 2;""]",48,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Identify the employees who have taken more than two sick leaves in the last six months of year 2023, along with the total duration of their sick leaves.","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""leave_type= \'Sick Leave\'""'}",,dql,2025-02-10 18:36:22.083420,"
-- Select the employee's first name, last name, and total sick leave duration.
SELECT
e.""first_name"",
e.""last_name"",
SUM(lr.""duration"") AS ""total_sick_leave_duration""
-- Join the 'employee' table (aliased as 'e') with the 'leave_request' table (aliased as 'lr') on the 'employee_id' column.
FROM
""employee"" AS e
INNER JOIN
""leave_request"" AS lr
ON
e.""employee_id"" = lr.""employee_id""
-- Filter the leave requests to include only those with the 'leave_type' of 'Sick Leave'.
WHERE
lr.""leave_type"" = 'Sick Leave'
-- Filter the leave requests to include only those within the last six months of year 2023.
AND
lr.""start_date"" BETWEEN '2023-07-01' AND '2023-12-31'
-- Group the results by employee first name and last name.
GROUP BY
e.""first_name"",
e.""last_name""
-- Filter the results to include only those employees who have taken more than two sick leaves.
HAVING
COUNT(*) > 2
-- Order the results in descending order of total sick leave duration.
ORDER BY
""total_sick_leave_duration"" DESC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'AGGREGATE', 'DATE', 'HAVING']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find the number of days each employee has been employed in the company.","[{'days_employed': 757, 'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe'}, {'days_employed': 703, 'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith'}, {'days_employed': 713, 'employee_id': 3536253, 'first_name': 'Michael', 'last_name': 'Johnson'}, {'days_employed': 677, 'employee_id': 3536254, 'first_name': 'Emily', 'last_name': 'Williams'}, {'days_employed': 632, 'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown'}, {'days_employed': 606, 'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones'}, {'days_employed': 581, 'employee_id': 3536257, 'first_name': 'Christopher', 'last_name': 'Davis'}, {'days_employed': 535, 'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez'}, {'days_employed': 519, 'employee_id': 3536259, 'first_name': 'Daniel', 'last_name': 'Garcia'}, {'days_employed': 494, 'employee_id': 3536260, 'first_name': 'Taylor', 'last_name': 'Rodriguez'}, {'days_employed': 453, 'employee_id': 3536261, 'first_name': 'David', 'last_name': 'Lopez'}, {'days_employed': 418, 'employee_id': 3536262, 'first_name': 'Megan', 'last_name': 'Hernandez'}, {'days_employed': 397, 'employee_id': 3536263, 'first_name': 'Andrew', 'last_name': 'Gonzalez'}, {'days_employed': 361, 'employee_id': 3536264, 'first_name': 'Sophia', 'last_name': 'Perez'}, {'days_employed': 327, 'employee_id': 3536265, 'first_name': 'Aiden', 'last_name': 'Torres'}, {'days_employed': 311, 'employee_id': 3536266, 'first_name': 'Olivia', 'last_name': 'Rivera'}, {'days_employed': 271, 'employee_id': 3536267, 'first_name': 'Liam', 'last_name': 'Gomez'}, {'days_employed': 235, 'employee_id': 3536268, 'first_name': 'Emma', 'last_name': 'Reyes'}, {'days_employed': 215, 'employee_id': 3536269, 'first_name': 'Noah', 'last_name': 'King'}, {'days_employed': 179, 'employee_id': 3536270, 'first_name': 'Charlotte', 'last_name': 'Cooper'}]","
SELECT
    e.employee_id,
    e.first_name,
    e.last_name,
    (
        SELECT
            date('now') - e.hire_date
    ) AS days_employed
FROM
    ""employee"" AS e;
```",,"[{'days_employed': 757, 'employee_id': 3536251, 'first_name': 'John', 'hire_date': '2023-01-15', 'last_name': 'Doe'}, {'days_employed': 703, 'employee_id': 3536252, 'first_name': 'Alice', 'hire_date': '2023-03-10', 'last_name': 'Smith'}, {'days_employed': 713, 'employee_id': 3536253, 'first_name': 'Michael', 'hire_date': '2023-02-28', 'last_name': 'Johnson'}, {'days_employed': 677, 'employee_id': 3536254, 'first_name': 'Emily', 'hire_date': '2023-04-05', 'last_name': 'Williams'}, {'days_employed': 632, 'employee_id': 3536255, 'first_name': 'Matthew', 'hire_date': '2023-05-20', 'last_name': 'Brown'}, {'days_employed': 606, 'employee_id': 3536256, 'first_name': 'Sarah', 'hire_date': '2023-06-15', 'last_name': 'Jones'}, {'days_employed': 581, 'employee_id': 3536257, 'first_name': 'Christopher', 'hire_date': '2023-07-10', 'last_name': 'Davis'}, {'days_employed': 535, 'employee_id': 3536258, 'first_name': 'Jessica', 'hire_date': '2023-08-25', 'last_name': 'Martinez'}, {'days_employed': 519, 'employee_id': 3536259, 'first_name': 'Daniel', 'hire_date': '2023-09-10', 'last_name': 'Garcia'}, {'days_employed': 494, 'employee_id': 3536260, 'first_name': 'Taylor', 'hire_date': '2023-10-05', 'last_name': 'Rodriguez'}, {'days_employed': 453, 'employee_id': 3536261, 'first_name': 'David', 'hire_date': '2023-11-15', 'last_name': 'Lopez'}, {'days_employed': 418, 'employee_id': 3536262, 'first_name': 'Megan', 'hire_date': '2023-12-20', 'last_name': 'Hernandez'}, {'days_employed': 397, 'employee_id': 3536263, 'first_name': 'Andrew', 'hire_date': '2024-01-10', 'last_name': 'Gonzalez'}, {'days_employed': 361, 'employee_id': 3536264, 'first_name': 'Sophia', 'hire_date': '2024-02-15', 'last_name': 'Perez'}, {'days_employed': 327, 'employee_id': 3536265, 'first_name': 'Aiden', 'hire_date': '2024-03-20', 'last_name': 'Torres'}, {'days_employed': 311, 'employee_id': 3536266, 'first_name': 'Olivia', 'hire_date': '2024-04-05', 'last_name': 'Rivera'}, {'days_employed': 271, 'employee_id': 3536267, 'first_name': 'Liam', 'hire_date': '2024-05-15', 'last_name': 'Gomez'}, {'days_employed': 235, 'employee_id': 3536268, 'first_name': 'Emma', 'hire_date': '2024-06-20', 'last_name': 'Reyes'}, {'days_employed': 215, 'employee_id': 3536269, 'first_name': 'Noah', 'hire_date': '2024-07-10', 'last_name': 'King'}, {'days_employed': 179, 'employee_id': 3536270, 'first_name': 'Charlotte', 'hire_date': '2024-08-15', 'last_name': 'Cooper'}]","['SELECT employee_id, first_name, last_name, hire_date, CURRENT_DATE - hire_date AS days_employed FROM employee;']",148,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Find the number of days each employee has been employed in the company.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
e.employee_id,
e.first_name,
e.last_name,
(
SELECT
date('now') - e.hire_date
) AS days_employed
FROM
""employee"" AS e;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'DATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Determine the number of employees enrolled in each benefit program.","[{'Number of Employees Enrolled': 1, 'benefit_name': 'Vision Care'}, {'Number of Employees Enrolled': 1, 'benefit_name': 'Pet Insurance'}, {'Number of Employees Enrolled': 1, 'benefit_name': 'Wellness Program'}, {'Number of Employees Enrolled': 1, 'benefit_name': 'Paid Time Off (PTO)'}, {'Number of Employees Enrolled': 1, 'benefit_name': '401(k) Matching'}, {'Number of Employees Enrolled': 1, 'benefit_name': 'Employee Referral Program'}, {'Number of Employees Enrolled': 1, 'benefit_name': 'Professional Development'}, {'Number of Employees Enrolled': 1, 'benefit_name': 'On-site Gym Membership'}, {'Number of Employees Enrolled': 1, 'benefit_name': 'Mobile Phone Allowance'}, {'Number of Employees Enrolled': 1, 'benefit_name': 'Legal Assistance'}, {'Number of Employees Enrolled': 1, 'benefit_name': 'Child Care Assistance'}, {'Number of Employees Enrolled': 1, 'benefit_name': 'Life Insurance'}, {'Number of Employees Enrolled': 1, 'benefit_name': 'Tuition Reimbursement'}, {'Number of Employees Enrolled': 1, 'benefit_name': 'Travel Assistance'}, {'Number of Employees Enrolled': 1, 'benefit_name': 'Health Insurance'}, {'Number of Employees Enrolled': 1, 'benefit_name': 'Employee Recognition Program'}, {'Number of Employees Enrolled': 1, 'benefit_name': 'Stock Options'}, {'Number of Employees Enrolled': 1, 'benefit_name': 'Employee Assistance Program (EAP)'}, {'Number of Employees Enrolled': 1, 'benefit_name': 'Employee Discounts'}, {'Number of Employees Enrolled': 1, 'benefit_name': 'Flexible Spending Account (FSA)'}]","
SELECT b.""benefit_name"", COUNT(eb.""employee_id"") AS ""Number of Employees Enrolled""
FROM ""benefit"" AS b
INNER JOIN ""employee_x_benefit"" AS eb ON b.""benefit_id"" = eb.""benefit_id""
GROUP BY b.""benefit_name"";
```",,"[{'benefit_name': 'Vision Care', 'total_enrolled': 1}, {'benefit_name': 'Pet Insurance', 'total_enrolled': 1}, {'benefit_name': 'Wellness Program', 'total_enrolled': 1}, {'benefit_name': 'Paid Time Off (PTO)', 'total_enrolled': 1}, {'benefit_name': '401(k) Matching', 'total_enrolled': 1}, {'benefit_name': 'Employee Referral Program', 'total_enrolled': 1}, {'benefit_name': 'Professional Development', 'total_enrolled': 1}, {'benefit_name': 'On-site Gym Membership', 'total_enrolled': 1}, {'benefit_name': 'Mobile Phone Allowance', 'total_enrolled': 1}, {'benefit_name': 'Legal Assistance', 'total_enrolled': 1}, {'benefit_name': 'Child Care Assistance', 'total_enrolled': 1}, {'benefit_name': 'Life Insurance', 'total_enrolled': 1}, {'benefit_name': 'Tuition Reimbursement', 'total_enrolled': 1}, {'benefit_name': 'Travel Assistance', 'total_enrolled': 1}, {'benefit_name': 'Health Insurance', 'total_enrolled': 1}, {'benefit_name': 'Employee Recognition Program', 'total_enrolled': 1}, {'benefit_name': 'Stock Options', 'total_enrolled': 1}, {'benefit_name': 'Employee Assistance Program (EAP)', 'total_enrolled': 1}, {'benefit_name': 'Employee Discounts', 'total_enrolled': 1}, {'benefit_name': 'Flexible Spending Account (FSA)', 'total_enrolled': 1}]","['SELECT b.benefit_name, COUNT(eb.employee_id) AS total_enrolled FROM benefit b LEFT JOIN employee_x_benefit eb ON b.benefit_id = eb.benefit_id GROUP BY b.benefit_name;']",93,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Determine the number of employees enrolled in each benefit program.,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT b.""benefit_name"", COUNT(eb.""employee_id"") AS ""Number of Employees Enrolled""
FROM ""benefit"" AS b
INNER JOIN ""employee_x_benefit"" AS eb ON b.""benefit_id"" = eb.""benefit_id""
GROUP BY b.""benefit_name"";
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'LEFT_JOIN', 'AGGREGATE']",
[],db_hr,['postgres'],[],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the address details (street, city, state, zip code) for a 3536259 employee.",,,,,[],172,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Retrieve the address details (street, city, state, zip code) for a 3536259 employee.","{'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""employee_id = 3536259""'}",,dql,2025-02-10 18:36:22.083420,,[],"Cannot get the response text.
Cannot get the Candidate text.
Response candidate content has no parts (and thus no text). The candidate is likely blocked by the safety filters.
Content:
{}
Candidate:
{
  ""finish_reason"": ""SAFETY"",
  ""safety_ratings"": [
    {
      ""category"": ""HARM_CATEGORY_HATE_SPEECH"",
      ""probability"": ""NEGLIGIBLE"",
      ""probability_score"": 0.30664062,
      ""severity"": ""HARM_SEVERITY_LOW"",
      ""severity_score"": 0.27929688
    },
    {
      ""category"": ""HARM_CATEGORY_DANGEROUS_CONTENT"",
      ""probability"": ""MEDIUM"",
      ""blocked"": true,
      ""probability_score"": 0.74609375,
      ""severity"": ""HARM_SEVERITY_MEDIUM"",
      ""severity_score"": 0.42578125
    },
    {
      ""category"": ""HARM_CATEGORY_HARASSMENT"",
      ""probability"": ""NEGLIGIBLE"",
      ""probability_score"": 0.38867188,
      ""severity"": ""HARM_SEVERITY_LOW"",
      ""severity_score"": 0.28125
    },
    {
      ""category"": ""HARM_CATEGORY_SEXUALLY_EXPLICIT"",
      ""probability"": ""NEGLIGIBLE"",
      ""probability_score"": 0.16699219,
      ""severity"": ""HARM_SEVERITY_LOW"",
      ""severity_score"": 0.24511719
    }
  ]
}
Response:
{
  ""candidates"": [
    {
      ""finish_reason"": ""SAFETY"",
      ""safety_ratings"": [
        {
          ""category"": ""HARM_CATEGORY_HATE_SPEECH"",
          ""probability"": ""NEGLIGIBLE"",
          ""probability_score"": 0.30664062,
          ""severity"": ""HARM_SEVERITY_LOW"",
          ""severity_score"": 0.27929688
        },
        {
          ""category"": ""HARM_CATEGORY_DANGEROUS_CONTENT"",
          ""probability"": ""MEDIUM"",
          ""blocked"": true,
          ""probability_score"": 0.74609375,
          ""severity"": ""HARM_SEVERITY_MEDIUM"",
          ""severity_score"": 0.42578125
        },
        {
          ""category"": ""HARM_CATEGORY_HARASSMENT"",
          ""probability"": ""NEGLIGIBLE"",
          ""probability_score"": 0.38867188,
          ""severity"": ""HARM_SEVERITY_LOW"",
          ""severity_score"": 0.28125
        },
        {
          ""category"": ""HARM_CATEGORY_SEXUALLY_EXPLICIT"",
          ""probability"": ""NEGLIGIBLE"",
          ""probability_score"": 0.16699219,
          ""severity"": ""HARM_SEVERITY_LOW"",
          ""severity_score"": 0.24511719
        }
      ]
    }
  ],
  ""usage_metadata"": {
    ""prompt_token_count"": 2162,
    ""total_token_count"": 2162,
    ""prompt_tokens_details"": [
      {
        ""modality"": ""TEXT"",
        ""token_count"": 2162
      }
    ]
  },
  ""model_version"": ""gemini-1.0-pro-002""
}",0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'JSON']",
[],db_hr,['postgres'],[],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Calculate the total cost of travel allowances reimbursed to employees for business trips to locations in the last quarter, categorized by travel destination and purpose","[{'Total Travel Allowance': '1350.00', 'Travel Destination': 'Atlanta, GA', 'Travel Purpose': 'Project Review'}, {'Total Travel Allowance': '1100.00', 'Travel Destination': 'Austin, TX', 'Travel Purpose': 'Workshop'}, {'Total Travel Allowance': '1100.00', 'Travel Destination': 'Boston, MA', 'Travel Purpose': 'Workshop'}, {'Total Travel Allowance': '1500.00', 'Travel Destination': 'Chicago, IL', 'Travel Purpose': 'Client Meeting'}, {'Total Travel Allowance': '800.00', 'Travel Destination': 'Chicago, IL', 'Travel Purpose': 'Training'}, {'Total Travel Allowance': '1200.00', 'Travel Destination': 'Dallas, TX', 'Travel Purpose': 'Vendor Meeting'}, {'Total Travel Allowance': '1700.00', 'Travel Destination': 'Denver, CO', 'Travel Purpose': 'Client Visit'}, {'Total Travel Allowance': '1700.00', 'Travel Destination': 'Houston, TX', 'Travel Purpose': 'Client Visit'}, {'Total Travel Allowance': '1500.00', 'Travel Destination': 'Las Vegas, NV', 'Travel Purpose': 'Conference'}, {'Total Travel Allowance': '1500.00', 'Travel Destination': 'Los Angeles, CA', 'Travel Purpose': 'Business Trip'}, {'Total Travel Allowance': '1600.00', 'Travel Destination': 'Miami, FL', 'Travel Purpose': 'Client Presentation'}, {'Total Travel Allowance': '1600.00', 'Travel Destination': 'Nashville, TN', 'Travel Purpose': 'Client Presentation'}, {'Total Travel Allowance': '1500.00', 'Travel Destination': 'New York, NY', 'Travel Purpose': 'Client Meeting'}, {'Total Travel Allowance': '1350.00', 'Travel Destination': 'Orlando, FL', 'Travel Purpose': 'Project Review'}, {'Total Travel Allowance': '1500.00', 'Travel Destination': 'Phoenix, AZ', 'Travel Purpose': 'Business Trip'}, {'Total Travel Allowance': '1450.00', 'Travel Destination': 'Portland, OR', 'Travel Purpose': 'Project Kickoff'}, {'Total Travel Allowance': '1200.00', 'Travel Destination': 'Salt Lake City, UT', 'Travel Purpose': 'Vendor Meeting'}, {'Total Travel Allowance': '800.00', 'Travel Destination': 'San Diego, CA', 'Travel Purpose': 'Training'}, {'Total Travel Allowance': '1500.00', 'Travel Destination': 'San Francisco, CA', 'Travel Purpose': 'Conference'}, {'Total Travel Allowance': '1450.00', 'Travel Destination': 'Seattle, WA', 'Travel Purpose': 'Project Kickoff'}]","
SELECT
  ""et"".""travel_destination"" AS ""Travel Destination"",
  ""et"".""travel_purpose"" AS ""Travel Purpose"",
  SUM(""ea"".""amount"") AS ""Total Travel Allowance""
FROM ""employee_travel"" AS ""et""
LEFT JOIN ""employee_allowances"" AS ""ea""
  ON ""ea"".""employee_id"" = ""et"".""employee_id""
LEFT JOIN ""allowances"" AS ""al""
  ON ""ea"".""allowance_id"" = ""al"".""allowance_id""
AND ""al"".""allowance"" = 'Travel'
AND ""ea"".""effective_date"" BETWEEN '2023-10-01' AND '2023-12-31'
WHERE
  ""et"".""travel_destination"" IS NOT NULL AND ""et"".""travel_purpose"" IS NOT NULL
GROUP BY
  ""et"".""travel_destination"",
  ""et"".""travel_purpose""
ORDER BY
  ""et"".""travel_destination"",
  ""et"".""travel_purpose"";
```",,[],[],108,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Calculate the total cost of travel allowances reimbursed to employees for business trips to locations in the last quarter, categorized by travel destination and purpose","{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
""et"".""travel_destination"" AS ""Travel Destination"",
""et"".""travel_purpose"" AS ""Travel Purpose"",
SUM(""ea"".""amount"") AS ""Total Travel Allowance""
FROM ""employee_travel"" AS ""et""
LEFT JOIN ""employee_allowances"" AS ""ea""
ON ""ea"".""employee_id"" = ""et"".""employee_id""
LEFT JOIN ""allowances"" AS ""al""
ON ""ea"".""allowance_id"" = ""al"".""allowance_id""
AND ""al"".""allowance"" = 'Travel'
AND ""ea"".""effective_date"" BETWEEN '2023-10-01' AND '2023-12-31'
WHERE
""et"".""travel_destination"" IS NOT NULL AND ""et"".""travel_purpose"" IS NOT NULL
GROUP BY
""et"".""travel_destination"",
""et"".""travel_purpose""
ORDER BY
""et"".""travel_destination"",
""et"".""travel_purpose"";
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'AGGREGATE', 'DATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Break down departments by the highest average performance rating","[{'department_name': 'Marketing'}, {'department_name': 'Sales'}, {'department_name': 'Human Resources'}, {'department_name': 'Finance'}]","
WITH DepartmentPerformance AS (
  SELECT
    d.""department_id"",
    d.""department_name"",
    AVG(p.""performance_rating"") AS avg_performance_rating
  FROM ""department"" AS d
  JOIN ""job_history"" AS jh
    ON d.""department_id"" = jh.""department_id""
  JOIN ""employee"" AS e
    ON jh.""employee_id"" = e.""employee_id""
  JOIN ""performance_review"" AS p
    ON e.""employee_id"" = p.""employee_id""
  GROUP BY
    d.""department_id"",
    d.""department_name""
)
SELECT
  ""department_name""
FROM DepartmentPerformance
ORDER BY
  avg_performance_rating DESC
LIMIT 5;
```",,"[{'avg_performance_rating': '4.2500000000000000', 'department_id': 3}, {'avg_performance_rating': '4.2142857142857143', 'department_id': 2}, {'avg_performance_rating': '4.2000000000000000', 'department_id': 1}]","['SELECT department_id, AVG(performance_rating) AS avg_performance_rating FROM performance_review JOIN employee ON performance_review.employee_id = employee.employee_id GROUP BY department_id ORDER BY avg_performance_rating DESC;']",15,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Break down departments by the highest average performance rating,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH DepartmentPerformance AS (
SELECT
d.""department_id"",
d.""department_name"",
AVG(p.""performance_rating"") AS avg_performance_rating
FROM ""department"" AS d
JOIN ""job_history"" AS jh
ON d.""department_id"" = jh.""department_id""
JOIN ""employee"" AS e
ON jh.""employee_id"" = e.""employee_id""
JOIN ""performance_review"" AS p
ON e.""employee_id"" = p.""employee_id""
GROUP BY
d.""department_id"",
d.""department_name""
)
SELECT
""department_name""
FROM DepartmentPerformance
ORDER BY
avg_performance_rating DESC
LIMIT 5;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'AGGREGATE', 'SORT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


How many employees were promoted in 2020?",[{'Total employees promoted in 2020': 0}],"
SELECT COUNT(*) AS ""Total employees promoted in 2020""
FROM job_history AS jh
JOIN employee AS e ON jh.employee_id = e.employee_id
WHERE jh.start_date BETWEEN '2020-01-01' AND '2020-12-31'
AND jh.end_date IS NULL;

```",,[{'total_promotions': 6}],"[""SELECT COUNT(*) AS total_promotions FROM job_history WHERE start_date >= '2020-01-01' AND start_date < '2021-01-01'""]",11,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,How many employees were promoted in 2020?,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT COUNT(*) AS ""Total employees promoted in 2020""
FROM job_history AS jh
JOIN employee AS e ON jh.employee_id = e.employee_id
WHERE jh.start_date BETWEEN '2020-01-01' AND '2020-12-31'
AND jh.end_date IS NULL;

",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'AGGREGATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Provide the bank account details (account number, bank name, branch) for a particular employee.",,,,,"[""SELECT bank_account_number->>'account_number' AS account_number, bank_account_number->>'bank_name' AS bank_name, bank_account_number->>'branch' AS branch FROM employee WHERE employee_id = 3536259;""]",173,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Provide the bank account details (account number, bank name, branch) for a particular employee.","{'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""employee_id = 3536259""'}",,dql,2025-02-10 18:36:22.083420,,[],"Cannot get the response text.
Cannot get the Candidate text.
Response candidate content has no parts (and thus no text). The candidate is likely blocked by the safety filters.
Content:
{}
Candidate:
{
  ""finish_reason"": ""SAFETY"",
  ""safety_ratings"": [
    {
      ""category"": ""HARM_CATEGORY_HATE_SPEECH"",
      ""probability"": ""NEGLIGIBLE"",
      ""probability_score"": 0.29492188,
      ""severity"": ""HARM_SEVERITY_NEGLIGIBLE"",
      ""severity_score"": 0.1953125
    },
    {
      ""category"": ""HARM_CATEGORY_DANGEROUS_CONTENT"",
      ""probability"": ""MEDIUM"",
      ""blocked"": true,
      ""probability_score"": 0.640625,
      ""severity"": ""HARM_SEVERITY_MEDIUM"",
      ""severity_score"": 0.4140625
    },
    {
      ""category"": ""HARM_CATEGORY_HARASSMENT"",
      ""probability"": ""NEGLIGIBLE"",
      ""probability_score"": 0.39257812,
      ""severity"": ""HARM_SEVERITY_NEGLIGIBLE"",
      ""severity_score"": 0.19042969
    },
    {
      ""category"": ""HARM_CATEGORY_SEXUALLY_EXPLICIT"",
      ""probability"": ""NEGLIGIBLE"",
      ""probability_score"": 0.22558594,
      ""severity"": ""HARM_SEVERITY_NEGLIGIBLE"",
      ""severity_score"": 0.19726562
    }
  ]
}
Response:
{
  ""candidates"": [
    {
      ""finish_reason"": ""SAFETY"",
      ""safety_ratings"": [
        {
          ""category"": ""HARM_CATEGORY_HATE_SPEECH"",
          ""probability"": ""NEGLIGIBLE"",
          ""probability_score"": 0.29492188,
          ""severity"": ""HARM_SEVERITY_NEGLIGIBLE"",
          ""severity_score"": 0.1953125
        },
        {
          ""category"": ""HARM_CATEGORY_DANGEROUS_CONTENT"",
          ""probability"": ""MEDIUM"",
          ""blocked"": true,
          ""probability_score"": 0.640625,
          ""severity"": ""HARM_SEVERITY_MEDIUM"",
          ""severity_score"": 0.4140625
        },
        {
          ""category"": ""HARM_CATEGORY_HARASSMENT"",
          ""probability"": ""NEGLIGIBLE"",
          ""probability_score"": 0.39257812,
          ""severity"": ""HARM_SEVERITY_NEGLIGIBLE"",
          ""severity_score"": 0.19042969
        },
        {
          ""category"": ""HARM_CATEGORY_SEXUALLY_EXPLICIT"",
          ""probability"": ""NEGLIGIBLE"",
          ""probability_score"": 0.22558594,
          ""severity"": ""HARM_SEVERITY_NEGLIGIBLE"",
          ""severity_score"": 0.19726562
        }
      ]
    }
  ],
  ""usage_metadata"": {
    ""prompt_token_count"": 2155,
    ""total_token_count"": 2155,
    ""prompt_tokens_details"": [
      {
        ""modality"": ""TEXT"",
        ""token_count"": 2155
      }
    ]
  },
  ""model_version"": ""gemini-1.0-pro-002""
}",0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JSON']",
[],db_hr,['postgres'],[],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the names of employees who live in a Newtown city .",,,,,[],176,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve the names of employees who live in a Newtown city .,"{'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""address->>\'$.city\' = \'Newtown\'""'}",,dql,2025-02-10 18:36:22.083420,,[],"Cannot get the response text.
Cannot get the Candidate text.
Response candidate content has no parts (and thus no text). The candidate is likely blocked by the safety filters.
Content:
{}
Candidate:
{
  ""finish_reason"": ""SAFETY"",
  ""safety_ratings"": [
    {
      ""category"": ""HARM_CATEGORY_HATE_SPEECH"",
      ""probability"": ""NEGLIGIBLE"",
      ""probability_score"": 0.25195312,
      ""severity"": ""HARM_SEVERITY_NEGLIGIBLE"",
      ""severity_score"": 0.171875
    },
    {
      ""category"": ""HARM_CATEGORY_DANGEROUS_CONTENT"",
      ""probability"": ""MEDIUM"",
      ""blocked"": true,
      ""probability_score"": 0.69921875,
      ""severity"": ""HARM_SEVERITY_LOW"",
      ""severity_score"": 0.296875
    },
    {
      ""category"": ""HARM_CATEGORY_HARASSMENT"",
      ""probability"": ""NEGLIGIBLE"",
      ""probability_score"": 0.38867188,
      ""severity"": ""HARM_SEVERITY_LOW"",
      ""severity_score"": 0.28710938
    },
    {
      ""category"": ""HARM_CATEGORY_SEXUALLY_EXPLICIT"",
      ""probability"": ""NEGLIGIBLE"",
      ""probability_score"": 0.15039062,
      ""severity"": ""HARM_SEVERITY_LOW"",
      ""severity_score"": 0.25585938
    }
  ]
}
Response:
{
  ""candidates"": [
    {
      ""finish_reason"": ""SAFETY"",
      ""safety_ratings"": [
        {
          ""category"": ""HARM_CATEGORY_HATE_SPEECH"",
          ""probability"": ""NEGLIGIBLE"",
          ""probability_score"": 0.25195312,
          ""severity"": ""HARM_SEVERITY_NEGLIGIBLE"",
          ""severity_score"": 0.171875
        },
        {
          ""category"": ""HARM_CATEGORY_DANGEROUS_CONTENT"",
          ""probability"": ""MEDIUM"",
          ""blocked"": true,
          ""probability_score"": 0.69921875,
          ""severity"": ""HARM_SEVERITY_LOW"",
          ""severity_score"": 0.296875
        },
        {
          ""category"": ""HARM_CATEGORY_HARASSMENT"",
          ""probability"": ""NEGLIGIBLE"",
          ""probability_score"": 0.38867188,
          ""severity"": ""HARM_SEVERITY_LOW"",
          ""severity_score"": 0.28710938
        },
        {
          ""category"": ""HARM_CATEGORY_SEXUALLY_EXPLICIT"",
          ""probability"": ""NEGLIGIBLE"",
          ""probability_score"": 0.15039062,
          ""severity"": ""HARM_SEVERITY_LOW"",
          ""severity_score"": 0.25585938
        }
      ]
    }
  ],
  ""usage_metadata"": {
    ""prompt_token_count"": 2148,
    ""total_token_count"": 2148,
    ""prompt_tokens_details"": [
      {
        ""modality"": ""TEXT"",
        ""token_count"": 2148
      }
    ]
  },
  ""model_version"": ""gemini-1.0-pro-002""
}",0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT']",
[],db_hr,['postgres'],[],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


What is the average salary in the company based on hiring year?","[{'avg': '75000.000000000000', 'hire_date': '2023-02-28'}, {'avg': '70000.000000000000', 'hire_date': '2024-01-10'}, {'avg': '60000.000000000000', 'hire_date': '2023-10-05'}, {'avg': '65000.000000000000', 'hire_date': '2023-05-20'}, {'avg': '75000.000000000000', 'hire_date': '2024-05-15'}, {'avg': '70000.000000000000', 'hire_date': '2023-08-25'}, {'avg': '80000.000000000000', 'hire_date': '2024-02-15'}, {'avg': '65000.000000000000', 'hire_date': '2024-06-20'}, {'avg': '80000.000000000000', 'hire_date': '2024-08-15'}, {'avg': '65000.000000000000', 'hire_date': '2023-12-20'}, {'avg': '60000.000000000000', 'hire_date': '2023-01-15'}, {'avg': '85000.000000000000', 'hire_date': '2023-09-10'}, {'avg': '70000.000000000000', 'hire_date': '2024-07-10'}, {'avg': '70000.000000000000', 'hire_date': '2024-04-05'}, {'avg': '60000.000000000000', 'hire_date': '2023-06-15'}, {'avg': '80000.000000000000', 'hire_date': '2023-07-10'}, {'avg': '70000.000000000000', 'hire_date': '2023-03-10'}, {'avg': '90000.000000000000', 'hire_date': '2024-03-20'}, {'avg': '75000.000000000000', 'hire_date': '2023-11-15'}, {'avg': '55000.000000000000', 'hire_date': '2023-04-05'}]","
SELECT
  e.hire_date,
  AVG(s.salary)
FROM employee AS e
JOIN salary AS s
  ON e.employee_id = s.employee_id
GROUP BY
  e.hire_date;
```",,"[{'avg_salary': '75000.000000000000', 'hire_year': 2024.0}, {'avg_salary': '68333.333333333333', 'hire_year': 2023.0}]","[""SELECT date_part('year', hire_date) AS hire_year, AVG(salary) AS avg_salary FROM employee JOIN salary ON employee.employee_id = salary.employee_id GROUP BY hire_year;""]",3,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,What is the average salary in the company based on hiring year?,"{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
e.hire_date,
AVG(s.salary)
FROM employee AS e
JOIN salary AS s
ON e.employee_id = s.employee_id
GROUP BY
e.hire_date;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'JOIN', 'AGGREGATE', 'DATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Calculate the age of each employee based on their date of birth.","[{'age': '39 years 8 months 26 days', 'date_of_birth': '1985-05-15', 'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe'}, {'age': '34 years 3 months 16 days', 'date_of_birth': '1990-10-25', 'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith'}, {'age': '36 years 5 months 21 days', 'date_of_birth': '1988-08-20', 'employee_id': 3536253, 'first_name': 'Michael', 'last_name': 'Johnson'}, {'age': '32 years 9 months 28 days', 'date_of_birth': '1992-04-12', 'employee_id': 3536254, 'first_name': 'Emily', 'last_name': 'Williams'}, {'age': '29 years 3 months 7 days', 'date_of_birth': '1995-11-03', 'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown'}, {'age': '38 years 6 months 23 days', 'date_of_birth': '1986-07-18', 'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones'}, {'age': '34 years 11 months 10 days', 'date_of_birth': '1990-02-28', 'employee_id': 3536257, 'first_name': 'Christopher', 'last_name': 'Davis'}, {'age': '35 years 4 months 25 days', 'date_of_birth': '1989-09-15', 'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez'}, {'age': '37 years 2 months', 'date_of_birth': '1987-12-10', 'employee_id': 3536259, 'first_name': 'Daniel', 'last_name': 'Garcia'}, {'age': '31 years 7 months 20 days', 'date_of_birth': '1993-06-20', 'employee_id': 3536260, 'first_name': 'Taylor', 'last_name': 'Rodriguez'}, {'age': '39 years 11 months 5 days', 'date_of_birth': '1985-03-05', 'employee_id': 3536261, 'first_name': 'David', 'last_name': 'Lopez'}, {'age': '33 years 5 months 29 days', 'date_of_birth': '1991-08-12', 'employee_id': 3536262, 'first_name': 'Megan', 'last_name': 'Hernandez'}, {'age': '40 years 2 months 10 days', 'date_of_birth': '1984-11-30', 'employee_id': 3536263, 'first_name': 'Andrew', 'last_name': 'Gonzalez'}, {'age': '30 years 11 months 20 days', 'date_of_birth': '1994-02-18', 'employee_id': 3536264, 'first_name': 'Sophia', 'last_name': 'Perez'}, {'age': '36 years 4 months 18 days', 'date_of_birth': '1988-09-22', 'employee_id': 3536265, 'first_name': 'Aiden', 'last_name': 'Torres'}, {'age': '34 years 10 months 2 days', 'date_of_birth': '1990-04-08', 'employee_id': 3536266, 'first_name': 'Olivia', 'last_name': 'Rivera'}, {'age': '33 years 27 days', 'date_of_birth': '1992-01-14', 'employee_id': 3536267, 'first_name': 'Liam', 'last_name': 'Gomez'}, {'age': '37 years 8 months 15 days', 'date_of_birth': '1987-05-26', 'employee_id': 3536268, 'first_name': 'Emma', 'last_name': 'Reyes'}, {'age': '36 years 6 months 6 days', 'date_of_birth': '1988-08-04', 'employee_id': 3536269, 'first_name': 'Noah', 'last_name': 'King'}, {'age': '34 years', 'date_of_birth': '1991-02-10', 'employee_id': 3536270, 'first_name': 'Charlotte', 'last_name': 'Cooper'}]","
-- Calculate age based on date of birth
SELECT
    e.employee_id,
    e.first_name,
    e.last_name,
    e.date_of_birth,
    AGE(e.date_of_birth) AS age
FROM
    employee AS e;
```",,"[{'age': '39', 'date_of_birth': '1985-05-15', 'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe'}, {'age': '34', 'date_of_birth': '1990-10-25', 'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith'}, {'age': '36', 'date_of_birth': '1988-08-20', 'employee_id': 3536253, 'first_name': 'Michael', 'last_name': 'Johnson'}, {'age': '32', 'date_of_birth': '1992-04-12', 'employee_id': 3536254, 'first_name': 'Emily', 'last_name': 'Williams'}, {'age': '29', 'date_of_birth': '1995-11-03', 'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown'}, {'age': '38', 'date_of_birth': '1986-07-18', 'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones'}, {'age': '34', 'date_of_birth': '1990-02-28', 'employee_id': 3536257, 'first_name': 'Christopher', 'last_name': 'Davis'}, {'age': '35', 'date_of_birth': '1989-09-15', 'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez'}, {'age': '37', 'date_of_birth': '1987-12-10', 'employee_id': 3536259, 'first_name': 'Daniel', 'last_name': 'Garcia'}, {'age': '31', 'date_of_birth': '1993-06-20', 'employee_id': 3536260, 'first_name': 'Taylor', 'last_name': 'Rodriguez'}, {'age': '39', 'date_of_birth': '1985-03-05', 'employee_id': 3536261, 'first_name': 'David', 'last_name': 'Lopez'}, {'age': '33', 'date_of_birth': '1991-08-12', 'employee_id': 3536262, 'first_name': 'Megan', 'last_name': 'Hernandez'}, {'age': '40', 'date_of_birth': '1984-11-30', 'employee_id': 3536263, 'first_name': 'Andrew', 'last_name': 'Gonzalez'}, {'age': '30', 'date_of_birth': '1994-02-18', 'employee_id': 3536264, 'first_name': 'Sophia', 'last_name': 'Perez'}, {'age': '36', 'date_of_birth': '1988-09-22', 'employee_id': 3536265, 'first_name': 'Aiden', 'last_name': 'Torres'}, {'age': '34', 'date_of_birth': '1990-04-08', 'employee_id': 3536266, 'first_name': 'Olivia', 'last_name': 'Rivera'}, {'age': '33', 'date_of_birth': '1992-01-14', 'employee_id': 3536267, 'first_name': 'Liam', 'last_name': 'Gomez'}, {'age': '37', 'date_of_birth': '1987-05-26', 'employee_id': 3536268, 'first_name': 'Emma', 'last_name': 'Reyes'}, {'age': '36', 'date_of_birth': '1988-08-04', 'employee_id': 3536269, 'first_name': 'Noah', 'last_name': 'King'}, {'age': '34', 'date_of_birth': '1991-02-10', 'employee_id': 3536270, 'first_name': 'Charlotte', 'last_name': 'Cooper'}]","['SELECT employee_id, first_name, last_name, date_of_birth, EXTRACT(YEAR FROM AGE(CURRENT_DATE, date_of_birth)) AS age FROM employee;']",150,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Calculate the age of each employee based on their date of birth.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
-- Calculate age based on date of birth
SELECT
e.employee_id,
e.first_name,
e.last_name,
e.date_of_birth,
AGE(e.date_of_birth) AS age
FROM
employee AS e;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'DATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find the total number of leave days requested by each employee.","[{'employee_id': 3536262, 'first_name': 'Megan', 'last_name': 'Hernandez', 'total_leave_days': '60.00'}, {'employee_id': 3536253, 'first_name': 'Michael', 'last_name': 'Johnson', 'total_leave_days': '60.00'}, {'employee_id': 3536268, 'first_name': 'Emma', 'last_name': 'Reyes', 'total_leave_days': '6.00'}, {'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez', 'total_leave_days': '6.00'}, {'employee_id': 3536260, 'first_name': 'Taylor', 'last_name': 'Rodriguez', 'total_leave_days': '6.00'}, {'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones', 'total_leave_days': '5.00'}, {'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe', 'total_leave_days': '5.00'}, {'employee_id': 3536266, 'first_name': 'Olivia', 'last_name': 'Rivera', 'total_leave_days': '4.00'}, {'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith', 'total_leave_days': '3.00'}, {'employee_id': 3536267, 'first_name': 'Liam', 'last_name': 'Gomez', 'total_leave_days': '3.00'}, {'employee_id': 3536259, 'first_name': 'Daniel', 'last_name': 'Garcia', 'total_leave_days': '3.00'}, {'employee_id': 3536254, 'first_name': 'Emily', 'last_name': 'Williams', 'total_leave_days': '3.00'}, {'employee_id': 3536264, 'first_name': 'Sophia', 'last_name': 'Perez', 'total_leave_days': '3.00'}, {'employee_id': 3536270, 'first_name': 'Charlotte', 'last_name': 'Cooper', 'total_leave_days': '2.00'}, {'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown', 'total_leave_days': '2.00'}, {'employee_id': 3536257, 'first_name': 'Christopher', 'last_name': 'Davis', 'total_leave_days': '2.00'}, {'employee_id': 3536261, 'first_name': 'David', 'last_name': 'Lopez', 'total_leave_days': '2.00'}, {'employee_id': 3536263, 'first_name': 'Andrew', 'last_name': 'Gonzalez', 'total_leave_days': '2.00'}, {'employee_id': 3536265, 'first_name': 'Aiden', 'last_name': 'Torres', 'total_leave_days': '2.00'}, {'employee_id': 3536269, 'first_name': 'Noah', 'last_name': 'King', 'total_leave_days': '2.00'}]","
WITH LeaveRequestTotalDays AS (
    SELECT employee_id, SUM(duration) AS total_leave_days
    FROM leave_request
    GROUP BY employee_id
)
SELECT e.employee_id, e.first_name, e.last_name, lt.total_leave_days
FROM employee e
JOIN LeaveRequestTotalDays lt ON e.employee_id = lt.employee_id
ORDER BY total_leave_days DESC;
```",,"[{'employee_id': 3536261, 'total_leave_days': '2.00'}, {'employee_id': 3536264, 'total_leave_days': '3.00'}, {'employee_id': 3536251, 'total_leave_days': '5.00'}, {'employee_id': 3536269, 'total_leave_days': '2.00'}, {'employee_id': 3536268, 'total_leave_days': '6.00'}, {'employee_id': 3536254, 'total_leave_days': '3.00'}, {'employee_id': 3536260, 'total_leave_days': '6.00'}, {'employee_id': 3536253, 'total_leave_days': '60.00'}, {'employee_id': 3536262, 'total_leave_days': '60.00'}, {'employee_id': 3536270, 'total_leave_days': '2.00'}, {'employee_id': 3536267, 'total_leave_days': '3.00'}, {'employee_id': 3536266, 'total_leave_days': '4.00'}, {'employee_id': 3536257, 'total_leave_days': '2.00'}, {'employee_id': 3536255, 'total_leave_days': '2.00'}, {'employee_id': 3536265, 'total_leave_days': '2.00'}, {'employee_id': 3536252, 'total_leave_days': '3.00'}, {'employee_id': 3536258, 'total_leave_days': '6.00'}, {'employee_id': 3536259, 'total_leave_days': '3.00'}, {'employee_id': 3536256, 'total_leave_days': '5.00'}, {'employee_id': 3536263, 'total_leave_days': '2.00'}]","['SELECT employee_id, SUM(duration) AS total_leave_days FROM leave_request GROUP BY employee_id;']",145,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Find the total number of leave days requested by each employee.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH LeaveRequestTotalDays AS (
SELECT employee_id, SUM(duration) AS total_leave_days
FROM leave_request
GROUP BY employee_id
)
SELECT e.employee_id, e.first_name, e.last_name, lt.total_leave_days
FROM employee e
JOIN LeaveRequestTotalDays lt ON e.employee_id = lt.employee_id
ORDER BY total_leave_days DESC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the full name of each employee by concatenating their first name and last name.","[{'first_name': 'John', 'full_name': 'John Doe', 'last_name': 'Doe'}, {'first_name': 'Alice', 'full_name': 'Alice Smith', 'last_name': 'Smith'}, {'first_name': 'Michael', 'full_name': 'Michael Johnson', 'last_name': 'Johnson'}, {'first_name': 'Emily', 'full_name': 'Emily Williams', 'last_name': 'Williams'}, {'first_name': 'Matthew', 'full_name': 'Matthew Brown', 'last_name': 'Brown'}, {'first_name': 'Sarah', 'full_name': 'Sarah Jones', 'last_name': 'Jones'}, {'first_name': 'Christopher', 'full_name': 'Christopher Davis', 'last_name': 'Davis'}, {'first_name': 'Jessica', 'full_name': 'Jessica Martinez', 'last_name': 'Martinez'}, {'first_name': 'Daniel', 'full_name': 'Daniel Garcia', 'last_name': 'Garcia'}, {'first_name': 'Taylor', 'full_name': 'Taylor Rodriguez', 'last_name': 'Rodriguez'}, {'first_name': 'David', 'full_name': 'David Lopez', 'last_name': 'Lopez'}, {'first_name': 'Megan', 'full_name': 'Megan Hernandez', 'last_name': 'Hernandez'}, {'first_name': 'Andrew', 'full_name': 'Andrew Gonzalez', 'last_name': 'Gonzalez'}, {'first_name': 'Sophia', 'full_name': 'Sophia Perez', 'last_name': 'Perez'}, {'first_name': 'Aiden', 'full_name': 'Aiden Torres', 'last_name': 'Torres'}, {'first_name': 'Olivia', 'full_name': 'Olivia Rivera', 'last_name': 'Rivera'}, {'first_name': 'Liam', 'full_name': 'Liam Gomez', 'last_name': 'Gomez'}, {'first_name': 'Emma', 'full_name': 'Emma Reyes', 'last_name': 'Reyes'}, {'first_name': 'Noah', 'full_name': 'Noah King', 'last_name': 'King'}, {'first_name': 'Charlotte', 'full_name': 'Charlotte Cooper', 'last_name': 'Cooper'}]","SELECT first_name, last_name, (first_name || ' ' || last_name) AS full_name FROM employee;
",,"[{'employee_id': 3536251, 'full_name': 'John Doe'}, {'employee_id': 3536252, 'full_name': 'Alice Smith'}, {'employee_id': 3536253, 'full_name': 'Michael Johnson'}, {'employee_id': 3536254, 'full_name': 'Emily Williams'}, {'employee_id': 3536255, 'full_name': 'Matthew Brown'}, {'employee_id': 3536256, 'full_name': 'Sarah Jones'}, {'employee_id': 3536257, 'full_name': 'Christopher Davis'}, {'employee_id': 3536258, 'full_name': 'Jessica Martinez'}, {'employee_id': 3536259, 'full_name': 'Daniel Garcia'}, {'employee_id': 3536260, 'full_name': 'Taylor Rodriguez'}, {'employee_id': 3536261, 'full_name': 'David Lopez'}, {'employee_id': 3536262, 'full_name': 'Megan Hernandez'}, {'employee_id': 3536263, 'full_name': 'Andrew Gonzalez'}, {'employee_id': 3536264, 'full_name': 'Sophia Perez'}, {'employee_id': 3536265, 'full_name': 'Aiden Torres'}, {'employee_id': 3536266, 'full_name': 'Olivia Rivera'}, {'employee_id': 3536267, 'full_name': 'Liam Gomez'}, {'employee_id': 3536268, 'full_name': 'Emma Reyes'}, {'employee_id': 3536269, 'full_name': 'Noah King'}, {'employee_id': 3536270, 'full_name': 'Charlotte Cooper'}]","[""SELECT employee_id, CONCAT(first_name, ' ', last_name) AS full_name FROM employee;""]",149,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve the full name of each employee by concatenating their first name and last name.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"SELECT first_name, last_name, (first_name || ' ' || last_name) AS full_name FROM employee;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'CONCAT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Identify the employee with the longest tenure in the company.","[{'address': {'city': 'Anothertown', 'state': 'FL', 'street': '123 Walnut St', 'zip': '98765'}, 'email': 'charlotte.cooper@example.com', 'first_name': 'Charlotte', 'hire_date': '2024-08-15', 'last_name': 'Cooper', 'phone_number': '222-333-4444'}]","
SELECT
  e.""first_name"",
  e.""last_name"",
  e.""hire_date"",
  e.""email"",
  e.""phone_number"",
  e.""address""
FROM ""employee"" AS e
WHERE
  ""hire_date"" = (
    SELECT
      MAX(""hire_date"")
    FROM ""employee""
  );
```",,"[{'employee_id': 3536251, 'first_name': 'John', 'hire_date': '2023-01-15', 'last_name': 'Doe'}]","['SELECT employee_id, first_name, last_name, hire_date FROM ( SELECT employee_id, first_name, last_name, hire_date, DENSE_RANK() OVER (ORDER BY hire_date) AS tenure_rank FROM employee ) AS ranked_employees WHERE tenure_rank = 1;']",140,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Identify the employee with the longest tenure in the company.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
e.""first_name"",
e.""last_name"",
e.""hire_date"",
e.""email"",
e.""phone_number"",
e.""address""
FROM ""employee"" AS e
WHERE
""hire_date"" = (
SELECT
MAX(""hire_date"")
FROM ""employee""
);
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'DENSE_RANK']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Rank employees based on their salaries within each department.","[{'department_name': 'Finance', 'employee_id': 3536265, 'first_name': 'Aiden', 'last_name': 'Torres', 'salary': '90000.00', 'salary_rank': 1}, {'department_name': 'Finance', 'employee_id': 3536259, 'first_name': 'Daniel', 'last_name': 'Garcia', 'salary': '85000.00', 'salary_rank': 2}, {'department_name': 'Finance', 'employee_id': 3536253, 'first_name': 'Michael', 'last_name': 'Johnson', 'salary': '75000.00', 'salary_rank': 3}, {'department_name': 'Finance', 'employee_id': 3536268, 'first_name': 'Emma', 'last_name': 'Reyes', 'salary': '65000.00', 'salary_rank': 4}, {'department_name': 'Finance', 'employee_id': 3536262, 'first_name': 'Megan', 'last_name': 'Hernandez', 'salary': '65000.00', 'salary_rank': 4}, {'department_name': 'Finance', 'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones', 'salary': '60000.00', 'salary_rank': 6}, {'department_name': 'Human Resources', 'employee_id': 3536257, 'first_name': 'Christopher', 'last_name': 'Davis', 'salary': '80000.00', 'salary_rank': 1}, {'department_name': 'Human Resources', 'employee_id': 3536269, 'first_name': 'Noah', 'last_name': 'King', 'salary': '70000.00', 'salary_rank': 2}, {'department_name': 'Human Resources', 'employee_id': 3536266, 'first_name': 'Olivia', 'last_name': 'Rivera', 'salary': '70000.00', 'salary_rank': 2}, {'department_name': 'Human Resources', 'employee_id': 3536263, 'first_name': 'Andrew', 'last_name': 'Gonzalez', 'salary': '70000.00', 'salary_rank': 2}, {'department_name': 'Human Resources', 'employee_id': 3536260, 'first_name': 'Taylor', 'last_name': 'Rodriguez', 'salary': '60000.00', 'salary_rank': 5}, {'department_name': 'Human Resources', 'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe', 'salary': '60000.00', 'salary_rank': 5}, {'department_name': 'Human Resources', 'employee_id': 3536254, 'first_name': 'Emily', 'last_name': 'Williams', 'salary': '55000.00', 'salary_rank': 7}, {'department_name': 'Marketing', 'employee_id': 3536270, 'first_name': 'Charlotte', 'last_name': 'Cooper', 'salary': '80000.00', 'salary_rank': 1}, {'department_name': 'Marketing', 'employee_id': 3536264, 'first_name': 'Sophia', 'last_name': 'Perez', 'salary': '80000.00', 'salary_rank': 1}, {'department_name': 'Marketing', 'employee_id': 3536267, 'first_name': 'Liam', 'last_name': 'Gomez', 'salary': '75000.00', 'salary_rank': 3}, {'department_name': 'Marketing', 'employee_id': 3536261, 'first_name': 'David', 'last_name': 'Lopez', 'salary': '75000.00', 'salary_rank': 3}, {'department_name': 'Marketing', 'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith', 'salary': '70000.00', 'salary_rank': 5}, {'department_name': 'Marketing', 'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez', 'salary': '70000.00', 'salary_rank': 5}, {'department_name': 'Marketing', 'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown', 'salary': '65000.00', 'salary_rank': 7}]","
WITH RankedEmployees AS (
  SELECT
    e.employee_id,
    e.first_name,
    e.last_name,
    s.salary,
    d.department_name,
    RANK() OVER (PARTITION BY d.department_id ORDER BY s.salary DESC) AS salary_rank
  FROM employee AS e
  JOIN salary AS s
    ON e.employee_id = s.employee_id
  JOIN department AS d
    ON e.department_id = d.department_id
)
SELECT
  re.employee_id,
  re.first_name,
  re.last_name,
  re.salary,
  re.department_name,
  re.salary_rank
FROM RankedEmployees AS re
ORDER BY
  re.department_name,
  re.salary_rank;
```",,"[{'department_id': 1, 'employee_id': 3536257, 'first_name': 'Christopher', 'last_name': 'Davis', 'salary_rank': 1}, {'department_id': 1, 'employee_id': 3536269, 'first_name': 'Noah', 'last_name': 'King', 'salary_rank': 2}, {'department_id': 1, 'employee_id': 3536266, 'first_name': 'Olivia', 'last_name': 'Rivera', 'salary_rank': 2}, {'department_id': 1, 'employee_id': 3536263, 'first_name': 'Andrew', 'last_name': 'Gonzalez', 'salary_rank': 2}, {'department_id': 1, 'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe', 'salary_rank': 5}, {'department_id': 1, 'employee_id': 3536260, 'first_name': 'Taylor', 'last_name': 'Rodriguez', 'salary_rank': 5}, {'department_id': 1, 'employee_id': 3536254, 'first_name': 'Emily', 'last_name': 'Williams', 'salary_rank': 7}, {'department_id': 2, 'employee_id': 3536270, 'first_name': 'Charlotte', 'last_name': 'Cooper', 'salary_rank': 1}, {'department_id': 2, 'employee_id': 3536264, 'first_name': 'Sophia', 'last_name': 'Perez', 'salary_rank': 1}, {'department_id': 2, 'employee_id': 3536261, 'first_name': 'David', 'last_name': 'Lopez', 'salary_rank': 3}, {'department_id': 2, 'employee_id': 3536267, 'first_name': 'Liam', 'last_name': 'Gomez', 'salary_rank': 3}, {'department_id': 2, 'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez', 'salary_rank': 5}, {'department_id': 2, 'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith', 'salary_rank': 5}, {'department_id': 2, 'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown', 'salary_rank': 7}, {'department_id': 3, 'employee_id': 3536265, 'first_name': 'Aiden', 'last_name': 'Torres', 'salary_rank': 1}, {'department_id': 3, 'employee_id': 3536259, 'first_name': 'Daniel', 'last_name': 'Garcia', 'salary_rank': 2}, {'department_id': 3, 'employee_id': 3536253, 'first_name': 'Michael', 'last_name': 'Johnson', 'salary_rank': 3}, {'department_id': 3, 'employee_id': 3536262, 'first_name': 'Megan', 'last_name': 'Hernandez', 'salary_rank': 4}, {'department_id': 3, 'employee_id': 3536268, 'first_name': 'Emma', 'last_name': 'Reyes', 'salary_rank': 4}, {'department_id': 3, 'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones', 'salary_rank': 6}]","['SELECT e.employee_id, e.first_name, e.last_name, e.department_id, RANK() OVER (PARTITION BY e.department_id ORDER BY s.salary DESC) AS salary_rank FROM employee e JOIN salary s ON e.employee_id = s.employee_id;']",142,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Rank employees based on their salaries within each department.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH RankedEmployees AS (
SELECT
e.employee_id,
e.first_name,
e.last_name,
s.salary,
d.department_name,
RANK() OVER (PARTITION BY d.department_id ORDER BY s.salary DESC) AS salary_rank
FROM employee AS e
JOIN salary AS s
ON e.employee_id = s.employee_id
JOIN department AS d
ON e.department_id = d.department_id
)
SELECT
re.employee_id,
re.first_name,
re.last_name,
re.salary,
re.department_name,
re.salary_rank
FROM RankedEmployees AS re
ORDER BY
re.department_name,
re.salary_rank;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'RANK', 'JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find employees who have expenses in categories related to either Travel or Meals.","[{'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe'}, {'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith'}, {'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith'}, {'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown'}, {'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones'}, {'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez'}, {'employee_id': 3536259, 'first_name': 'Daniel', 'last_name': 'Garcia'}]","
SELECT ""employee"".""employee_id"", ""employee"".""first_name"", ""employee"".""last_name""
FROM ""employee""
JOIN ""employee_business_expense"" AS ""ebe"" ON ""employee"".""employee_id"" = ""ebe"".""employee_id""
WHERE ""ebe"".""expense_category"" IN ('Travel', 'Meals');
```",,"[{'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe'}, {'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith'}, {'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown'}, {'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones'}, {'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez'}, {'employee_id': 3536259, 'first_name': 'Daniel', 'last_name': 'Garcia'}]","[""SELECT e.employee_id, e.first_name, e.last_name FROM employee e WHERE EXISTS ( SELECT 1 FROM employee_business_expense ebe WHERE ebe.employee_id = e.employee_id AND ebe.expense_category IN ('Travel', 'Meals') );""]",153,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Find employees who have expenses in categories related to either Travel or Meals.,"{'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""expense_category IN (\'Travel\', \'Meals\')""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT ""employee"".""employee_id"", ""employee"".""first_name"", ""employee"".""last_name""
FROM ""employee""
JOIN ""employee_business_expense"" AS ""ebe"" ON ""employee"".""employee_id"" = ""ebe"".""employee_id""
WHERE ""ebe"".""expense_category"" IN ('Travel', 'Meals');
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Calculate the total expenses incurred by each employee by summing their business expenses.","[{'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe', 'total_expenses': '390.00'}, {'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith', 'total_expenses': '170.50'}, {'employee_id': 3536253, 'first_name': 'Michael', 'last_name': 'Johnson', 'total_expenses': '175.00'}, {'employee_id': 3536254, 'first_name': 'Emily', 'last_name': 'Williams', 'total_expenses': '260.00'}, {'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown', 'total_expenses': '170.95'}, {'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones', 'total_expenses': '545.75'}, {'employee_id': 3536257, 'first_name': 'Christopher', 'last_name': 'Davis', 'total_expenses': '50.00'}, {'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez', 'total_expenses': '135.25'}, {'employee_id': 3536259, 'first_name': 'Daniel', 'last_name': 'Garcia', 'total_expenses': '195.50'}, {'employee_id': 3536260, 'first_name': 'Taylor', 'last_name': 'Rodriguez', 'total_expenses': '700.00'}]","
WITH EmployeeBusinessExpenses AS (
  SELECT
    employee_id,
    SUM(expense_amount) AS total_expenses
  FROM employee_business_expense
  GROUP BY
    employee_id
)
SELECT
  eb.employee_id,
  e.first_name,
  e.last_name,
  eb.total_expenses
FROM EmployeeBusinessExpenses AS eb
JOIN employee AS e
  ON eb.employee_id = e.employee_id
ORDER BY
  e.employee_id;
```",,"[{'employee_id': 3536261, 'first_name': 'David', 'last_name': 'Lopez', 'total_expenses': '0'}, {'employee_id': 3536264, 'first_name': 'Sophia', 'last_name': 'Perez', 'total_expenses': '0'}, {'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe', 'total_expenses': '390.00'}, {'employee_id': 3536269, 'first_name': 'Noah', 'last_name': 'King', 'total_expenses': '0'}, {'employee_id': 3536268, 'first_name': 'Emma', 'last_name': 'Reyes', 'total_expenses': '0'}, {'employee_id': 3536254, 'first_name': 'Emily', 'last_name': 'Williams', 'total_expenses': '260.00'}, {'employee_id': 3536260, 'first_name': 'Taylor', 'last_name': 'Rodriguez', 'total_expenses': '700.00'}, {'employee_id': 3536253, 'first_name': 'Michael', 'last_name': 'Johnson', 'total_expenses': '175.00'}, {'employee_id': 3536262, 'first_name': 'Megan', 'last_name': 'Hernandez', 'total_expenses': '0'}, {'employee_id': 3536270, 'first_name': 'Charlotte', 'last_name': 'Cooper', 'total_expenses': '0'}, {'employee_id': 3536267, 'first_name': 'Liam', 'last_name': 'Gomez', 'total_expenses': '0'}, {'employee_id': 3536266, 'first_name': 'Olivia', 'last_name': 'Rivera', 'total_expenses': '0'}, {'employee_id': 3536257, 'first_name': 'Christopher', 'last_name': 'Davis', 'total_expenses': '50.00'}, {'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown', 'total_expenses': '170.95'}, {'employee_id': 3536265, 'first_name': 'Aiden', 'last_name': 'Torres', 'total_expenses': '0'}, {'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith', 'total_expenses': '170.50'}, {'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez', 'total_expenses': '135.25'}, {'employee_id': 3536259, 'first_name': 'Daniel', 'last_name': 'Garcia', 'total_expenses': '195.50'}, {'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones', 'total_expenses': '545.75'}, {'employee_id': 3536263, 'first_name': 'Andrew', 'last_name': 'Gonzalez', 'total_expenses': '0'}]","['SELECT e.employee_id, e.first_name, e.last_name, COALESCE(SUM(ebe.expense_amount), 0) AS total_expenses FROM employee e LEFT JOIN employee_business_expense ebe ON e.employee_id = ebe.employee_id GROUP BY e.employee_id, e.first_name, e.last_name;']",146,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Calculate the total expenses incurred by each employee by summing their business expenses.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH EmployeeBusinessExpenses AS (
SELECT
employee_id,
SUM(expense_amount) AS total_expenses
FROM employee_business_expense
GROUP BY
employee_id
)
SELECT
eb.employee_id,
e.first_name,
e.last_name,
eb.total_expenses
FROM EmployeeBusinessExpenses AS eb
JOIN employee AS e
ON eb.employee_id = e.employee_id
ORDER BY
e.employee_id;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'COALESCE', 'AGGREGATE', 'LEFT_JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the duration of each training session by calculating the difference between start and end dates.","[{'date': '2024-03-10', 'duration_seconds': '302400.000000', 'title': 'Effective Communication Skills Workshop'}, {'date': '2024-03-15', 'duration_seconds': '345600.000000', 'title': 'Project Management Basics'}, {'date': '2024-03-20', 'duration_seconds': '216000.000000', 'title': 'Software Development Best Practices'}, {'date': '2024-03-25', 'duration_seconds': '172800.000000', 'title': 'Financial Planning Workshop'}, {'date': '2024-03-30', 'duration_seconds': '259200.000000', 'title': 'Leadership Development Seminar'}, {'date': '2024-04-05', 'duration_seconds': '216000.000000', 'title': 'Cybersecurity Awareness Training'}, {'date': '2024-04-10', 'duration_seconds': '345600.000000', 'title': 'Sales Techniques Workshop'}, {'date': '2024-04-15', 'duration_seconds': '172800.000000', 'title': 'Time Management Seminar'}, {'date': '2024-04-20', 'duration_seconds': '302400.000000', 'title': 'Conflict Resolution Training'}, {'date': '2024-04-25', 'duration_seconds': '259200.000000', 'title': 'Customer Service Excellence Workshop'}, {'date': '2024-04-30', 'duration_seconds': '216000.000000', 'title': 'Presentation Skills Training'}, {'date': '2024-05-05', 'duration_seconds': '259200.000000', 'title': 'Diversity and Inclusion Workshop'}, {'date': '2024-05-10', 'duration_seconds': '172800.000000', 'title': 'Stress Management Seminar'}, {'date': '2024-05-15', 'duration_seconds': '345600.000000', 'title': 'Team Building Workshop'}, {'date': '2024-05-20', 'duration_seconds': '216000.000000', 'title': 'Effective Email Communication Training'}, {'date': '2024-05-25', 'duration_seconds': '259200.000000', 'title': 'Problem-Solving Skills Workshop'}, {'date': '2024-05-30', 'duration_seconds': '172800.000000', 'title': 'Business Writing Seminar'}, {'date': '2024-06-05', 'duration_seconds': '302400.000000', 'title': 'Leadership Skills Training'}, {'date': '2024-06-10', 'duration_seconds': '259200.000000', 'title': 'Effective Meeting Management Workshop'}, {'date': '2024-06-15', 'duration_seconds': '216000.000000', 'title': 'Time Tracking and Productivity Seminar'}]","
SELECT t.date, t.title, EXTRACT(EPOCH FROM (t.date + t.duration * INTERVAL '1 day') - t.date) AS duration_seconds
FROM training t;
```",,"[{'date': '2024-03-10', 'duration_days': -337, 'title': 'Effective Communication Skills Workshop', 'training_id': 101}, {'date': '2024-03-15', 'duration_days': -332, 'title': 'Project Management Basics', 'training_id': 102}, {'date': '2024-03-20', 'duration_days': -327, 'title': 'Software Development Best Practices', 'training_id': 103}, {'date': '2024-03-25', 'duration_days': -322, 'title': 'Financial Planning Workshop', 'training_id': 104}, {'date': '2024-03-30', 'duration_days': -317, 'title': 'Leadership Development Seminar', 'training_id': 105}, {'date': '2024-04-05', 'duration_days': -311, 'title': 'Cybersecurity Awareness Training', 'training_id': 106}, {'date': '2024-04-10', 'duration_days': -306, 'title': 'Sales Techniques Workshop', 'training_id': 107}, {'date': '2024-04-15', 'duration_days': -301, 'title': 'Time Management Seminar', 'training_id': 108}, {'date': '2024-04-20', 'duration_days': -296, 'title': 'Conflict Resolution Training', 'training_id': 109}, {'date': '2024-04-25', 'duration_days': -291, 'title': 'Customer Service Excellence Workshop', 'training_id': 110}, {'date': '2024-04-30', 'duration_days': -286, 'title': 'Presentation Skills Training', 'training_id': 111}, {'date': '2024-05-05', 'duration_days': -281, 'title': 'Diversity and Inclusion Workshop', 'training_id': 112}, {'date': '2024-05-10', 'duration_days': -276, 'title': 'Stress Management Seminar', 'training_id': 113}, {'date': '2024-05-15', 'duration_days': -271, 'title': 'Team Building Workshop', 'training_id': 114}, {'date': '2024-05-20', 'duration_days': -266, 'title': 'Effective Email Communication Training', 'training_id': 115}, {'date': '2024-05-25', 'duration_days': -261, 'title': 'Problem-Solving Skills Workshop', 'training_id': 116}, {'date': '2024-05-30', 'duration_days': -256, 'title': 'Business Writing Seminar', 'training_id': 117}, {'date': '2024-06-05', 'duration_days': -250, 'title': 'Leadership Skills Training', 'training_id': 118}, {'date': '2024-06-10', 'duration_days': -245, 'title': 'Effective Meeting Management Workshop', 'training_id': 119}, {'date': '2024-06-15', 'duration_days': -240, 'title': 'Time Tracking and Productivity Seminar', 'training_id': 120}]","['SELECT training_id, title, date, date - CURRENT_DATE AS duration_days FROM training;']",147,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve the duration of each training session by calculating the difference between start and end dates.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT t.date, t.title, EXTRACT(EPOCH FROM (t.date + t.duration * INTERVAL '1 day') - t.date) AS duration_seconds
FROM training t;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'DATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve employees who have allowances for either Transportation or Housing.",[],"
SELECT
  ""e"".""employee_id"",
  ""e"".""first_name"",
  ""e"".""last_name"",
  ""a"".""allowance""
FROM ""public"".""employee"" AS ""e""
INNER JOIN ""public"".""employee_allowances"" AS ""ea""
  ON ""e"".""employee_id"" = ""ea"".""employee_id""
INNER JOIN ""public"".""allowances"" AS ""a""
  ON ""ea"".""allowance_id"" = ""a"".""allowance_id""
WHERE
  ""a"".""allowance"" IN ('Transportation', 'Housing');
```",,"[{'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe'}, {'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith'}, {'employee_id': 3536253, 'first_name': 'Michael', 'last_name': 'Johnson'}, {'employee_id': 3536254, 'first_name': 'Emily', 'last_name': 'Williams'}, {'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown'}, {'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones'}, {'employee_id': 3536257, 'first_name': 'Christopher', 'last_name': 'Davis'}, {'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez'}, {'employee_id': 3536259, 'first_name': 'Daniel', 'last_name': 'Garcia'}, {'employee_id': 3536260, 'first_name': 'Taylor', 'last_name': 'Rodriguez'}]","[""SELECT e.employee_id, e.first_name, e.last_name FROM employee e WHERE EXISTS ( SELECT 1 FROM employee_allowances ea JOIN allowances a ON ea.allowance_id = a.allowance_id WHERE ea.employee_id = e.employee_id AND a.allowance IN ('Transport Allowance', 'Housing Allowance') );""]",152,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve employees who have allowances for either Transportation or Housing.,"{'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""allowance IN (\'Transport Allowance\', \'Housing Allowance\')""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
""e"".""employee_id"",
""e"".""first_name"",
""e"".""last_name"",
""a"".""allowance""
FROM ""public"".""employee"" AS ""e""
INNER JOIN ""public"".""employee_allowances"" AS ""ea""
ON ""e"".""employee_id"" = ""ea"".""employee_id""
INNER JOIN ""public"".""allowances"" AS ""a""
ON ""ea"".""allowance_id"" = ""a"".""allowance_id""
WHERE
""a"".""allowance"" IN ('Transportation', 'Housing');
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT']",
[],db_hr,['postgres'],[],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42703', 'M': 'column e.skills_preferred does not exist', 'P': '116', 'F': 'parse_relation.c', 'L': '3727', 'R': 'errorMissingColumn'}
[SQL: 
WITH EmployeeSkills AS (
SELECT
e.employee_id,
js.skill_name
FROM Employee AS e
JOIN LATERAL jsonb_array_elements(e.skills_preferred) AS js(skill_name) ON true
UNION
SELECT
e.employee_id,
js.skill_name
FROM Employee AS e
JOIN LATERAL jsonb_array_elements(e.skills_required) AS js(skill_name) ON true
), SkillFilter AS (
SELECT
employee_id,
skill_name
FROM EmployeeSkills
WHERE
skill_name IN ('Business Intelligence', 'selenium')
)
SELECT
e.employee_id,
e.first_name,
e.last_name,
sf.skill_name AS skill
FROM Employee AS e
JOIN SkillFilter AS sf
ON e.employee_id = sf.employee_id;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve employees who have skills in either Business Intelligence or selenium.",[],"
WITH EmployeeSkills AS (
  SELECT
    e.employee_id,
    js.skill_name
  FROM Employee AS e
  JOIN LATERAL jsonb_array_elements(e.skills_preferred) AS js(skill_name) ON true
  UNION
  SELECT
    e.employee_id,
    js.skill_name
  FROM Employee AS e
  JOIN LATERAL jsonb_array_elements(e.skills_required) AS js(skill_name) ON true
), SkillFilter AS (
  SELECT
    employee_id,
    skill_name
  FROM EmployeeSkills
  WHERE
    skill_name IN ('Business Intelligence', 'selenium')
)
SELECT
  e.employee_id,
  e.first_name,
  e.last_name,
  sf.skill_name AS skill
FROM Employee AS e
JOIN SkillFilter AS sf
  ON e.employee_id = sf.employee_id;
```",,[],[],158,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve employees who have skills in either Business Intelligence or selenium.,"{'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""skills_preferred like \'%Business Intelligence%\' OR skills_preferred like \'%Selenium%\'""'}",,dql,2025-02-10 18:36:22.083420,"
WITH EmployeeSkills AS (
SELECT
e.employee_id,
js.skill_name
FROM Employee AS e
JOIN LATERAL jsonb_array_elements(e.skills_preferred) AS js(skill_name) ON true
UNION
SELECT
e.employee_id,
js.skill_name
FROM Employee AS e
JOIN LATERAL jsonb_array_elements(e.skills_required) AS js(skill_name) ON true
), SkillFilter AS (
SELECT
employee_id,
skill_name
FROM EmployeeSkills
WHERE
skill_name IN ('Business Intelligence', 'selenium')
)
SELECT
e.employee_id,
e.first_name,
e.last_name,
sf.skill_name AS skill
FROM Employee AS e
JOIN SkillFilter AS sf
ON e.employee_id = sf.employee_id;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find the cumulative sum of expenses for each employee over time.","[{'cumulative_expenses': '350.00', 'employee_id': 3536251, 'employee_name': 'John Doe', 'expense_date': '2023-01-10'}, {'cumulative_expenses': '390.00', 'employee_id': 3536251, 'employee_name': 'John Doe', 'expense_date': '2023-11-05'}, {'cumulative_expenses': '80.50', 'employee_id': 3536252, 'employee_name': 'Alice Smith', 'expense_date': '2023-02-15'}, {'cumulative_expenses': '170.50', 'employee_id': 3536252, 'employee_name': 'Alice Smith', 'expense_date': '2023-12-12'}, {'cumulative_expenses': '25.00', 'employee_id': 3536253, 'employee_name': 'Michael Johnson', 'expense_date': '2023-03-20'}, {'cumulative_expenses': '175.00', 'employee_id': 3536253, 'employee_name': 'Michael Johnson', 'expense_date': '2024-01-18'}, {'cumulative_expenses': '200.00', 'employee_id': 3536254, 'employee_name': 'Emily Williams', 'expense_date': '2023-04-05'}, {'cumulative_expenses': '260.00', 'employee_id': 3536254, 'employee_name': 'Emily Williams', 'expense_date': '2024-02-20'}, {'cumulative_expenses': '50.20', 'employee_id': 3536255, 'employee_name': 'Matthew Brown', 'expense_date': '2023-05-12'}, {'cumulative_expenses': '170.95', 'employee_id': 3536255, 'employee_name': 'Matthew Brown', 'expense_date': '2024-03-25'}, {'cumulative_expenses': '45.75', 'employee_id': 3536256, 'employee_name': 'Sarah Jones', 'expense_date': '2023-06-18'}, {'cumulative_expenses': '545.75', 'employee_id': 3536256, 'employee_name': 'Sarah Jones', 'expense_date': '2024-04-10'}, {'cumulative_expenses': '30.00', 'employee_id': 3536257, 'employee_name': 'Christopher Davis', 'expense_date': '2023-07-25'}, {'cumulative_expenses': '50.00', 'employee_id': 3536257, 'employee_name': 'Christopher Davis', 'expense_date': '2024-05-15'}, {'cumulative_expenses': '100.00', 'employee_id': 3536258, 'employee_name': 'Jessica Martinez', 'expense_date': '2023-08-10'}, {'cumulative_expenses': '135.25', 'employee_id': 3536258, 'employee_name': 'Jessica Martinez', 'expense_date': '2024-06-20'}, {'cumulative_expenses': '15.50', 'employee_id': 3536259, 'employee_name': 'Daniel Garcia', 'expense_date': '2023-09-15'}, {'cumulative_expenses': '195.50', 'employee_id': 3536259, 'employee_name': 'Daniel Garcia', 'expense_date': '2024-07-25'}, {'cumulative_expenses': '300.00', 'employee_id': 3536260, 'employee_name': 'Taylor Rodriguez', 'expense_date': '2023-10-20'}, {'cumulative_expenses': '700.00', 'employee_id': 3536260, 'employee_name': 'Taylor Rodriguez', 'expense_date': '2024-08-30'}, {'cumulative_expenses': None, 'employee_id': 3536261, 'employee_name': 'David Lopez', 'expense_date': None}, {'cumulative_expenses': None, 'employee_id': 3536262, 'employee_name': 'Megan Hernandez', 'expense_date': None}, {'cumulative_expenses': None, 'employee_id': 3536263, 'employee_name': 'Andrew Gonzalez', 'expense_date': None}, {'cumulative_expenses': None, 'employee_id': 3536264, 'employee_name': 'Sophia Perez', 'expense_date': None}, {'cumulative_expenses': None, 'employee_id': 3536265, 'employee_name': 'Aiden Torres', 'expense_date': None}, {'cumulative_expenses': None, 'employee_id': 3536266, 'employee_name': 'Olivia Rivera', 'expense_date': None}, {'cumulative_expenses': None, 'employee_id': 3536267, 'employee_name': 'Liam Gomez', 'expense_date': None}, {'cumulative_expenses': None, 'employee_id': 3536268, 'employee_name': 'Emma Reyes', 'expense_date': None}, {'cumulative_expenses': None, 'employee_id': 3536269, 'employee_name': 'Noah King', 'expense_date': None}, {'cumulative_expenses': None, 'employee_id': 3536270, 'employee_name': 'Charlotte Cooper', 'expense_date': None}]","
WITH EmployeeExpenses AS (
    SELECT
        e.""employee_id"",
        e.""first_name"" || ' ' || e.""last_name"" AS employee_name,
        eb.""expense_date"",
        eb.""expense_amount""
    FROM ""employee"" AS e
    LEFT JOIN ""employee_business_expense"" AS eb
        ON e.""employee_id"" = eb.""employee_id""
), RankedEmployeeExpenses AS (
    SELECT
        ee.""employee_id"",
        ee.""employee_name"",
        ee.""expense_date"",
        ee.""expense_amount"",
        RANK() OVER (PARTITION BY ee.""employee_id"" ORDER BY ee.""expense_date"") AS expense_rank
    FROM EmployeeExpenses AS ee
)
SELECT
    ree.""employee_id"",
    ree.""employee_name"",
    ree.""expense_date"",
    SUM(ree.""expense_amount"") OVER (PARTITION BY ree.""employee_id"" ORDER BY ree.""expense_date"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_expenses
FROM RankedEmployeeExpenses AS ree
ORDER BY
    ree.""employee_id"",
    ree.""expense_date"";
```",,"[{'cumulative_expenses': '350.00', 'employee_id': 3536251, 'expense_amount': '350.00', 'expense_date': '2023-01-10'}, {'cumulative_expenses': '390.00', 'employee_id': 3536251, 'expense_amount': '40.00', 'expense_date': '2023-11-05'}, {'cumulative_expenses': '80.50', 'employee_id': 3536252, 'expense_amount': '80.50', 'expense_date': '2023-02-15'}, {'cumulative_expenses': '170.50', 'employee_id': 3536252, 'expense_amount': '90.00', 'expense_date': '2023-12-12'}, {'cumulative_expenses': '25.00', 'employee_id': 3536253, 'expense_amount': '25.00', 'expense_date': '2023-03-20'}, {'cumulative_expenses': '175.00', 'employee_id': 3536253, 'expense_amount': '150.00', 'expense_date': '2024-01-18'}, {'cumulative_expenses': '200.00', 'employee_id': 3536254, 'expense_amount': '200.00', 'expense_date': '2023-04-05'}, {'cumulative_expenses': '260.00', 'employee_id': 3536254, 'expense_amount': '60.00', 'expense_date': '2024-02-20'}, {'cumulative_expenses': '50.20', 'employee_id': 3536255, 'expense_amount': '50.20', 'expense_date': '2023-05-12'}, {'cumulative_expenses': '170.95', 'employee_id': 3536255, 'expense_amount': '120.75', 'expense_date': '2024-03-25'}, {'cumulative_expenses': '45.75', 'employee_id': 3536256, 'expense_amount': '45.75', 'expense_date': '2023-06-18'}, {'cumulative_expenses': '545.75', 'employee_id': 3536256, 'expense_amount': '500.00', 'expense_date': '2024-04-10'}, {'cumulative_expenses': '30.00', 'employee_id': 3536257, 'expense_amount': '30.00', 'expense_date': '2023-07-25'}, {'cumulative_expenses': '50.00', 'employee_id': 3536257, 'expense_amount': '20.00', 'expense_date': '2024-05-15'}, {'cumulative_expenses': '100.00', 'employee_id': 3536258, 'expense_amount': '100.00', 'expense_date': '2023-08-10'}, {'cumulative_expenses': '135.25', 'employee_id': 3536258, 'expense_amount': '35.25', 'expense_date': '2024-06-20'}, {'cumulative_expenses': '15.50', 'employee_id': 3536259, 'expense_amount': '15.50', 'expense_date': '2023-09-15'}, {'cumulative_expenses': '195.50', 'employee_id': 3536259, 'expense_amount': '180.00', 'expense_date': '2024-07-25'}, {'cumulative_expenses': '300.00', 'employee_id': 3536260, 'expense_amount': '300.00', 'expense_date': '2023-10-20'}, {'cumulative_expenses': '700.00', 'employee_id': 3536260, 'expense_amount': '400.00', 'expense_date': '2024-08-30'}]","['SELECT employee_id, expense_date, expense_amount, SUM(expense_amount) OVER (PARTITION BY employee_id ORDER BY expense_date) AS cumulative_expenses FROM employee_business_expense;']",141,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Find the cumulative sum of expenses for each employee over time.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH EmployeeExpenses AS (
SELECT
e.""employee_id"",
e.""first_name"" || ' ' || e.""last_name"" AS employee_name,
eb.""expense_date"",
eb.""expense_amount""
FROM ""employee"" AS e
LEFT JOIN ""employee_business_expense"" AS eb
ON e.""employee_id"" = eb.""employee_id""
), RankedEmployeeExpenses AS (
SELECT
ee.""employee_id"",
ee.""employee_name"",
ee.""expense_date"",
ee.""expense_amount"",
RANK() OVER (PARTITION BY ee.""employee_id"" ORDER BY ee.""expense_date"") AS expense_rank
FROM EmployeeExpenses AS ee
)
SELECT
ree.""employee_id"",
ree.""employee_name"",
ree.""expense_date"",
SUM(ree.""expense_amount"") OVER (PARTITION BY ree.""employee_id"" ORDER BY ree.""expense_date"" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_expenses
FROM RankedEmployeeExpenses AS ree
ORDER BY
ree.""employee_id"",
ree.""expense_date"";
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'PARTITION']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42P01', 'M': 'relation ""eligibility_criteria"" does not exist', 'P': '57', 'F': 'parse_relation.c', 'L': '1452', 'R': 'parserOpenTable'}
[SQL: 
SELECT
T1.benefit_name
FROM
""benefit"" AS T1
INNER JOIN
""eligibility_criteria"" AS T2
ON
T1.benefit_id = T2.benefit_id
WHERE
T2.coverage::jsonb ? 'dental';
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the names of benefits that cover dental expenses.",[],"
SELECT
  T1.benefit_name
FROM
  ""benefit"" AS T1
INNER JOIN
  ""eligibility_criteria"" AS T2
ON
  T1.benefit_id = T2.benefit_id
WHERE
  T2.coverage::jsonb ? 'dental';
```",,"[{'title': 'Effective Communication Skills Workshop'}, {'title': 'Project Management Basics'}, {'title': 'Financial Planning Workshop'}, {'title': 'Leadership Development Seminar'}, {'title': 'Cybersecurity Awareness Training'}, {'title': 'Sales Techniques Workshop'}, {'title': 'Conflict Resolution Training'}, {'title': 'Customer Service Excellence Workshop'}, {'title': 'Presentation Skills Training'}, {'title': 'Diversity and Inclusion Workshop'}, {'title': 'Stress Management Seminar'}, {'title': 'Team Building Workshop'}, {'title': 'Problem-Solving Skills Workshop'}, {'title': 'Business Writing Seminar'}, {'title': 'Leadership Skills Training'}, {'title': 'Effective Meeting Management Workshop'}, {'title': 'Time Tracking and Productivity Seminar'}]",['SELECT title FROM training WHERE attendance_required = TRUE;'],180,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve the names of benefits that cover dental expenses.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
T1.benefit_name
FROM
""benefit"" AS T1
INNER JOIN
""eligibility_criteria"" AS T2
ON
T1.benefit_id = T2.benefit_id
WHERE
T2.coverage::jsonb ? 'dental';
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Display employee IDs and their masked bank account numbers",,,,,"[""SELECT employee_id, CONCAT('XXXX-XXXX-XXXX-', RIGHT(bank_account_number->>'$.account_number', 4)) AS masked_account_number FROM employee;""]",186,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Display employee IDs and their masked bank account numbers,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,,[],"Cannot get the response text.
Cannot get the Candidate text.
Response candidate content has no parts (and thus no text). The candidate is likely blocked by the safety filters.
Content:
{}
Candidate:
{
  ""finish_reason"": ""SAFETY"",
  ""safety_ratings"": [
    {
      ""category"": ""HARM_CATEGORY_HATE_SPEECH"",
      ""probability"": ""NEGLIGIBLE"",
      ""probability_score"": 0.40234375,
      ""severity"": ""HARM_SEVERITY_LOW"",
      ""severity_score"": 0.21582031
    },
    {
      ""category"": ""HARM_CATEGORY_DANGEROUS_CONTENT"",
      ""probability"": ""MEDIUM"",
      ""blocked"": true,
      ""probability_score"": 0.68359375,
      ""severity"": ""HARM_SEVERITY_MEDIUM"",
      ""severity_score"": 0.51953125
    },
    {
      ""category"": ""HARM_CATEGORY_HARASSMENT"",
      ""probability"": ""NEGLIGIBLE"",
      ""probability_score"": 0.4296875,
      ""severity"": ""HARM_SEVERITY_LOW"",
      ""severity_score"": 0.24316406
    },
    {
      ""category"": ""HARM_CATEGORY_SEXUALLY_EXPLICIT"",
      ""probability"": ""NEGLIGIBLE"",
      ""probability_score"": 0.30664062,
      ""severity"": ""HARM_SEVERITY_LOW"",
      ""severity_score"": 0.23339844
    }
  ]
}
Response:
{
  ""candidates"": [
    {
      ""finish_reason"": ""SAFETY"",
      ""safety_ratings"": [
        {
          ""category"": ""HARM_CATEGORY_HATE_SPEECH"",
          ""probability"": ""NEGLIGIBLE"",
          ""probability_score"": 0.40234375,
          ""severity"": ""HARM_SEVERITY_LOW"",
          ""severity_score"": 0.21582031
        },
        {
          ""category"": ""HARM_CATEGORY_DANGEROUS_CONTENT"",
          ""probability"": ""MEDIUM"",
          ""blocked"": true,
          ""probability_score"": 0.68359375,
          ""severity"": ""HARM_SEVERITY_MEDIUM"",
          ""severity_score"": 0.51953125
        },
        {
          ""category"": ""HARM_CATEGORY_HARASSMENT"",
          ""probability"": ""NEGLIGIBLE"",
          ""probability_score"": 0.4296875,
          ""severity"": ""HARM_SEVERITY_LOW"",
          ""severity_score"": 0.24316406
        },
        {
          ""category"": ""HARM_CATEGORY_SEXUALLY_EXPLICIT"",
          ""probability"": ""NEGLIGIBLE"",
          ""probability_score"": 0.30664062,
          ""severity"": ""HARM_SEVERITY_LOW"",
          ""severity_score"": 0.23339844
        }
      ]
    }
  ],
  ""usage_metadata"": {
    ""prompt_token_count"": 2145,
    ""total_token_count"": 2145,
    ""prompt_tokens_details"": [
      {
        ""modality"": ""TEXT"",
        ""token_count"": 2145
      }
    ]
  },
  ""model_version"": ""gemini-1.0-pro-002""
}",0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'STRING']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve all employees who have a bank account in a 'Anothertown' City from their address.",,,,,"[""SELECT * FROM employee WHERE address->>'city' = 'Anothertown';""]",206,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve all employees who have a bank account in a 'Anothertown' City from their address.,"{'Compare Type': '""Execution result match""', 'Context': '""Match""', 'Extra context': '""address->>\'city\' = \'Anothertown\'""'}",,dql,2025-02-10 18:36:22.083420,,[],"Cannot get the response text.
Cannot get the Candidate text.
Response candidate content has no parts (and thus no text). The candidate is likely blocked by the safety filters.
Content:
{}
Candidate:
{
  ""finish_reason"": ""SAFETY"",
  ""safety_ratings"": [
    {
      ""category"": ""HARM_CATEGORY_HATE_SPEECH"",
      ""probability"": ""NEGLIGIBLE"",
      ""probability_score"": 0.328125,
      ""severity"": ""HARM_SEVERITY_NEGLIGIBLE"",
      ""severity_score"": 0.1953125
    },
    {
      ""category"": ""HARM_CATEGORY_DANGEROUS_CONTENT"",
      ""probability"": ""MEDIUM"",
      ""blocked"": true,
      ""probability_score"": 0.734375,
      ""severity"": ""HARM_SEVERITY_MEDIUM"",
      ""severity_score"": 0.5078125
    },
    {
      ""category"": ""HARM_CATEGORY_HARASSMENT"",
      ""probability"": ""NEGLIGIBLE"",
      ""probability_score"": 0.36132812,
      ""severity"": ""HARM_SEVERITY_LOW"",
      ""severity_score"": 0.2109375
    },
    {
      ""category"": ""HARM_CATEGORY_SEXUALLY_EXPLICIT"",
      ""probability"": ""NEGLIGIBLE"",
      ""probability_score"": 0.24609375,
      ""severity"": ""HARM_SEVERITY_LOW"",
      ""severity_score"": 0.23535156
    }
  ]
}
Response:
{
  ""candidates"": [
    {
      ""finish_reason"": ""SAFETY"",
      ""safety_ratings"": [
        {
          ""category"": ""HARM_CATEGORY_HATE_SPEECH"",
          ""probability"": ""NEGLIGIBLE"",
          ""probability_score"": 0.328125,
          ""severity"": ""HARM_SEVERITY_NEGLIGIBLE"",
          ""severity_score"": 0.1953125
        },
        {
          ""category"": ""HARM_CATEGORY_DANGEROUS_CONTENT"",
          ""probability"": ""MEDIUM"",
          ""blocked"": true,
          ""probability_score"": 0.734375,
          ""severity"": ""HARM_SEVERITY_MEDIUM"",
          ""severity_score"": 0.5078125
        },
        {
          ""category"": ""HARM_CATEGORY_HARASSMENT"",
          ""probability"": ""NEGLIGIBLE"",
          ""probability_score"": 0.36132812,
          ""severity"": ""HARM_SEVERITY_LOW"",
          ""severity_score"": 0.2109375
        },
        {
          ""category"": ""HARM_CATEGORY_SEXUALLY_EXPLICIT"",
          ""probability"": ""NEGLIGIBLE"",
          ""probability_score"": 0.24609375,
          ""severity"": ""HARM_SEVERITY_LOW"",
          ""severity_score"": 0.23535156
        }
      ]
    }
  ],
  ""usage_metadata"": {
    ""prompt_token_count"": 2155,
    ""total_token_count"": 2155,
    ""prompt_tokens_details"": [
      {
        ""modality"": ""TEXT"",
        ""token_count"": 2155
      }
    ]
  },
  ""model_version"": ""gemini-1.0-pro-002""
}",0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'JSON_EXTRACT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the names of active departments with a total budget exceeding 100 thousand dollars.","[{'department_name': 'Marketing'}, {'department_name': 'Finance'}, {'department_name': 'Sales'}, {'department_name': 'IT'}, {'department_name': 'Operations'}, {'department_name': 'Customer Service'}, {'department_name': 'Research and Development'}, {'department_name': 'Quality Assurance'}, {'department_name': 'Legal'}, {'department_name': 'Administration'}, {'department_name': 'Production'}, {'department_name': 'Supply Chain'}, {'department_name': 'Safety and Compliance'}, {'department_name': 'Customer Success'}, {'department_name': 'Engineering'}, {'department_name': 'Logistics'}, {'department_name': 'Public Relations'}, {'department_name': 'Product Management'}]","
SELECT
    ""d"".""department_name""
FROM
    ""department"" AS ""d""
WHERE
    ""d"".""budget"" > 100000
    AND ""d"".""is_active"" = TRUE;
```",,"[{'department_name': 'Marketing'}, {'department_name': 'Finance'}, {'department_name': 'Sales'}, {'department_name': 'IT'}, {'department_name': 'Operations'}, {'department_name': 'Customer Service'}, {'department_name': 'Research and Development'}, {'department_name': 'Quality Assurance'}, {'department_name': 'Legal'}, {'department_name': 'Administration'}, {'department_name': 'Production'}, {'department_name': 'Supply Chain'}, {'department_name': 'Safety and Compliance'}, {'department_name': 'Customer Success'}, {'department_name': 'Engineering'}, {'department_name': 'Logistics'}, {'department_name': 'Public Relations'}, {'department_name': 'Product Management'}]",['SELECT department_name FROM department WHERE is_active = true AND budget > 100000;'],178,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve the names of active departments with a total budget exceeding 100 thousand dollars.,"{'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""budget > 1000000""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
""d"".""department_name""
FROM
""department"" AS ""d""
WHERE
""d"".""budget"" > 100000
AND ""d"".""is_active"" = TRUE;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42P01', 'M': 'relation ""Job"" does not exist', 'P': '32', 'F': 'parse_relation.c', 'L': '1452', 'R': 'parserOpenTable'}
[SQL: 
SELECT
""Job"".""job_title""
FROM
""Job"" AS ""Job""
JOIN
""job"".""skills_required"" AS ""skills_required""
ON
""job"".""job_id"" = ""skills_required"".""id""
WHERE
""skills_required"".""skill"" ILIKE '%Marketing%'
ORDER BY
""Job"".""job_title"" ASC
NULLS LAST;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve job titles where 'Marketing' is listed as a preferred skill.",[],"
SELECT
    ""Job"".""job_title""
FROM
    ""Job"" AS ""Job""
JOIN
    ""job"".""skills_required"" AS ""skills_required""
ON
    ""job"".""job_id"" = ""skills_required"".""id""
WHERE
    ""skills_required"".""skill"" ILIKE '%Marketing%'
ORDER BY
    ""Job"".""job_title"" ASC
NULLS LAST;
```",,"[{'job_title': 'Marketing Manager', 'skills_preferred': {'Content Marketing': 'Advanced', 'Email Marketing': 'Intermediate'}}]","['SELECT job_title, skills_preferred FROM job WHERE skills_preferred @> \'{""Email Marketing"": ""Intermediate""}\'::jsonb;']",179,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve job titles where 'Marketing' is listed as a preferred skill.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
""Job"".""job_title""
FROM
""Job"" AS ""Job""
JOIN
""job"".""skills_required"" AS ""skills_required""
ON
""job"".""job_id"" = ""skills_required"".""id""
WHERE
""skills_required"".""skill"" ILIKE '%Marketing%'
ORDER BY
""Job"".""job_title"" ASC
NULLS LAST;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'JSON_SEARCH']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve employees who have been assigned computers with either Dell or HP models.",[],"
SELECT
  e.""first_name"" || ' ' || e.""last_name"" AS employee_name,
  ec.""computer_name"" AS assigned_computer,
  ec.""model"" AS computer_model
FROM ""employee"" AS e
JOIN ""employee_computer"" AS ec
  ON e.""employee_id"" = ec.""employee_id""
WHERE
  ec.""model"" IN ('Dell', 'HP')
ORDER BY
  employee_name;
```",,"[{'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe'}, {'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith'}]","[""SELECT e.employee_id, e.first_name, e.last_name FROM employee e WHERE EXISTS ( SELECT 1 FROM employee_computer ec WHERE ec.employee_id = e.employee_id AND ec.model IN ('Dell XPS 15', 'HP Pavilion') );""]",151,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve employees who have been assigned computers with either Dell or HP models.,"{'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""model IN (\'Dell XPS 15\', \'HP Pavilion\')""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
e.""first_name"" || ' ' || e.""last_name"" AS employee_name,
ec.""computer_name"" AS assigned_computer,
ec.""model"" AS computer_model
FROM ""employee"" AS e
JOIN ""employee_computer"" AS ec
ON e.""employee_id"" = ec.""employee_id""
WHERE
ec.""model"" IN ('Dell', 'HP')
ORDER BY
employee_name;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Determine the percentage of total expenses each employees expenses represent.","[{'first_name': 'Taylor', 'last_name': 'Rodriguez', 'percentage_of_total_expenses': '25.0631053187489930', 'total_employee_expenses': '700.00', 'total_expenses': '2792.95'}, {'first_name': 'Sarah', 'last_name': 'Jones', 'percentage_of_total_expenses': '19.5402710395818042', 'total_employee_expenses': '545.75', 'total_expenses': '2792.95'}, {'first_name': 'John', 'last_name': 'Doe', 'percentage_of_total_expenses': '13.9637301061601532', 'total_employee_expenses': '390.00', 'total_expenses': '2792.95'}, {'first_name': 'Emily', 'last_name': 'Williams', 'percentage_of_total_expenses': '9.3091534041067688', 'total_employee_expenses': '260.00', 'total_expenses': '2792.95'}, {'first_name': 'Daniel', 'last_name': 'Garcia', 'percentage_of_total_expenses': '6.9997672711648973', 'total_employee_expenses': '195.50', 'total_expenses': '2792.95'}, {'first_name': 'Michael', 'last_name': 'Johnson', 'percentage_of_total_expenses': '6.2657763296872483', 'total_employee_expenses': '175.00', 'total_expenses': '2792.95'}, {'first_name': 'Matthew', 'last_name': 'Brown', 'percentage_of_total_expenses': '6.1207683632002005', 'total_employee_expenses': '170.95', 'total_expenses': '2792.95'}, {'first_name': 'Alice', 'last_name': 'Smith', 'percentage_of_total_expenses': '6.1046563669238619', 'total_employee_expenses': '170.50', 'total_expenses': '2792.95'}, {'first_name': 'Jessica', 'last_name': 'Martinez', 'percentage_of_total_expenses': '4.8425499919440019', 'total_employee_expenses': '135.25', 'total_expenses': '2792.95'}, {'first_name': 'Christopher', 'last_name': 'Davis', 'percentage_of_total_expenses': '1.7902218084820709', 'total_employee_expenses': '50.00', 'total_expenses': '2792.95'}]","
WITH EmployeeExpenses AS (
  SELECT
    e.employee_id,
    e.first_name,
    e.last_name,
    SUM(eb.expense_amount) AS total_employee_expenses
  FROM employee AS e
  LEFT JOIN employee_business_expense AS eb
    ON e.employee_id = eb.employee_id
  GROUP BY
    e.employee_id,
    e.first_name,
    e.last_name
), TotalExpenses AS (
  SELECT
    SUM(eb.expense_amount) AS total_expenses
  FROM employee_business_expense AS eb
)
SELECT
  ee.first_name,
  ee.last_name,
  ee.total_employee_expenses,
  te.total_expenses,
  CAST(ee.total_employee_expenses AS DECIMAL(10, 2)) * 100 / te.total_expenses AS percentage_of_total_expenses
FROM EmployeeExpenses AS ee
JOIN TotalExpenses AS te
  ON ee.total_employee_expenses IS NOT NULL
ORDER BY
  percentage_of_total_expenses DESC;
```",,"[{'employee_id': 3536251, 'expense_amount': '350.00', 'expense_percentage': '12.53155265937449650000'}, {'employee_id': 3536252, 'expense_amount': '80.50', 'expense_percentage': '2.88225711165613419500'}, {'employee_id': 3536253, 'expense_amount': '25.00', 'expense_percentage': '0.89511090424103546400'}, {'employee_id': 3536254, 'expense_amount': '200.00', 'expense_percentage': '7.16088723392828371400'}, {'employee_id': 3536255, 'expense_amount': '50.20', 'expense_percentage': '1.79738269571599921200'}, {'employee_id': 3536256, 'expense_amount': '45.75', 'expense_percentage': '1.63805295476109490000'}, {'employee_id': 3536257, 'expense_amount': '30.00', 'expense_percentage': '1.07413308508924255700'}, {'employee_id': 3536258, 'expense_amount': '100.00', 'expense_percentage': '3.58044361696414185700'}, {'employee_id': 3536259, 'expense_amount': '15.50', 'expense_percentage': '0.55496876062944198800'}, {'employee_id': 3536260, 'expense_amount': '300.00', 'expense_percentage': '10.74133085089242557200'}, {'employee_id': 3536251, 'expense_amount': '40.00', 'expense_percentage': '1.43217744678565674300'}, {'employee_id': 3536252, 'expense_amount': '90.00', 'expense_percentage': '3.22239925526772767100'}, {'employee_id': 3536253, 'expense_amount': '150.00', 'expense_percentage': '5.37066542544621278600'}, {'employee_id': 3536254, 'expense_amount': '60.00', 'expense_percentage': '2.14826617017848511400'}, {'employee_id': 3536255, 'expense_amount': '120.75', 'expense_percentage': '4.32338566748420129300'}, {'employee_id': 3536256, 'expense_amount': '500.00', 'expense_percentage': '17.90221808482070928600'}, {'employee_id': 3536257, 'expense_amount': '20.00', 'expense_percentage': '0.71608872339282837100'}, {'employee_id': 3536258, 'expense_amount': '35.25', 'expense_percentage': '1.26210637497986000500'}, {'employee_id': 3536259, 'expense_amount': '180.00', 'expense_percentage': '6.44479851053545534300'}, {'employee_id': 3536260, 'expense_amount': '400.00', 'expense_percentage': '14.32177446785656742900'}]","['SELECT employee_id, expense_amount, (expense_amount / total_expenses) * 100 AS expense_percentage FROM employee_business_expense, (SELECT SUM(expense_amount) AS total_expenses FROM employee_business_expense) AS total_expenses_subquery;']",139,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Determine the percentage of total expenses each employees expenses represent.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH EmployeeExpenses AS (
SELECT
e.employee_id,
e.first_name,
e.last_name,
SUM(eb.expense_amount) AS total_employee_expenses
FROM employee AS e
LEFT JOIN employee_business_expense AS eb
ON e.employee_id = eb.employee_id
GROUP BY
e.employee_id,
e.first_name,
e.last_name
), TotalExpenses AS (
SELECT
SUM(eb.expense_amount) AS total_expenses
FROM employee_business_expense AS eb
)
SELECT
ee.first_name,
ee.last_name,
ee.total_employee_expenses,
te.total_expenses,
CAST(ee.total_employee_expenses AS DECIMAL(10, 2)) * 100 / te.total_expenses AS percentage_of_total_expenses
FROM EmployeeExpenses AS ee
JOIN TotalExpenses AS te
ON ee.total_employee_expenses IS NOT NULL
ORDER BY
percentage_of_total_expenses DESC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Get the emergency contact information (name, phone number) for an employee.",[],"
SELECT
  e.""emergency_contact_name"",
  e.""emergency_contact_number""
FROM ""employee"" AS e
WHERE
  e.""employee_id"" = 1;
```",,"[{'emergency_contact_name': 'David Martinez', 'emergency_contact_number': '888-999-0000'}]","['SELECT emergency_contact_name, emergency_contact_number FROM employee WHERE employee_id = 3536258;']",174,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Get the emergency contact information (name, phone number) for an employee.","{'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""employee_id = 3536259""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
e.""emergency_contact_name"",
e.""emergency_contact_number""
FROM ""employee"" AS e
WHERE
e.""employee_id"" = 1;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find departments where employees are eligible for either Stock Options or Bonus Programs.",[],"
SELECT
  ""d"".""department_name""
FROM ""department"" AS ""d""
INNER JOIN ""job"" AS ""j""
  ON ""d"".""department_id"" = ""j"".""department_id""
WHERE
  ""j"".""benefits"" @> '{""Stock Options"": true}' OR ""j"".""benefits"" @> '{""Bonus Programs"": true}';
```",,"[{'department_id': 1, 'department_name': 'Human Resources'}]","[""SELECT d.department_id, d.department_name FROM department d WHERE EXISTS ( SELECT 1 FROM employee e WHERE e.department_id = d.department_id AND EXISTS ( SELECT 1 FROM employee_x_benefit xb JOIN benefit b ON xb.benefit_id = b.benefit_id WHERE xb.employee_id = e.employee_id AND b.benefit_name IN ('Stock Options', 'Bonus Programs') ) );""]",155,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Find departments where employees are eligible for either Stock Options or Bonus Programs.,"{'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""benefit_name IN (\'Stock Options\', \'Bonus Programs\')""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
""d"".""department_name""
FROM ""department"" AS ""d""
INNER JOIN ""job"" AS ""j""
ON ""d"".""department_id"" = ""j"".""department_id""
WHERE
""j"".""benefits"" @> '{""Stock Options"": true}' OR ""j"".""benefits"" @> '{""Bonus Programs"": true}';
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve employees who have benefits related to either Health Insurance or Retirement Plan.","[{'benefit_name': 'Health Insurance', 'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe'}]","
SELECT DISTINCT
    e.""employee_id"",
    e.""first_name"",
    e.""last_name"",
    b.""benefit_name""
FROM
    ""employee"" AS e
JOIN
    ""employee_x_benefit"" AS exb ON e.""employee_id"" = exb.""employee_id""
JOIN
    ""benefit"" AS b ON exb.""benefit_id"" = b.""benefit_id""
WHERE
    b.""benefit_name"" IN ('Health Insurance', 'Retirement Plan');
```",,"[{'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe'}]","[""SELECT e.employee_id, e.first_name, e.last_name FROM employee e WHERE EXISTS ( SELECT 1 FROM employee_x_benefit xb JOIN benefit b ON xb.benefit_id = b.benefit_id WHERE xb.employee_id = e.employee_id AND b.benefit_name IN ('Health Insurance', 'Retirement Plan') );""]",156,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve employees who have benefits related to either Health Insurance or Retirement Plan.,"{'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""benefit_name IN (\'Health Insurance\', \'Retirement Plan\')""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT DISTINCT
e.""employee_id"",
e.""first_name"",
e.""last_name"",
b.""benefit_name""
FROM
""employee"" AS e
JOIN
""employee_x_benefit"" AS exb ON e.""employee_id"" = exb.""employee_id""
JOIN
""benefit"" AS b ON exb.""benefit_id"" = b.""benefit_id""
WHERE
b.""benefit_name"" IN ('Health Insurance', 'Retirement Plan');
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the address details (street, city, state, zip code) for a 3536258 employee.",,,,,"[""SELECT address->>'street' AS street, address->>'city' AS city, address->>'state' AS state, address->>'zip_code' AS zip_code FROM employee WHERE employee_id = 3536259;""]",216,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Retrieve the address details (street, city, state, zip code) for a 3536258 employee.","{'Compare Type': '""Execution result match""', 'Context': '""Match""', 'Extra context': '""employee_id = 3536258""'}",,dql,2025-02-10 18:36:22.083420,,[],"Cannot get the response text.
Cannot get the Candidate text.
Response candidate content has no parts (and thus no text). The candidate is likely blocked by the safety filters.
Content:
{}
Candidate:
{
  ""finish_reason"": ""SAFETY"",
  ""safety_ratings"": [
    {
      ""category"": ""HARM_CATEGORY_HATE_SPEECH"",
      ""probability"": ""NEGLIGIBLE"",
      ""probability_score"": 0.31835938,
      ""severity"": ""HARM_SEVERITY_LOW"",
      ""severity_score"": 0.29101562
    },
    {
      ""category"": ""HARM_CATEGORY_DANGEROUS_CONTENT"",
      ""probability"": ""MEDIUM"",
      ""blocked"": true,
      ""probability_score"": 0.7890625,
      ""severity"": ""HARM_SEVERITY_MEDIUM"",
      ""severity_score"": 0.45898438
    },
    {
      ""category"": ""HARM_CATEGORY_HARASSMENT"",
      ""probability"": ""NEGLIGIBLE"",
      ""probability_score"": 0.39257812,
      ""severity"": ""HARM_SEVERITY_LOW"",
      ""severity_score"": 0.28515625
    },
    {
      ""category"": ""HARM_CATEGORY_SEXUALLY_EXPLICIT"",
      ""probability"": ""NEGLIGIBLE"",
      ""probability_score"": 0.16894531,
      ""severity"": ""HARM_SEVERITY_LOW"",
      ""severity_score"": 0.24609375
    }
  ]
}
Response:
{
  ""candidates"": [
    {
      ""finish_reason"": ""SAFETY"",
      ""safety_ratings"": [
        {
          ""category"": ""HARM_CATEGORY_HATE_SPEECH"",
          ""probability"": ""NEGLIGIBLE"",
          ""probability_score"": 0.31835938,
          ""severity"": ""HARM_SEVERITY_LOW"",
          ""severity_score"": 0.29101562
        },
        {
          ""category"": ""HARM_CATEGORY_DANGEROUS_CONTENT"",
          ""probability"": ""MEDIUM"",
          ""blocked"": true,
          ""probability_score"": 0.7890625,
          ""severity"": ""HARM_SEVERITY_MEDIUM"",
          ""severity_score"": 0.45898438
        },
        {
          ""category"": ""HARM_CATEGORY_HARASSMENT"",
          ""probability"": ""NEGLIGIBLE"",
          ""probability_score"": 0.39257812,
          ""severity"": ""HARM_SEVERITY_LOW"",
          ""severity_score"": 0.28515625
        },
        {
          ""category"": ""HARM_CATEGORY_SEXUALLY_EXPLICIT"",
          ""probability"": ""NEGLIGIBLE"",
          ""probability_score"": 0.16894531,
          ""severity"": ""HARM_SEVERITY_LOW"",
          ""severity_score"": 0.24609375
        }
      ]
    }
  ],
  ""usage_metadata"": {
    ""prompt_token_count"": 2162,
    ""total_token_count"": 2162,
    ""prompt_tokens_details"": [
      {
        ""modality"": ""TEXT"",
        ""token_count"": 2162
      }
    ]
  },
  ""model_version"": ""gemini-1.0-pro-002""
}",0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'JSON']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the skills required for a particular job.",[],"
SELECT T1.""skills_required""
FROM job AS T1
WHERE T1.""job_id"" IN (
    SELECT T2.""job_id""
    FROM employee AS T2
    WHERE T2.""employee_id"" = 1 -- Replace the employee number with an accurate employee's unique identifier, e.g.: 5,7,24.
);
```",,"[{'skills_required': {'Java': 'Advanced', 'Python': 'Intermediate', 'SQL': 'Intermediate'}}]","[""SELECT skills_required FROM job WHERE job_title = 'Software Engineer';""]",175,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve the skills required for a particular job.,"{'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""job_title = \'Software Engineer\'""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT T1.""skills_required""
FROM job AS T1
WHERE T1.""job_id"" IN (
SELECT T2.""job_id""
FROM employee AS T2
WHERE T2.""employee_id"" = 1 -- Replace the employee number with an accurate employee's unique identifier, e.g.: 5,7,24.
);
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42703', 'M': 'column ""email"" does not exist', 'P': '245', 'F': 'parse_relation.c', 'L': '3727', 'R': 'errorMissingColumn'}
[SQL: 
WITH EmployeeNameParts AS (
SELECT
first_name,
last_name,
CASE
WHEN last_name IS NULL THEN CAST(first_name AS VARCHAR)
ELSE CAST(first_name || ' ' || last_name AS VARCHAR)
END AS full_name
FROM employee
)
SELECT
*
FROM EmployeeNameParts
WHERE
email LIKE '%@%' OR email IS NULL;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the full name of employees with their email domains",[],"
WITH EmployeeNameParts AS (
  SELECT
    first_name,
    last_name,
    CASE
      WHEN last_name IS NULL THEN CAST(first_name AS VARCHAR)
      ELSE CAST(first_name || ' ' || last_name AS VARCHAR)
    END AS full_name
  FROM employee
)
SELECT
  *
FROM EmployeeNameParts
WHERE
  email LIKE '%@%' OR email IS NULL;
```",,"[{'email_domain': 'example.com', 'full_name': 'John Doe'}, {'email_domain': 'example.com', 'full_name': 'Alice Smith'}, {'email_domain': 'example.com', 'full_name': 'Michael Johnson'}, {'email_domain': 'example.com', 'full_name': 'Emily Williams'}, {'email_domain': 'example.com', 'full_name': 'Matthew Brown'}, {'email_domain': 'example.com', 'full_name': 'Sarah Jones'}, {'email_domain': 'example.com', 'full_name': 'Christopher Davis'}, {'email_domain': 'example.com', 'full_name': 'Jessica Martinez'}, {'email_domain': 'example.com', 'full_name': 'Daniel Garcia'}, {'email_domain': 'example.com', 'full_name': 'Taylor Rodriguez'}, {'email_domain': 'example.com', 'full_name': 'David Lopez'}, {'email_domain': 'example.com', 'full_name': 'Megan Hernandez'}, {'email_domain': 'example.com', 'full_name': 'Andrew Gonzalez'}, {'email_domain': 'example.com', 'full_name': 'Sophia Perez'}, {'email_domain': 'example.com', 'full_name': 'Aiden Torres'}, {'email_domain': 'example.com', 'full_name': 'Olivia Rivera'}, {'email_domain': 'example.com', 'full_name': 'Liam Gomez'}, {'email_domain': 'example.com', 'full_name': 'Emma Reyes'}, {'email_domain': 'example.com', 'full_name': 'Noah King'}, {'email_domain': 'example.com', 'full_name': 'Charlotte Cooper'}]","[""SELECT CONCAT(first_name, ' ', last_name) AS full_name, SPLIT_PART(email, '@', 2) AS email_domain FROM employee;""]",187,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve the full name of employees with their email domains,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH EmployeeNameParts AS (
SELECT
first_name,
last_name,
CASE
WHEN last_name IS NULL THEN CAST(first_name AS VARCHAR)
ELSE CAST(first_name || ' ' || last_name AS VARCHAR)
END AS full_name
FROM employee
)
SELECT
*
FROM EmployeeNameParts
WHERE
email LIKE '%@%' OR email IS NULL;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'STRING']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Show the status and total amount of unpaid invoices",[],"
SELECT
  ""i"".""status"",
  ""i"".""total_amount""
FROM ""invoice"" AS ""i""
WHERE
  ""i"".""status"" = 'Unpaid';
```",,"[{'status': 'Pending', 'total_unpaid_amount': '17000.00'}]","[""SELECT status, SUM(total_amount) AS total_unpaid_amount FROM invoice WHERE status <> 'Paid' GROUP BY status;""]",181,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Show the status and total amount of unpaid invoices,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
""i"".""status"",
""i"".""total_amount""
FROM ""invoice"" AS ""i""
WHERE
""i"".""status"" = 'Unpaid';
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'AGGREGATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find companies with names ending in ""solu""",[],"
SELECT
    t2.""company_name""
FROM
    ""company"" AS t2
WHERE
    t2.""company_name"" LIKE '%solu'
ORDER BY
    t2.""company_name"" NULLS LAST;
```",,"[{'clients': ['Client A', 'Client B', 'Client C'], 'company_id': 1, 'company_name': 'ABC Tech Solutions', 'competitors': ['Competitor 1', 'Competitor 2', 'Competitor 3'], 'contact_email': 'john.doe@abctechsolutions.com', 'contact_person': 'John Doe', 'contact_phone': '+1234567890', 'financial_year_end': '2024-12-31', 'founded_date': '2005-06-15', 'industry': 'Information Technology', 'location': 'New York, NY', 'ownership_type': 'Private', 'partners': ['Partner A', 'Partner B', 'Partner C'], 'products': ['Product X', 'Product Y', 'Product Z'], 'size': 'Medium', 'social_media_facebook': 'facebook.com/abctechsolutions', 'social_media_instagram': 'instagram.com/abctechsolutions', 'social_media_linkedin': 'linkedin.com/company/abctechsolutions', 'social_media_x': None, 'website': 'www.abctechsolutions.com'}, {'clients': ['Client E', 'Client F'], 'company_id': 5, 'company_name': 'EFG Solutions', 'competitors': ['Competitor Y', 'Competitor Z'], 'contact_email': 'david@efgsolutions.com', 'contact_person': 'David Garcia', 'contact_phone': '+1678901234', 'financial_year_end': '2023-12-31', 'founded_date': '2012-09-25', 'industry': 'Consulting', 'location': 'Houston, TX', 'ownership_type': 'Public', 'partners': ['Partner S', 'Partner T', 'Partner U'], 'products': ['Service D', 'Service E'], 'size': 'Medium', 'social_media_facebook': None, 'social_media_instagram': None, 'social_media_linkedin': None, 'social_media_x': None, 'website': 'www.efgsolutions.com'}, {'clients': ['Client I', 'Client J', 'Client K'], 'company_id': 9, 'company_name': 'STU Solutions', 'competitors': ['Competitor G', 'Competitor H'], 'contact_email': 'william@stusolutions.com', 'contact_person': 'William Turner', 'contact_phone': '+1432109876', 'financial_year_end': '2023-12-31', 'founded_date': '2017-08-30', 'industry': 'Software', 'location': 'Dallas, TX', 'ownership_type': 'Public', 'partners': ['Partner O', 'Partner P', 'Partner Q'], 'products': ['Product V'], 'size': 'Small', 'social_media_facebook': 'facebook.com/stusolutions', 'social_media_instagram': 'instagram.com/stusolutions', 'social_media_linkedin': 'linkedin.com/company/stusolutions', 'social_media_x': None, 'website': 'www.stusolutions.com'}, {'clients': ['Client E', 'Client F'], 'company_id': 15, 'company_name': 'EFG Solutions', 'competitors': ['Competitor Y', 'Competitor Z'], 'contact_email': 'david@efgsolutions.com', 'contact_person': 'David Garcia', 'contact_phone': '+1678901234', 'financial_year_end': '2023-12-31', 'founded_date': '2012-09-25', 'industry': 'Consulting', 'location': 'Houston, TX', 'ownership_type': 'Public', 'partners': ['Partner S', 'Partner T', 'Partner U'], 'products': ['Service D', 'Service E'], 'size': 'Medium', 'social_media_facebook': None, 'social_media_instagram': None, 'social_media_linkedin': None, 'social_media_x': None, 'website': 'www.efgsolutions.com'}, {'clients': ['Client I', 'Client J', 'Client K'], 'company_id': 19, 'company_name': 'STU Solutions', 'competitors': ['Competitor G', 'Competitor H'], 'contact_email': 'william@stusolutions.com', 'contact_person': 'William Turner', 'contact_phone': '+1432109876', 'financial_year_end': '2023-12-31', 'founded_date': '2017-08-30', 'industry': 'Software', 'location': 'Dallas, TX', 'ownership_type': 'Public', 'partners': ['Partner O', 'Partner P', 'Partner Q'], 'products': ['Product V'], 'size': 'Small', 'social_media_facebook': 'facebook.com/stusolutions', 'social_media_instagram': 'instagram.com/stusolutions', 'social_media_linkedin': 'linkedin.com/company/stusolutions', 'social_media_x': None, 'website': 'www.stusolutions.com'}]","[""SELECT * FROM company WHERE LOWER(company_name) LIKE '%solu%';""]",183,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Find companies with names ending in ""solu""","{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
t2.""company_name""
FROM
""company"" AS t2
WHERE
t2.""company_name"" LIKE '%solu'
ORDER BY
t2.""company_name"" NULLS LAST;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'STRING']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve employees who have attended trainings related to either Leadership or Communication.","[{'employee_id': 3536255}, {'employee_id': 3536265}, {'employee_id': 3536251}, {'employee_id': 3536268}]","
-- Find employees who have participated in leadership or communication training

SELECT DISTINCT
    e.employee_id
FROM
    employee AS e
INNER JOIN
    employee_training AS et
ON
    e.employee_id = et.employee_id
INNER JOIN
    training AS t
ON
    et.training_id = t.training_id
WHERE
    t.title LIKE '%Leadership%' OR t.title LIKE '%Communication%';
```",,"[{'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown'}, {'employee_id': 3536257, 'first_name': 'Christopher', 'last_name': 'Davis'}]","[""SELECT e.employee_id, e.first_name, e.last_name FROM employee e WHERE EXISTS ( SELECT 1 FROM employee_training et JOIN training t ON et.training_id = t.training_id WHERE et.employee_id = e.employee_id AND t.title IN ('Leadership Development Seminar', 'Sales Techniques Workshop') );""]",154,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve employees who have attended trainings related to either Leadership or Communication.,"{'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""title in (\'Leadership Development Seminar\', \'Sales Techniques Workshop\')""'}",,dql,2025-02-10 18:36:22.083420,"
-- Find employees who have participated in leadership or communication training

SELECT DISTINCT
e.employee_id
FROM
employee AS e
INNER JOIN
employee_training AS et
ON
e.employee_id = et.employee_id
INNER JOIN
training AS t
ON
et.training_id = t.training_id
WHERE
t.title LIKE '%Leadership%' OR t.title LIKE '%Communication%';
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the names of employees who have skills in a Java programming language.",[],"
SELECT e.""first_name"", e.""last_name""
FROM ""employee"" AS e
JOIN ""job"" AS j ON e.""job_id"" = j.""job_id""
WHERE j.""skills_required"" @> '{
  ""programming_languages"": [""Java""]
}'
OR j.""skills_preferred"" @> '{
  ""programming_languages"": [""Java""]
}';
```",,"[{'first_name': 'John', 'last_name': 'Doe', 'skills_required': {'Java': 'Advanced', 'Python': 'Intermediate', 'SQL': 'Intermediate'}}, {'first_name': 'Emily', 'last_name': 'Williams', 'skills_required': {'Java': 'Advanced', 'Python': 'Intermediate', 'SQL': 'Intermediate'}}, {'first_name': 'Christopher', 'last_name': 'Davis', 'skills_required': {'Java': 'Advanced', 'Python': 'Intermediate', 'SQL': 'Intermediate'}}, {'first_name': 'Taylor', 'last_name': 'Rodriguez', 'skills_required': {'Java': 'Advanced', 'Python': 'Intermediate', 'SQL': 'Intermediate'}}, {'first_name': 'Andrew', 'last_name': 'Gonzalez', 'skills_required': {'Java': 'Advanced', 'Python': 'Intermediate', 'SQL': 'Intermediate'}}, {'first_name': 'Olivia', 'last_name': 'Rivera', 'skills_required': {'Java': 'Advanced', 'Python': 'Intermediate', 'SQL': 'Intermediate'}}, {'first_name': 'Noah', 'last_name': 'King', 'skills_required': {'Java': 'Advanced', 'Python': 'Intermediate', 'SQL': 'Intermediate'}}]","[""SELECT a.first_name, a.last_name, b.skills_required FROM employee a INNER JOIN job b ON a.job_id = b.job_id WHERE b.skills_required ->> 'Java' = 'Advanced';""]",177,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve the names of employees who have skills in a Java programming language.,"{'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""skills_required ->> \'Java\' = \'Advanced\'""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT e.""first_name"", e.""last_name""
FROM ""employee"" AS e
JOIN ""job"" AS j ON e.""job_id"" = j.""job_id""
WHERE j.""skills_required"" @> '{
""programming_languages"": [""Java""]
}'
OR j.""skills_preferred"" @> '{
""programming_languages"": [""Java""]
}';
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'JSON_SEARCH']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find employees who have certifications from either AWS or Microsoft.","[{'first_name': 'John', 'last_name': 'Doe'}, {'first_name': 'Emily', 'last_name': 'Williams'}]","
-- Select the employee's first and last name
SELECT
    e.""first_name"",
    e.""last_name""
-- From the ""employee_certification"" table, aliased as ""ec""
FROM 
    ""employee_certification"" AS ec
-- Join the ""employee"" table, aliased as ""e"", on the ""employee_id""
JOIN 
    ""employee"" AS e ON ec.""employee_id"" = e.""employee_id""
-- Where the ""certification_name"" contains either ""AWS"" or ""Microsoft"" (case-insensitive)
WHERE
    ec.""certification_name"" ILIKE '%AWS%' OR ec.""certification_name"" ILIKE '%Microsoft%';
```",,"[{'employee_id': 3536254, 'first_name': 'Emily', 'last_name': 'Williams'}]","[""SELECT e.employee_id, e.first_name, e.last_name FROM employee e WHERE EXISTS ( SELECT 1 FROM employee_certification ec WHERE ec.employee_id = e.employee_id AND ec.issuing_organization IN ('AWS', 'Microsoft') );""]",157,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Find employees who have certifications from either AWS or Microsoft.,"{'Compare Type': '""Execution result""', 'Context': '""Match""', 'Extra context': '""issuing_organization IN (\'AWS\', \'Microsoft\')""'}",,dql,2025-02-10 18:36:22.083420,"
-- Select the employee's first and last name
SELECT
e.""first_name"",
e.""last_name""
-- From the ""employee_certification"" table, aliased as ""ec""
FROM 
""employee_certification"" AS ec
-- Join the ""employee"" table, aliased as ""e"", on the ""employee_id""
JOIN 
""employee"" AS e ON ec.""employee_id"" = e.""employee_id""
-- Where the ""certification_name"" contains either ""AWS"" or ""Microsoft"" (case-insensitive)
WHERE
ec.""certification_name"" ILIKE '%AWS%' OR ec.""certification_name"" ILIKE '%Microsoft%';
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Display leave requests with reasons containing the word ""vacation",[],"
SELECT
  request.leave_id,
  request.employee_id,
  employee.first_name,
  employee.last_name,
  request.leave_type,
  request.start_date,
  request.end_date,
  request.reason,
  CASE
    WHEN request.status = 'Approved' THEN 'Approved'
    WHEN request.status = 'Pending' THEN 'Pending'
    WHEN request.status = 'Rejected' THEN 'Rejected'
    ELSE 'Unknown'
  END AS status
FROM leave_request AS request
INNER JOIN employee AS employee
  ON request.employee_id = employee.employee_id
WHERE
  request.reason LIKE '%vacation%'
ORDER BY
  request.leave_id;
```",,"[{'approval_date': '2023-01-01', 'attachment': None, 'comments': 'Enjoy your vacation!', 'duration': '5.00', 'employee_id': 3536251, 'end_date': '2023-01-05', 'leave_id': 1, 'leave_type': 'Annual Leave', 'processed_by': 3536251, 'reason': 'Vacation', 'rejection_date': None, 'start_date': '2023-01-01', 'status': 'Approved'}, {'approval_date': None, 'attachment': None, 'comments': 'Leave request denied', 'duration': '3.00', 'employee_id': 3536254, 'end_date': '2023-04-22', 'leave_id': 4, 'leave_type': 'Annual Leave', 'processed_by': 3536251, 'reason': 'Vacation', 'rejection_date': '2023-04-15', 'start_date': '2023-04-20', 'status': 'Rejected'}, {'approval_date': None, 'attachment': None, 'comments': 'Planning a trip', 'duration': '5.00', 'employee_id': 3536256, 'end_date': '2023-06-14', 'leave_id': 6, 'leave_type': 'Annual Leave', 'processed_by': None, 'reason': 'Vacation', 'rejection_date': None, 'start_date': '2023-06-10', 'status': 'Pending'}, {'approval_date': None, 'attachment': None, 'comments': 'Need a break', 'duration': '6.00', 'employee_id': 3536258, 'end_date': '2023-08-20', 'leave_id': 8, 'leave_type': 'Annual Leave', 'processed_by': None, 'reason': 'Vacation', 'rejection_date': None, 'start_date': '2023-08-15', 'status': 'Pending'}, {'approval_date': '2023-09-30', 'attachment': None, 'comments': 'Going on a trip', 'duration': '6.00', 'employee_id': 3536260, 'end_date': '2023-10-15', 'leave_id': 10, 'leave_type': 'Annual Leave', 'processed_by': 3536269, 'reason': 'Vacation', 'rejection_date': None, 'start_date': '2023-10-10', 'status': 'Approved'}, {'approval_date': '2024-02-10', 'attachment': None, 'comments': 'Taking a short vacation', 'duration': '3.00', 'employee_id': 3536264, 'end_date': '2024-02-17', 'leave_id': 14, 'leave_type': 'Annual Leave', 'processed_by': 3536254, 'reason': 'Vacation', 'rejection_date': None, 'start_date': '2024-02-15', 'status': 'Approved'}, {'approval_date': '2024-03-30', 'attachment': None, 'comments': 'Planning a trip', 'duration': '4.00', 'employee_id': 3536266, 'end_date': '2024-04-08', 'leave_id': 16, 'leave_type': 'Annual Leave', 'processed_by': 3536254, 'reason': 'Vacation', 'rejection_date': None, 'start_date': '2024-04-05', 'status': 'Approved'}, {'approval_date': '2024-06-10', 'attachment': None, 'comments': 'Taking a break', 'duration': '6.00', 'employee_id': 3536268, 'end_date': '2024-06-20', 'leave_id': 18, 'leave_type': 'Annual Leave', 'processed_by': 3536254, 'reason': 'Vacation', 'rejection_date': None, 'start_date': '2024-06-15', 'status': 'Approved'}]","[""SELECT * FROM leave_request WHERE LOWER(reason) LIKE '%vacation%';""]",184,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Display leave requests with reasons containing the word ""vacation","{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
request.leave_id,
request.employee_id,
employee.first_name,
employee.last_name,
request.leave_type,
request.start_date,
request.end_date,
request.reason,
CASE
WHEN request.status = 'Approved' THEN 'Approved'
WHEN request.status = 'Pending' THEN 'Pending'
WHEN request.status = 'Rejected' THEN 'Rejected'
ELSE 'Unknown'
END AS status
FROM leave_request AS request
INNER JOIN employee AS employee
ON request.employee_id = employee.employee_id
WHERE
request.reason LIKE '%vacation%'
ORDER BY
request.leave_id;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'STRING', 'LIKE']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42P01', 'M': 'relation ""address"" does not exist', 'P': '90', 'F': 'parse_relation.c', 'L': '1452', 'R': 'parserOpenTable'}
[SQL: 
SELECT
e.first_name || ' ' || e.last_name AS employee_name
FROM employee AS e
LEFT JOIN address AS ad
ON e.address = ad.id
WHERE
ad.city = 'Newtown';
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the names of employees who live in a Newtown city.",[],"
SELECT
  e.first_name || ' ' || e.last_name AS employee_name
FROM employee AS e
LEFT JOIN address AS ad
  ON e.address = ad.id
WHERE
  ad.city = 'Newtown';
```",,"[{'address': {'city': 'Newtown', 'state': 'WA', 'street': '555 Cedar St', 'zip': '12345'}, 'first_name': 'Sarah', 'last_name': 'Jones'}, {'address': {'city': 'Newtown', 'state': 'WA', 'street': '444 Cedar St', 'zip': '12345'}, 'first_name': 'Daniel', 'last_name': 'Garcia'}, {'address': {'city': 'Newtown', 'state': 'WA', 'street': '678 Cedar St', 'zip': '12345'}, 'first_name': 'Andrew', 'last_name': 'Gonzalez'}]","[""SELECT first_name, last_name, address FROM employee WHERE address->>'city' = 'Newtown';""]",217,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve the names of employees who live in a Newtown city.,"{'Compare Type': '""Execution result match""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
e.first_name || ' ' || e.last_name AS employee_name
FROM employee AS e
LEFT JOIN address AS ad
ON e.address = ad.id
WHERE
ad.city = 'Newtown';
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


What are the top 5 employees that have more benefits in 2022?",[],"
WITH EmployeeBenefits AS (
    SELECT
        eb.""employee_id"",
        COUNT(eb.benefit_id) AS benefit_count
    FROM
        ""employee_x_benefit"" eb
    JOIN
        ""benefit"" b ON eb.benefit_id = b.benefit_id
    WHERE
        b.end_date >= '2022-01-01' AND b.start_date <= '2022-12-31'
    GROUP BY
        1
), RankedEmployees AS (
    SELECT
        eb.""employee_id"",
        eb.benefit_count,
        DENSE_RANK() OVER (ORDER BY benefit_count DESC) AS rank
    FROM
        EmployeeBenefits eb
)
SELECT
    e.""first_name"",
    e.""last_name""
FROM
    ""employee"" e
JOIN
    RankedEmployees re ON e.""employee_id"" = re.""employee_id""
WHERE
    re.rank <= 5;
```",,[],"[""SELECT e.employee_id, e.first_name, e.last_name, COUNT(*) AS total_benefits FROM employee e JOIN employee_x_benefit xb ON e.employee_id = xb.employee_id WHERE DATE_TRUNC('year', xb.start_date) = DATE_TRUNC('year', CURRENT_DATE - INTERVAL '2' YEAR) GROUP BY e.employee_id, e.first_name, e.last_name ORDER BY total_benefits DESC LIMIT 5;""]",203,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,What are the top 5 employees that have more benefits in 2022?,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH EmployeeBenefits AS (
SELECT
eb.""employee_id"",
COUNT(eb.benefit_id) AS benefit_count
FROM
""employee_x_benefit"" eb
JOIN
""benefit"" b ON eb.benefit_id = b.benefit_id
WHERE
b.end_date >= '2022-01-01' AND b.start_date <= '2022-12-31'
GROUP BY
1
), RankedEmployees AS (
SELECT
eb.""employee_id"",
eb.benefit_count,
DENSE_RANK() OVER (ORDER BY benefit_count DESC) AS rank
FROM
EmployeeBenefits eb
)
SELECT
e.""first_name"",
e.""last_name""
FROM
""employee"" e
JOIN
RankedEmployees re ON e.""employee_id"" = re.""employee_id""
WHERE
re.rank <= 5;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'DATE', 'JOIN', 'AGGREGATE', 'SORT', 'LIMIT']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42P01', 'M': 'relation ""Employee Travel"" does not exist', 'P': '167', 'F': 'parse_relation.c', 'L': '1452', 'R': 'parserOpenTable'}
[SQL: 
SELECT
""Travel"".travel_destination,
""Travel"".travel_purpose,
SUM(
""Employee Allowance"".""Amount"" * ""Employee Allowance"".""Type""
) AS ""Total Travel Reimbursement""
FROM ""Employee Travel"" AS ""Travel""
LEFT JOIN ""Employee Allowance"" AS ""Employee Allowance""
ON ""Travel"".""employee_id"" = ""Employee Allowance"".""employee_id""
WHERE
""Employee Allowance"".""type"" = 'Travel Reimbursement'
AND ""Employee Allowance"".""date_created"" >= CURRENT_DATE - INTERVAL '3 months'
GROUP BY
""Travel"".travel_destination,
""Travel"".travel_purpose
ORDER BY
""Travel"".travel_destination,
""Travel"".travel_purpose NULLS LAST;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Calculate the total cost of travel allowances reimbursed to employees for business trips to different locations in the last quarter, categorized by travel destination and purpose",[],"
SELECT
  ""Travel"".travel_destination,
  ""Travel"".travel_purpose,
  SUM(
    ""Employee Allowance"".""Amount"" * ""Employee Allowance"".""Type""
  ) AS ""Total Travel Reimbursement""
FROM ""Employee Travel"" AS ""Travel""
LEFT JOIN ""Employee Allowance"" AS ""Employee Allowance""
  ON ""Travel"".""employee_id"" = ""Employee Allowance"".""employee_id""
WHERE
  ""Employee Allowance"".""type"" = 'Travel Reimbursement'
  AND ""Employee Allowance"".""date_created"" >= CURRENT_DATE - INTERVAL '3 months'
GROUP BY
  ""Travel"".travel_destination,
  ""Travel"".travel_purpose
ORDER BY
  ""Travel"".travel_destination,
  ""Travel"".travel_purpose NULLS LAST;
```",,"[{'total_travel_allowances': '2300.50', 'travel_destination': 'Salt Lake City, UT', 'travel_purpose': 'Vendor Meeting'}, {'total_travel_allowances': '2500.00', 'travel_destination': 'Orlando, FL', 'travel_purpose': 'Project Review'}]","[""SELECT et.travel_destination, et.travel_purpose, SUM(et.travel_expenses) AS total_travel_allowances FROM employee_travel et WHERE et.travel_start_date BETWEEN CURRENT_DATE - INTERVAL '3 MONTH' AND CURRENT_DATE GROUP BY et.travel_destination, et.travel_purpose;""]",209,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Calculate the total cost of travel allowances reimbursed to employees for business trips to different locations in the last quarter, categorized by travel destination and purpose","{'Compare Type': '""Execution result match""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
""Travel"".travel_destination,
""Travel"".travel_purpose,
SUM(
""Employee Allowance"".""Amount"" * ""Employee Allowance"".""Type""
) AS ""Total Travel Reimbursement""
FROM ""Employee Travel"" AS ""Travel""
LEFT JOIN ""Employee Allowance"" AS ""Employee Allowance""
ON ""Travel"".""employee_id"" = ""Employee Allowance"".""employee_id""
WHERE
""Employee Allowance"".""type"" = 'Travel Reimbursement'
AND ""Employee Allowance"".""date_created"" >= CURRENT_DATE - INTERVAL '3 months'
GROUP BY
""Travel"".travel_destination,
""Travel"".travel_purpose
ORDER BY
""Travel"".travel_destination,
""Travel"".travel_purpose NULLS LAST;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'AGGREGATE', 'DATE']",
[],db_hr,['postgres'],[None],"(pg8000.exceptions.DatabaseError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42P01', 'M': 'relation ""job_change_counts"" does not exist', 'P': '104', 'F': 'parse_relation.c', 'L': '1452', 'R': 'parserOpenTable'}
[SQL: 
WITH JobChangeCounts AS (
SELECT
jhc.employee_id,
COUNT(*) AS job_changes
FROM job_history AS jh
JOIN job_change_counts AS jhc
ON jh.job_history_id = jhc.job_history_id
WHERE
jh.end_date >= CURRENT_DATE - INTERVAL '3 years'
GROUP BY
jhc.employee_id
), CurrentJobDetails AS (
SELECT
jhh.employee_id,
j.job_title AS current_job_title,
d.department_name AS current_department_name
FROM job_history AS jhh
JOIN job AS j
ON jhh.job_id = j.job_id
JOIN department AS d
ON jhh.department_id = d.department_id
WHERE
jhh.end_date IS NULL
)
SELECT
jc.employee_id,
cj.current_job_title,
cj.current_department_name,
jc.job_changes
FROM JobChangeCounts AS jc
JOIN CurrentJobDetails AS cj
ON jc.employee_id = cj.employee_id
WHERE
jc.job_changes > 3;
]
(Background on this error at: https://sqlalche.me/e/20/4xp6)","You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Identify employees with a high number of job changes in the last three years, along with their current job titles and departmental information",[],"
WITH JobChangeCounts AS (
  SELECT
    jhc.employee_id,
    COUNT(*) AS job_changes
  FROM job_history AS jh
  JOIN job_change_counts AS jhc
    ON jh.job_history_id = jhc.job_history_id
  WHERE
    jh.end_date >= CURRENT_DATE - INTERVAL '3 years'
  GROUP BY
    jhc.employee_id
), CurrentJobDetails AS (
  SELECT
    jhh.employee_id,
    j.job_title AS current_job_title,
    d.department_name AS current_department_name
  FROM job_history AS jhh
  JOIN job AS j
    ON jhh.job_id = j.job_id
  JOIN department AS d
    ON jhh.department_id = d.department_id
  WHERE
    jhh.end_date IS NULL
)
SELECT
  jc.employee_id,
  cj.current_job_title,
  cj.current_department_name,
  jc.job_changes
FROM JobChangeCounts AS jc
JOIN CurrentJobDetails AS cj
  ON jc.employee_id = cj.employee_id
WHERE
  jc.job_changes > 3;
```",,[],"[""SELECT e.employee_id, e.first_name, e.last_name, e.email, j.job_title, d.department_name, COUNT(DISTINCT jh.job_history_id) AS job_changes FROM public.employee e JOIN public.job_history jh ON e.employee_id = jh.employee_id AND jh.start_date > CURRENT_DATE - INTERVAL '3 YEAR' JOIN public.job j ON jh.job_id = j.job_id JOIN public.department d ON j.department_id = d.department_id GROUP BY e.employee_id, e.first_name, e.last_name, e.email, j.job_title, d.department_name ORDER BY job_changes DESC;""]",208,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Identify employees with a high number of job changes in the last three years, along with their current job titles and departmental information","{'Compare Type': '""Execution result match""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH JobChangeCounts AS (
SELECT
jhc.employee_id,
COUNT(*) AS job_changes
FROM job_history AS jh
JOIN job_change_counts AS jhc
ON jh.job_history_id = jhc.job_history_id
WHERE
jh.end_date >= CURRENT_DATE - INTERVAL '3 years'
GROUP BY
jhc.employee_id
), CurrentJobDetails AS (
SELECT
jhh.employee_id,
j.job_title AS current_job_title,
d.department_name AS current_department_name
FROM job_history AS jhh
JOIN job AS j
ON jhh.job_id = j.job_id
JOIN department AS d
ON jhh.department_id = d.department_id
WHERE
jhh.end_date IS NULL
)
SELECT
jc.employee_id,
cj.current_job_title,
cj.current_department_name,
jc.job_changes
FROM JobChangeCounts AS jc
JOIN CurrentJobDetails AS cj
ON jc.employee_id = cj.employee_id
WHERE
jc.job_changes > 3;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'AGGREGATE', 'JOIN', 'SORT', 'DATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Find benefits with names starting with ""Health""",[{'benefit_name': 'Health Insurance'}],"
SELECT
  ""benefit_name""
FROM
  ""benefit""
WHERE
  ""benefit_name"" LIKE 'Health%'
ORDER BY
  ""benefit_name"" ASC;
```",,"[{'benefit_id': 1, 'benefit_name': 'Health Insurance', 'contact_info': 'healthinsurance@abcinsurance.com', 'coverage': 'Medical, Dental, Vision', 'description': 'Comprehensive health coverage for employees and their families.', 'eligibility_criteria': {'criteria': 'Employee must work full-time and complete probation period'}, 'end_date': None, 'provider': 'ABC Insurance Company', 'start_date': '2023-01-01', 'usage_instructions': 'Follow instructions provided by HR department.'}]","[""SELECT * FROM benefit WHERE LOWER(benefit_name) LIKE 'health%';""]",185,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"Find benefits with names starting with ""Health""","{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
""benefit_name""
FROM
""benefit""
WHERE
""benefit_name"" LIKE 'Health%'
ORDER BY
""benefit_name"" ASC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'STRING', 'LIKE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


What is the average salary in the company?",[{'avg_salary': '71000.000000000000'}],"SELECT avg(""salary"".""salary"") AS ""avg_salary"" FROM ""salary""",,[{'averagesalary': '71000.00'}],"['SELECT ROUND(AVG(salary),2) AS AverageSalary FROM employee e JOIN salary s ON e.employee_id = s.employee_id;']",202,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,What is the average salary in the company?,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"SELECT avg(""salary"".""salary"") AS ""avg_salary"" FROM ""salary""",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'JOIN', 'AGGREGATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


How many employees are eligible for retirement within the next sixty five years?",[{'count': 0}],"
SELECT COUNT(*)
FROM employee AS e
WHERE extract(YEAR FROM date_of_birth) + 65 <= extract(YEAR FROM NOW() + interval '1 year');
```",,[{'total_eligible_for_retirement': 19}],"[""SELECT COUNT(*) AS total_eligible_for_retirement FROM public.employee WHERE date_of_birth <= CURRENT_DATE - INTERVAL '30 years' AND date_of_birth >= CURRENT_DATE - INTERVAL '95 years';""]",204,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,How many employees are eligible for retirement within the next sixty five years?,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT COUNT(*)
FROM employee AS e
WHERE extract(YEAR FROM date_of_birth) + 65 <= extract(YEAR FROM NOW() + interval '1 year');
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'AGGREGATE', 'DATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Rank departments based on their budget in increasing order.","[{'budget': '100000.00', 'department_name': 'Human Resources'}, {'budget': '100000.00', 'department_name': 'Training and Development'}, {'budget': '120000.00', 'department_name': 'Administration'}, {'budget': '120000.00', 'department_name': 'Customer Service'}, {'budget': '130000.00', 'department_name': 'Public Relations'}, {'budget': '130000.00', 'department_name': 'Quality Assurance'}, {'budget': '150000.00', 'department_name': 'Marketing'}, {'budget': '150000.00', 'department_name': 'Safety and Compliance'}, {'budget': '160000.00', 'department_name': 'Product Management'}, {'budget': '160000.00', 'department_name': 'Operations'}, {'budget': '170000.00', 'department_name': 'Customer Success'}, {'budget': '180000.00', 'department_name': 'Sales'}, {'budget': '180000.00', 'department_name': 'Supply Chain'}, {'budget': '190000.00', 'department_name': 'Legal'}, {'budget': '200000.00', 'department_name': 'Finance'}, {'budget': '200000.00', 'department_name': 'Logistics'}, {'budget': '220000.00', 'department_name': 'IT'}, {'budget': '250000.00', 'department_name': 'Research and Development'}, {'budget': '280000.00', 'department_name': 'Engineering'}, {'budget': '300000.00', 'department_name': 'Production'}]","
SELECT
  d.department_name,
  d.budget
FROM department AS d
ORDER BY
  d.budget ASC;
```",,"[{'budget': '100000.00', 'budget_rank': 1, 'department_id': 1, 'department_name': 'Human Resources'}, {'budget': '100000.00', 'budget_rank': 1, 'department_id': 14, 'department_name': 'Training and Development'}, {'budget': '120000.00', 'budget_rank': 3, 'department_id': 11, 'department_name': 'Administration'}, {'budget': '120000.00', 'budget_rank': 3, 'department_id': 7, 'department_name': 'Customer Service'}, {'budget': '130000.00', 'budget_rank': 5, 'department_id': 19, 'department_name': 'Public Relations'}, {'budget': '130000.00', 'budget_rank': 5, 'department_id': 9, 'department_name': 'Quality Assurance'}, {'budget': '150000.00', 'budget_rank': 7, 'department_id': 2, 'department_name': 'Marketing'}, {'budget': '150000.00', 'budget_rank': 7, 'department_id': 15, 'department_name': 'Safety and Compliance'}, {'budget': '160000.00', 'budget_rank': 9, 'department_id': 20, 'department_name': 'Product Management'}, {'budget': '160000.00', 'budget_rank': 9, 'department_id': 6, 'department_name': 'Operations'}, {'budget': '170000.00', 'budget_rank': 11, 'department_id': 16, 'department_name': 'Customer Success'}, {'budget': '180000.00', 'budget_rank': 12, 'department_id': 4, 'department_name': 'Sales'}, {'budget': '180000.00', 'budget_rank': 12, 'department_id': 13, 'department_name': 'Supply Chain'}, {'budget': '190000.00', 'budget_rank': 14, 'department_id': 10, 'department_name': 'Legal'}, {'budget': '200000.00', 'budget_rank': 15, 'department_id': 3, 'department_name': 'Finance'}, {'budget': '200000.00', 'budget_rank': 15, 'department_id': 18, 'department_name': 'Logistics'}, {'budget': '220000.00', 'budget_rank': 17, 'department_id': 5, 'department_name': 'IT'}, {'budget': '250000.00', 'budget_rank': 18, 'department_id': 8, 'department_name': 'Research and Development'}, {'budget': '280000.00', 'budget_rank': 19, 'department_id': 17, 'department_name': 'Engineering'}, {'budget': '300000.00', 'budget_rank': 20, 'department_id': 12, 'department_name': 'Production'}]","['SELECT department_id, department_name, budget, RANK() OVER (ORDER BY budget) AS budget_rank FROM department;']",218,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Rank departments based on their budget in increasing order.,"{'Compare Type': '""Execution result match""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
d.department_name,
d.budget
FROM department AS d
ORDER BY
d.budget ASC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'RANK']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Calculate the total business expenses for each employee.","[{'Total Business Expenses': '700.00', 'employee_id': 3536260, 'first_name': 'Taylor', 'last_name': 'Rodriguez'}, {'Total Business Expenses': '545.75', 'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones'}, {'Total Business Expenses': '390.00', 'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe'}, {'Total Business Expenses': '260.00', 'employee_id': 3536254, 'first_name': 'Emily', 'last_name': 'Williams'}, {'Total Business Expenses': '195.50', 'employee_id': 3536259, 'first_name': 'Daniel', 'last_name': 'Garcia'}, {'Total Business Expenses': '175.00', 'employee_id': 3536253, 'first_name': 'Michael', 'last_name': 'Johnson'}, {'Total Business Expenses': '170.95', 'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown'}, {'Total Business Expenses': '170.50', 'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith'}, {'Total Business Expenses': '135.25', 'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez'}, {'Total Business Expenses': '50.00', 'employee_id': 3536257, 'first_name': 'Christopher', 'last_name': 'Davis'}, {'Total Business Expenses': '0', 'employee_id': 3536263, 'first_name': 'Andrew', 'last_name': 'Gonzalez'}, {'Total Business Expenses': '0', 'employee_id': 3536264, 'first_name': 'Sophia', 'last_name': 'Perez'}, {'Total Business Expenses': '0', 'employee_id': 3536269, 'first_name': 'Noah', 'last_name': 'King'}, {'Total Business Expenses': '0', 'employee_id': 3536268, 'first_name': 'Emma', 'last_name': 'Reyes'}, {'Total Business Expenses': '0', 'employee_id': 3536262, 'first_name': 'Megan', 'last_name': 'Hernandez'}, {'Total Business Expenses': '0', 'employee_id': 3536270, 'first_name': 'Charlotte', 'last_name': 'Cooper'}, {'Total Business Expenses': '0', 'employee_id': 3536267, 'first_name': 'Liam', 'last_name': 'Gomez'}, {'Total Business Expenses': '0', 'employee_id': 3536266, 'first_name': 'Olivia', 'last_name': 'Rivera'}, {'Total Business Expenses': '0', 'employee_id': 3536265, 'first_name': 'Aiden', 'last_name': 'Torres'}, {'Total Business Expenses': '0', 'employee_id': 3536261, 'first_name': 'David', 'last_name': 'Lopez'}]","
SELECT e.""employee_id"", e.""first_name"", e.""last_name"", COALESCE(SUM(eb.""expense_amount""), 0) AS ""Total Business Expenses""
FROM ""employee"" AS e
LEFT JOIN ""employee_business_expense"" AS eb ON e.""employee_id"" = eb.""employee_id""
GROUP BY e.""employee_id"", e.""first_name"", e.""last_name""
ORDER BY ""Total Business Expenses"" DESC;
```",,"[{'employee_id': 3536252, 'total_business_expenses': '170.50'}, {'employee_id': 3536258, 'total_business_expenses': '135.25'}, {'employee_id': 3536259, 'total_business_expenses': '195.50'}, {'employee_id': 3536256, 'total_business_expenses': '545.75'}, {'employee_id': 3536251, 'total_business_expenses': '390.00'}, {'employee_id': 3536254, 'total_business_expenses': '260.00'}, {'employee_id': 3536260, 'total_business_expenses': '700.00'}, {'employee_id': 3536253, 'total_business_expenses': '175.00'}, {'employee_id': 3536257, 'total_business_expenses': '50.00'}, {'employee_id': 3536255, 'total_business_expenses': '170.95'}]","['SELECT ebe.employee_id, SUM(expense_amount) AS total_business_expenses FROM employee_business_expense ebe GROUP BY ebe.employee_id;']",182,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Calculate the total business expenses for each employee.,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT e.""employee_id"", e.""first_name"", e.""last_name"", COALESCE(SUM(eb.""expense_amount""), 0) AS ""Total Business Expenses""
FROM ""employee"" AS e
LEFT JOIN ""employee_business_expense"" AS eb ON e.""employee_id"" = eb.""employee_id""
GROUP BY e.""employee_id"", e.""first_name"", e.""last_name""
ORDER BY ""Total Business Expenses"" DESC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: simple', 'SELECT', 'AGGREGATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List all employees who are eligible for the ""Health Insurance"" benefit.","[{'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe'}]","
SELECT
  ""e"".""employee_id"",
  ""e"".""first_name"",
  ""e"".""last_name""
FROM ""employee"" AS ""e""
INNER JOIN ""employee_x_benefit"" AS ""exb""
  ON ""e"".""employee_id"" = ""exb"".""employee_id""
INNER JOIN ""benefit"" AS ""b""
  ON ""exb"".""benefit_id"" = ""b"".""benefit_id""
WHERE
  ""b"".""benefit_name"" = 'Health Insurance';
```
",,"[{'first_name': 'John', 'last_name': 'Doe'}]","[""SELECT e.first_name, e.last_name FROM employee e JOIN employee_x_benefit eb ON e.employee_id = eb.employee_id JOIN benefit b ON eb.benefit_id = b.benefit_id WHERE b.benefit_name = 'Health Insurance';""]",207,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"List all employees who are eligible for the ""Health Insurance"" benefit.","{'Compare Type': '""Execution result match""', 'Context': '""Match""', 'Extra context': '""benefit_name = \'Health Insurance\'""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
""e"".""employee_id"",
""e"".""first_name"",
""e"".""last_name""
FROM ""employee"" AS ""e""
INNER JOIN ""employee_x_benefit"" AS ""exb""
ON ""e"".""employee_id"" = ""exb"".""employee_id""
INNER JOIN ""benefit"" AS ""b""
ON ""exb"".""benefit_id"" = ""b"".""benefit_id""
WHERE
""b"".""benefit_name"" = 'Health Insurance';

",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List all employees who have utilized more than 3 annual leave entitlement by the current month.","[{'employee_id': 3536251, 'first_name': 'John', 'last_name': 'Doe', 'total_annual_leave_taken': '5.00'}, {'employee_id': 3536256, 'first_name': 'Sarah', 'last_name': 'Jones', 'total_annual_leave_taken': '5.00'}, {'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez', 'total_annual_leave_taken': '6.00'}, {'employee_id': 3536260, 'first_name': 'Taylor', 'last_name': 'Rodriguez', 'total_annual_leave_taken': '6.00'}, {'employee_id': 3536266, 'first_name': 'Olivia', 'last_name': 'Rivera', 'total_annual_leave_taken': '4.00'}, {'employee_id': 3536268, 'first_name': 'Emma', 'last_name': 'Reyes', 'total_annual_leave_taken': '6.00'}]","
SELECT
  emp.employee_id,
  emp.first_name,
  emp.last_name,
  SUM(lv.duration) AS total_annual_leave_taken
FROM employee AS emp
JOIN leave_request AS lv
  ON emp.employee_id = lv.employee_id
WHERE
  lv.leave_type = 'Annual Leave' AND lv.start_date < CURRENT_DATE
GROUP BY
  emp.employee_id,
  emp.first_name,
  emp.last_name
HAVING
  SUM(lv.duration) > 3
ORDER BY
  emp.employee_id;
```",,[],"['SELECT e.employee_id, e.first_name, SUM(duration) FROM employee e JOIN leave_request l ON e.employee_id = l.employee_id WHERE EXTRACT(YEAR FROM l.start_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND EXTRACT(MONTH FROM l.start_date) <= EXTRACT(MONTH FROM CURRENT_DATE) GROUP BY e.employee_id, e.first_name HAVING SUM(duration) >3;']",205,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,List all employees who have utilized more than 3 annual leave entitlement by the current month.,"{'Compare Type': '""Execution result match""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
emp.employee_id,
emp.first_name,
emp.last_name,
SUM(lv.duration) AS total_annual_leave_taken
FROM employee AS emp
JOIN leave_request AS lv
ON emp.employee_id = lv.employee_id
WHERE
lv.leave_type = 'Annual Leave' AND lv.start_date < CURRENT_DATE
GROUP BY
emp.employee_id,
emp.first_name,
emp.last_name
HAVING
SUM(lv.duration) > 3
ORDER BY
emp.employee_id;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'AGGREGATE', 'HAVING', 'DATE']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve employees who have skills in either mrketingh or selenium.",[],"
SELECT emp.employee_id, emp.first_name, emp.last_name, emp.email, j.job_title, j.job_description
FROM employee emp
INNER JOIN job j ON emp.job_id = j.job_id
WHERE j.job_description ILIKE '%mrketingh%' OR j.job_description ILIKE '%selenium%';
```",,"[{'employee_id': 3536252, 'first_name': 'Alice', 'last_name': 'Smith'}, {'employee_id': 3536255, 'first_name': 'Matthew', 'last_name': 'Brown'}, {'employee_id': 3536258, 'first_name': 'Jessica', 'last_name': 'Martinez'}, {'employee_id': 3536261, 'first_name': 'David', 'last_name': 'Lopez'}, {'employee_id': 3536264, 'first_name': 'Sophia', 'last_name': 'Perez'}, {'employee_id': 3536267, 'first_name': 'Liam', 'last_name': 'Gomez'}, {'employee_id': 3536270, 'first_name': 'Charlotte', 'last_name': 'Cooper'}]","[""SELECT employee_id, first_name, last_name FROM employee WHERE job_id IN ( SELECT job_id FROM job WHERE to_jsonb(skills_preferred)::text ILIKE '%Mark%' );""]",212,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve employees who have skills in either mrketingh or selenium.,"{'Compare Type': '""Execution result match""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT emp.employee_id, emp.first_name, emp.last_name, emp.email, j.job_title, j.job_description
FROM employee emp
INNER JOIN job j ON emp.job_id = j.job_id
WHERE j.job_description ILIKE '%mrketingh%' OR j.job_description ILIKE '%selenium%';
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Retrieve the average number of Personal days requested by employees in each department:",[],"
SELECT d.""department_name"", AVG(lr.""duration"") AS ""Avg Personal Days""
FROM ""department"" AS d
JOIN ""employee"" AS e ON d.""department_id"" = e.""department_id""
JOIN ""leave_request"" AS lr ON e.""employee_id"" = lr.""employee_id""
WHERE lr.""leave_type"" = 'Personal'
GROUP BY d.""department_name""
ORDER BY d.""department_name"" ASC;
```",,"[{'avg_vacation_days': '2.0000000000000000', 'department_id': 1, 'department_name': 'Human Resources'}, {'avg_vacation_days': '2.0000000000000000', 'department_id': 2, 'department_name': 'Marketing'}, {'avg_vacation_days': '2.0000000000000000', 'department_id': 3, 'department_name': 'Finance'}]","[""SELECT e.department_id, d.department_name, AVG(lr.duration) AS avg_vacation_days FROM leave_request lr JOIN employee e ON lr.employee_id = e.employee_id JOIN department d ON e.department_id = d.department_id WHERE lr.leave_type = 'Personal Leave' GROUP BY e.department_id, d.department_name""]",211,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Retrieve the average number of Personal days requested by employees in each department:,"{'Compare Type': '""Execution result match""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT d.""department_name"", AVG(lr.""duration"") AS ""Avg Personal Days""
FROM ""department"" AS d
JOIN ""employee"" AS e ON d.""department_id"" = e.""department_id""
JOIN ""leave_request"" AS lr ON e.""employee_id"" = lr.""employee_id""
WHERE lr.""leave_type"" = 'Personal'
GROUP BY d.""department_name""
ORDER BY d.""department_name"" ASC;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'AGGREGATE', 'JOIN']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


Who are the newest employees for each department to join the company and there manager?","[{'department_name': 'Human Resources', 'employee_id': 3536269, 'first_name': 'Noah', 'hire_date': '2024-07-10', 'last_name': 'King', 'manager_first_name': 'John', 'manager_last_name': 'Doe'}, {'department_name': 'Marketing', 'employee_id': 3536270, 'first_name': 'Charlotte', 'hire_date': '2024-08-15', 'last_name': 'Cooper', 'manager_first_name': 'Alice', 'manager_last_name': 'Smith'}, {'department_name': 'Finance', 'employee_id': 3536268, 'first_name': 'Emma', 'hire_date': '2024-06-20', 'last_name': 'Reyes', 'manager_first_name': 'Michael', 'manager_last_name': 'Johnson'}]","
WITH RankedEmployees AS (
  SELECT
    e.employee_id,
    e.first_name,
    e.last_name,
    e.department_id,
    e.hire_date,
    d.department_name,
    ROW_NUMBER() OVER (PARTITION BY d.department_id ORDER BY e.hire_date DESC) AS row_num,
    ROW_NUMBER() OVER (PARTITION BY d.department_name ORDER BY e.hire_date DESC) AS row_num_dept_name
  FROM employee AS e
  JOIN department AS d
    ON e.department_id = d.department_id
)
SELECT
  re.employee_id,
  re.first_name,
  re.last_name,
  re.department_name,
  re.hire_date,
  m.first_name AS manager_first_name,
  m.last_name AS manager_last_name
FROM RankedEmployees AS re
JOIN department AS d
  ON re.department_id = d.department_id
JOIN employee AS m
  ON d.manager_id = m.employee_id
WHERE
  re.row_num = 1
ORDER BY
  re.row_num_dept_name;
```",,"[{'department_id': 3, 'employee_id': 3536268, 'first_name': 'Emma', 'hire_date': '2024-06-20', 'last_name': 'Reyes', 'manager_first_name': 'John', 'manager_id': 3536251, 'manager_last_name': 'Doe'}, {'department_id': 1, 'employee_id': 3536269, 'first_name': 'Noah', 'hire_date': '2024-07-10', 'last_name': 'King', 'manager_first_name': 'John', 'manager_id': 3536251, 'manager_last_name': 'Doe'}, {'department_id': 2, 'employee_id': 3536270, 'first_name': 'Charlotte', 'hire_date': '2024-08-15', 'last_name': 'Cooper', 'manager_first_name': 'Noah', 'manager_id': 3536269, 'manager_last_name': 'King'}]","['WITH NewestEmployees AS ( SELECT e.employee_id, e.first_name, e.last_name, e.department_id, e.manager_id, e.hire_date, ROW_NUMBER() OVER (PARTITION BY e.department_id ORDER BY e.hire_date DESC) AS rn FROM employee e ) SELECT ne.employee_id, ne.first_name, ne.last_name, ne.department_id, ne.manager_id, ne.hire_date, m.first_name AS manager_first_name, m.last_name AS manager_last_name FROM NewestEmployees ne JOIN employee m ON ne.manager_id = m.employee_id WHERE ne.rn = 1;']",201,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,Who are the newest employees for each department to join the company and there manager?,"{'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
WITH RankedEmployees AS (
SELECT
e.employee_id,
e.first_name,
e.last_name,
e.department_id,
e.hire_date,
d.department_name,
ROW_NUMBER() OVER (PARTITION BY d.department_id ORDER BY e.hire_date DESC) AS row_num,
ROW_NUMBER() OVER (PARTITION BY d.department_name ORDER BY e.hire_date DESC) AS row_num_dept_name
FROM employee AS e
JOIN department AS d
ON e.department_id = d.department_id
)
SELECT
re.employee_id,
re.first_name,
re.last_name,
re.department_name,
re.hire_date,
m.first_name AS manager_first_name,
m.last_name AS manager_last_name
FROM RankedEmployees AS re
JOIN department AS d
ON re.department_id = d.department_id
JOIN employee AS m
ON d.manager_id = m.employee_id
WHERE
re.row_num = 1
ORDER BY
re.row_num_dept_name;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: challenging', 'SELECT', 'JOIN', 'RANK', 'SORT']",
[],db_hr,['postgres'],[None],,"You are a Postgres SQL expert.

The database structure is defined by the following table schemas
 (comments after '--' provide additional column descriptions):

**************************
CREATE TABLE allowances (
    allowance character varying,
    allowance_description text,
    allowance_id integer,
;
CREATE TABLE attendance (
    attendance_id integer,
    check_in_location character varying,
    check_in_method character varying,
    check_in_time time without time zone,
    check_out_location character varying,
    check_out_method character varying,
    check_out_time time without time zone,
    date date,
    employee_id integer,
    notes text,
    overtime_hours numeric,
    shift character varying,
    work_hours numeric,
;
CREATE TABLE benefit (
    benefit_id integer,
    benefit_name character varying,
    contact_info character varying,
    coverage character varying,
    description text,
    eligibility_criteria jsonb,
    end_date date,
    provider character varying,
    start_date date,
    usage_instructions text,
;
CREATE TABLE company (
    clients jsonb,
    company_id integer,
    company_name character varying,
    competitors jsonb,
    contact_email character varying,
    contact_person character varying,
    contact_phone character varying,
    financial_year_end date,
    founded_date date,
    industry character varying,
    location character varying,
    ownership_type character varying,
    partners jsonb,
    products jsonb,
    size character varying,
    social_media_facebook character varying,
    social_media_instagram character varying,
    social_media_linkedin character varying,
    social_media_x character varying,
    website character varying,
;
CREATE TABLE department (
    achievements jsonb,
    budget numeric,
    company_id integer,
    department_id integer,
    department_name character varying,
    end_date date,
    goals jsonb,
    is_active boolean,
    manager_id integer,
    start_date date,
;
CREATE TABLE employee (
    address jsonb,
    bank_account_number jsonb,
    company_id integer,
    contract_type character varying,
    date_of_birth date,
    department_id integer,
    email character varying,
    emergency_contact_name character varying,
    emergency_contact_number character varying,
    employee_id integer,
    first_name character varying,
    gender character varying,
    hire_date date,
    image_url character varying,
    job_id integer,
    last_name character varying,
    manager_id integer,
    marital_status character varying,
    national_identification character varying,
    phone_number character varying,
;
CREATE TABLE employee_allowances (
    allowance_id integer,
    amount numeric,
    date_created date,
    effective_date date,
    employee_allowance_id integer,
    employee_id integer,
    type character varying,
;
CREATE TABLE employee_business_expense (
    employee_id integer,
    expense_amount numeric,
    expense_category character varying,
    expense_date date,
    expense_description text,
    expense_id integer,
    expense_receipt character varying,
;
CREATE TABLE employee_certification (
    certification_id integer,
    certification_name character varying,
    employee_id integer,
    expiration_date date,
    issue_date date,
    issuing_organization character varying,
;
CREATE TABLE employee_computer (
    assigned_date date,
    computer_id integer,
    computer_name character varying,
    employee_id integer,
    model character varying,
    purchase_date date,
    returned_date date,
    serial_number character varying,
    status character varying,
    warranty_expiry_date date,
;
CREATE TABLE employee_termination (
    description text,
    employee_id integer,
    reason character varying,
    termination_date date,
    termination_id integer,
;
CREATE TABLE employee_training (
    employee_id integer,
    end_date date,
    start_date date,
    training_id integer,
;
CREATE TABLE employee_travel (
    employee_id integer,
    travel_destination character varying,
    travel_end_date date,
    travel_expenses numeric,
    travel_id integer,
    travel_purpose character varying,
    travel_start_date date,
;
CREATE TABLE employee_x_benefit (
    benefit_id integer,
    employee_id integer,
    end_date date,
    start_date date,
;
CREATE TABLE holiday (
    city character varying,
    date date,
    day character varying,
    geographic_location character varying,
    occasion character varying,
    project character varying,
;
CREATE TABLE invoice (
    due_date date,
    employee_id integer,
    invoice_date date,
    invoice_id integer,
    status character varying,
    total_amount numeric,
;
CREATE TABLE job (
    benefits jsonb,
    department_id integer,
    education_requirements jsonb,
    employment_type character varying,
    experience_requirements jsonb,
    job_description text,
    job_id integer,
    job_title character varying,
    location character varying,
    max_salary numeric,
    min_salary numeric,
    responsibilities text,
    skills_preferred jsonb,
    skills_required jsonb,
    status character varying,
    vacancies integer,
;
CREATE TABLE job_history (
    department_id integer,
    employee_id integer,
    end_date date,
    job_history_id integer,
    job_id integer,
    start_date date,
;
CREATE TABLE leave_request (
    approval_date date,
    attachment character varying,
    comments text,
    duration numeric,
    employee_id integer,
    end_date date,
    leave_id integer,
    leave_type character varying,
    processed_by integer,
    reason text,
    rejection_date date,
    start_date date,
    status character varying,
;
CREATE TABLE manager (
    end_date date,
    manager_id integer,
    start_date date,
;
CREATE TABLE payment (
    amount numeric,
    invoice_id integer,
    payment_date date,
    payment_id integer,
    payment_method character varying,
;
CREATE TABLE performance_review (
    comments text,
    employee_id integer,
    performance_rating numeric,
    review_date date,
    review_id integer,
    reviewer_id integer,
;
CREATE TABLE salary (
    bonus numeric,
    currency character varying,
    deductions numeric,
    employee_id integer,
    end_date date,
    pay_frequency character varying,
    salary numeric,
    salary_id integer,
    start_date date,
    status character varying,
    taxes numeric,
    total_compensation numeric,
;
CREATE TABLE timesheet (
    date date,
    leave_type character varying,
    overtime numeric,
    timesheet_id integer,
    working_hours numeric,
;
CREATE TABLE timesheet_employee (
    employee_id integer,
    fort_night1_flag boolean,
    fort_night2_flag boolean,
    month integer,
    timesheet_id integer,
    year integer,
;
CREATE TABLE training (
    attendance_required boolean,
    date date,
    description text,
    duration numeric,
    feedback_link character varying,
    link character varying,
    location character varying,
    materials text,
    registration_deadline_date date,
    registration_link character varying,
    status character varying,
    title character varying,
    trainer character varying,
    training_id integer,
);

**************************

Please generate a Postgres SQL query for the following question following the rules:
- Output the query only without any explanation.
- Do not use ``` around the outputed query.
- Always use quotes around the table and column names.

Additional rules to generate correct Postgres SQL dialect:

- Use Table Aliases: Employ aliases to prevent conflicts with duplicate table names.
- Strict Adherence to Schema: You cannot make up any tables or columns that are not explicitly
listed in the provided schema.
- Manage Nulls with ORDER BY: Employ `NULLS LAST` in ORDER BY clauses to control the placement
of null values.
- Arithmetic Operators: Prioritize the use of basic arithmetic operators (+, -, *, /) for
calculations whenever possible.
Only use specialized PostgreSQL functions if absolutely necessary for the desired results.
- Follow PostgreSQL Dialect: Adhere to PostgreSQL syntax, data types, and available functions.
- Choose Join Types Carefully: Select appropriate join types (INNER, LEFT, RIGHT, FULL OUTER)
based on desired relationships.
- Booleans in HAVING: Employ valid boolean expressions within the HAVING clause.
- Type-Aware Functions: Select PostgreSQL functions compatible with the data types in use.
- Cast for Compatibility: Cast data types when necessary for function compatibility or specific manipulations.

Think step by step about generating correct Postgres SQL result!

**************************

Here is the natural language question for generating SQL:


List all employees who have participated in at least one training session in year 2024, along with the total number of sessions they attended.","[{'first_name': 'David', 'last_name': 'Lopez', 'total_training_sessions': 1}, {'first_name': 'Sophia', 'last_name': 'Perez', 'total_training_sessions': 1}, {'first_name': 'John', 'last_name': 'Doe', 'total_training_sessions': 1}, {'first_name': 'Noah', 'last_name': 'King', 'total_training_sessions': 1}, {'first_name': 'Emma', 'last_name': 'Reyes', 'total_training_sessions': 1}, {'first_name': 'Emily', 'last_name': 'Williams', 'total_training_sessions': 1}, {'first_name': 'Taylor', 'last_name': 'Rodriguez', 'total_training_sessions': 1}, {'first_name': 'Michael', 'last_name': 'Johnson', 'total_training_sessions': 1}, {'first_name': 'Megan', 'last_name': 'Hernandez', 'total_training_sessions': 1}, {'first_name': 'Charlotte', 'last_name': 'Cooper', 'total_training_sessions': 1}, {'first_name': 'Liam', 'last_name': 'Gomez', 'total_training_sessions': 1}, {'first_name': 'Olivia', 'last_name': 'Rivera', 'total_training_sessions': 1}, {'first_name': 'Christopher', 'last_name': 'Davis', 'total_training_sessions': 1}, {'first_name': 'Matthew', 'last_name': 'Brown', 'total_training_sessions': 1}, {'first_name': 'Aiden', 'last_name': 'Torres', 'total_training_sessions': 1}, {'first_name': 'Alice', 'last_name': 'Smith', 'total_training_sessions': 1}, {'first_name': 'Jessica', 'last_name': 'Martinez', 'total_training_sessions': 1}, {'first_name': 'Daniel', 'last_name': 'Garcia', 'total_training_sessions': 1}, {'first_name': 'Sarah', 'last_name': 'Jones', 'total_training_sessions': 1}, {'first_name': 'Andrew', 'last_name': 'Gonzalez', 'total_training_sessions': 1}]","
SELECT
  e.""first_name"",
  e.""last_name"",
  COUNT(et.""training_id"") AS ""total_training_sessions""
FROM ""employee"" AS e
JOIN ""employee_training"" AS et
  ON e.""employee_id"" = et.""employee_id""
JOIN ""training"" AS t
  ON et.""training_id"" = t.""training_id""
WHERE
  EXTRACT(YEAR FROM t.""date"") = 2024
GROUP BY
  e.""employee_id"",
  e.""first_name"",
  e.""last_name""
HAVING
  COUNT(et.""training_id"") > 0;
```",,"[{'employee_id': 3536263, 'first_name': 'Andrew', 'total_training_sessions': 1}, {'employee_id': 3536264, 'first_name': 'Sophia', 'total_training_sessions': 1}, {'employee_id': 3536265, 'first_name': 'Aiden', 'total_training_sessions': 1}, {'employee_id': 3536266, 'first_name': 'Olivia', 'total_training_sessions': 1}, {'employee_id': 3536267, 'first_name': 'Liam', 'total_training_sessions': 1}, {'employee_id': 3536268, 'first_name': 'Emma', 'total_training_sessions': 1}, {'employee_id': 3536269, 'first_name': 'Noah', 'total_training_sessions': 1}, {'employee_id': 3536270, 'first_name': 'Charlotte', 'total_training_sessions': 1}]","['SELECT e.employee_id, e.first_name, COUNT(et.training_id) AS total_training_sessions FROM employee e JOIN employee_training et ON e.employee_id = et.employee_id JOIN training t ON et.training_id = t.training_id WHERE EXTRACT(YEAR FROM et.start_date) = 2024 GROUP BY e.employee_id, e.first_name HAVING COUNT(et.training_id) >= 1 ORDER BY total_training_sessions DESC;']",219,91fdc204-a7bb-4c5c-afbd-08eb4fe09e17,"List all employees who have participated in at least one training session in year 2024, along with the total number of sessions they attended.","{'Comment': '""LGTM""', 'Compare Type': '""Execution result""', 'Context': '""Match""'}",,dql,2025-02-10 18:36:22.083420,"
SELECT
e.""first_name"",
e.""last_name"",
COUNT(et.""training_id"") AS ""total_training_sessions""
FROM ""employee"" AS e
JOIN ""employee_training"" AS et
ON e.""employee_id"" = et.""employee_id""
JOIN ""training"" AS t
ON et.""training_id"" = t.""training_id""
WHERE
EXTRACT(YEAR FROM t.""date"") = 2024
GROUP BY
e.""employee_id"",
e.""first_name"",
e.""last_name""
HAVING
COUNT(et.""training_id"") > 0;
",[],,0.0,"['DQL', 'experience: Generation', 'cuj: query', 'difficulty: moderate', 'SELECT', 'JOIN', 'AGGREGATE', 'DATE']",
